var s0=Object.defineProperty;var a0=(he,bn,ar)=>bn in he?s0(he,bn,{enumerable:!0,configurable:!0,writable:!0,value:ar}):he[bn]=ar;var na=(he,bn,ar)=>a0(he,typeof bn!="symbol"?bn+"":bn,ar);(function(he,bn){"use strict";function ar(s){const d=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const L in s)if(L!=="default"){const z=Object.getOwnPropertyDescriptor(s,L);Object.defineProperty(d,L,z.get?z:{enumerable:!0,get:()=>s[L]})}}return d.default=s,Object.freeze(d)}const zt=ar(he);var jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ui(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ra={exports:{}},Nr={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ho;function uc(){if(Ho)return Nr;Ho=1;var s=he,d=Symbol.for("react.element"),L=Symbol.for("react.fragment"),z=Object.prototype.hasOwnProperty,R=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function a(c,g,y){var v,k={},w=null,m=null;y!==void 0&&(w=""+y),g.key!==void 0&&(w=""+g.key),g.ref!==void 0&&(m=g.ref);for(v in g)z.call(g,v)&&!x.hasOwnProperty(v)&&(k[v]=g[v]);if(c&&c.defaultProps)for(v in g=c.defaultProps,g)k[v]===void 0&&(k[v]=g[v]);return{$$typeof:d,type:c,key:w,ref:m,props:k,_owner:R.current}}return Nr.Fragment=L,Nr.jsx=a,Nr.jsxs=a,Nr}var Wo;function cc(){return Wo||(Wo=1,ra.exports=uc()),ra.exports}var K=cc(),ji={},Vo;function hc(){if(Vo)return ji;Vo=1;var s=bn;return ji.createRoot=s.createRoot,ji.hydrateRoot=s.hydrateRoot,ji}var fc=hc();const gc=Ui(fc);var Hi={exports:{}},Ir={},ia={},sa={},qo;function Re(){return qo||(qo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s._registerNode=s.Konva=s.glob=void 0;const d=Math.PI/180;function L(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}s.glob=typeof jo<"u"?jo:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},s.Konva={_global:s.glob,version:"9.3.20",isBrowser:L(),isUnminified:/param/.test((function(R){}).toString()),dblClickWindow:400,getAngle(R){return s.Konva.angleDeg?R*d:R},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return s.Konva.DD.isDragging},isTransforming(){var R;return(R=s.Konva.Transformer)===null||R===void 0?void 0:R.isTransforming()},isDragReady(){return!!s.Konva.DD.node},releaseCanvasOnDestroy:!0,document:s.glob.document,_injectGlobal(R){s.glob.Konva=R}};const z=R=>{s.Konva[R.prototype.getClassName()]=R};s._registerNode=z,s.Konva._injectGlobal(s.Konva)}(sa)),sa}var aa={},Yo;function nt(){return Yo||(Yo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Util=s.Transform=void 0;const d=Re();class L{constructor(b=[1,0,0,1,0,0]){this.dirty=!1,this.m=b&&b.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new L(this.m)}copyInto(b){b.m[0]=this.m[0],b.m[1]=this.m[1],b.m[2]=this.m[2],b.m[3]=this.m[3],b.m[4]=this.m[4],b.m[5]=this.m[5]}point(b){const I=this.m;return{x:I[0]*b.x+I[2]*b.y+I[4],y:I[1]*b.x+I[3]*b.y+I[5]}}translate(b,I){return this.m[4]+=this.m[0]*b+this.m[2]*I,this.m[5]+=this.m[1]*b+this.m[3]*I,this}scale(b,I){return this.m[0]*=b,this.m[1]*=b,this.m[2]*=I,this.m[3]*=I,this}rotate(b){const I=Math.cos(b),M=Math.sin(b),U=this.m[0]*I+this.m[2]*M,N=this.m[1]*I+this.m[3]*M,A=this.m[0]*-M+this.m[2]*I,E=this.m[1]*-M+this.m[3]*I;return this.m[0]=U,this.m[1]=N,this.m[2]=A,this.m[3]=E,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(b,I){const M=this.m[0]+this.m[2]*I,U=this.m[1]+this.m[3]*I,N=this.m[2]+this.m[0]*b,A=this.m[3]+this.m[1]*b;return this.m[0]=M,this.m[1]=U,this.m[2]=N,this.m[3]=A,this}multiply(b){const I=this.m[0]*b.m[0]+this.m[2]*b.m[1],M=this.m[1]*b.m[0]+this.m[3]*b.m[1],U=this.m[0]*b.m[2]+this.m[2]*b.m[3],N=this.m[1]*b.m[2]+this.m[3]*b.m[3],A=this.m[0]*b.m[4]+this.m[2]*b.m[5]+this.m[4],E=this.m[1]*b.m[4]+this.m[3]*b.m[5]+this.m[5];return this.m[0]=I,this.m[1]=M,this.m[2]=U,this.m[3]=N,this.m[4]=A,this.m[5]=E,this}invert(){const b=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),I=this.m[3]*b,M=-this.m[1]*b,U=-this.m[2]*b,N=this.m[0]*b,A=b*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),E=b*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=I,this.m[1]=M,this.m[2]=U,this.m[3]=N,this.m[4]=A,this.m[5]=E,this}getMatrix(){return this.m}decompose(){const b=this.m[0],I=this.m[1],M=this.m[2],U=this.m[3],N=this.m[4],A=this.m[5],E=b*U-I*M,B={x:N,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(b!=0||I!=0){const q=Math.sqrt(b*b+I*I);B.rotation=I>0?Math.acos(b/q):-Math.acos(b/q),B.scaleX=q,B.scaleY=E/q,B.skewX=(b*M+I*U)/E,B.skewY=0}else if(M!=0||U!=0){const q=Math.sqrt(M*M+U*U);B.rotation=Math.PI/2-(U>0?Math.acos(-M/q):-Math.acos(M/q)),B.scaleX=E/q,B.scaleY=q,B.skewX=0,B.skewY=(b*M+I*U)/E}return B.rotation=s.Util._getRotation(B.rotation),B}}s.Transform=L;const z="[object Array]",R="[object Number]",x="[object String]",a="[object Boolean]",c=Math.PI/180,g=180/Math.PI,y="#",v="",k="0",w="Konva warning: ",m="Konva error: ",h="rgb(",S={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},P=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let D=[];const u=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(o){setTimeout(o,60)};s.Util={_isElement(o){return!!(o&&o.nodeType==1)},_isFunction(o){return!!(o&&o.constructor&&o.call&&o.apply)},_isPlainObject(o){return!!o&&o.constructor===Object},_isArray(o){return Object.prototype.toString.call(o)===z},_isNumber(o){return Object.prototype.toString.call(o)===R&&!isNaN(o)&&isFinite(o)},_isString(o){return Object.prototype.toString.call(o)===x},_isBoolean(o){return Object.prototype.toString.call(o)===a},isObject(o){return o instanceof Object},isValidSelector(o){if(typeof o!="string")return!1;const b=o[0];return b==="#"||b==="."||b===b.toUpperCase()},_sign(o){return o===0||o>0?1:-1},requestAnimFrame(o){D.push(o),D.length===1&&u(function(){const b=D;D=[],b.forEach(function(I){I()})})},createCanvasElement(){const o=document.createElement("canvas");try{o.style=o.style||{}}catch{}return o},createImageElement(){return document.createElement("img")},_isInDocument(o){for(;o=o.parentNode;)if(o==document)return!0;return!1},_urlToImage(o,b){const I=s.Util.createImageElement();I.onload=function(){b(I)},I.src=o},_rgbToHex(o,b,I){return((1<<24)+(o<<16)+(b<<8)+I).toString(16).slice(1)},_hexToRgb(o){o=o.replace(y,v);const b=parseInt(o,16);return{r:b>>16&255,g:b>>8&255,b:b&255}},getRandomColor(){let o=(Math.random()*16777215<<0).toString(16);for(;o.length<6;)o=k+o;return y+o},getRGB(o){let b;return o in S?(b=S[o],{r:b[0],g:b[1],b:b[2]}):o[0]===y?this._hexToRgb(o.substring(1)):o.substr(0,4)===h?(b=P.exec(o.replace(/ /g,"")),{r:parseInt(b[1],10),g:parseInt(b[2],10),b:parseInt(b[3],10)}):{r:0,g:0,b:0}},colorToRGBA(o){return o=o||"black",s.Util._namedColorToRBA(o)||s.Util._hex3ColorToRGBA(o)||s.Util._hex4ColorToRGBA(o)||s.Util._hex6ColorToRGBA(o)||s.Util._hex8ColorToRGBA(o)||s.Util._rgbColorToRGBA(o)||s.Util._rgbaColorToRGBA(o)||s.Util._hslColorToRGBA(o)},_namedColorToRBA(o){const b=S[o.toLowerCase()];return b?{r:b[0],g:b[1],b:b[2],a:1}:null},_rgbColorToRGBA(o){if(o.indexOf("rgb(")===0){o=o.match(/rgb\(([^)]+)\)/)[1];const b=o.split(/ *, */).map(Number);return{r:b[0],g:b[1],b:b[2],a:1}}},_rgbaColorToRGBA(o){if(o.indexOf("rgba(")===0){o=o.match(/rgba\(([^)]+)\)/)[1];const b=o.split(/ *, */).map((I,M)=>I.slice(-1)==="%"?M===3?parseInt(I)/100:parseInt(I)/100*255:Number(I));return{r:b[0],g:b[1],b:b[2],a:b[3]}}},_hex8ColorToRGBA(o){if(o[0]==="#"&&o.length===9)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:parseInt(o.slice(7,9),16)/255}},_hex6ColorToRGBA(o){if(o[0]==="#"&&o.length===7)return{r:parseInt(o.slice(1,3),16),g:parseInt(o.slice(3,5),16),b:parseInt(o.slice(5,7),16),a:1}},_hex4ColorToRGBA(o){if(o[0]==="#"&&o.length===5)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:parseInt(o[4]+o[4],16)/255}},_hex3ColorToRGBA(o){if(o[0]==="#"&&o.length===4)return{r:parseInt(o[1]+o[1],16),g:parseInt(o[2]+o[2],16),b:parseInt(o[3]+o[3],16),a:1}},_hslColorToRGBA(o){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(o)){const[b,...I]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o),M=Number(I[0])/360,U=Number(I[1])/100,N=Number(I[2])/100;let A,E,B;if(U===0)return B=N*255,{r:Math.round(B),g:Math.round(B),b:Math.round(B),a:1};N<.5?A=N*(1+U):A=N+U-N*U;const q=2*N-A,l=[0,0,0];for(let _=0;_<3;_++)E=M+1/3*-(_-1),E<0&&E++,E>1&&E--,6*E<1?B=q+(A-q)*6*E:2*E<1?B=A:3*E<2?B=q+(A-q)*(2/3-E)*6:B=q,l[_]=B*255;return{r:Math.round(l[0]),g:Math.round(l[1]),b:Math.round(l[2]),a:1}}},haveIntersection(o,b){return!(b.x>o.x+o.width||b.x+b.width<o.x||b.y>o.y+o.height||b.y+b.height<o.y)},cloneObject(o){const b={};for(const I in o)this._isPlainObject(o[I])?b[I]=this.cloneObject(o[I]):this._isArray(o[I])?b[I]=this.cloneArray(o[I]):b[I]=o[I];return b},cloneArray(o){return o.slice(0)},degToRad(o){return o*c},radToDeg(o){return o*g},_degToRad(o){return s.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),s.Util.degToRad(o)},_radToDeg(o){return s.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),s.Util.radToDeg(o)},_getRotation(o){return d.Konva.angleDeg?s.Util.radToDeg(o):o},_capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},throw(o){throw new Error(m+o)},error(o){console.error(m+o)},warn(o){d.Konva.showWarnings&&console.warn(w+o)},each(o,b){for(const I in o)b(I,o[I])},_inRange(o,b,I){return b<=o&&o<I},_getProjectionToSegment(o,b,I,M,U,N){let A,E,B;const q=(o-I)*(o-I)+(b-M)*(b-M);if(q==0)A=o,E=b,B=(U-I)*(U-I)+(N-M)*(N-M);else{const l=((U-o)*(I-o)+(N-b)*(M-b))/q;l<0?(A=o,E=b,B=(o-U)*(o-U)+(b-N)*(b-N)):l>1?(A=I,E=M,B=(I-U)*(I-U)+(M-N)*(M-N)):(A=o+l*(I-o),E=b+l*(M-b),B=(A-U)*(A-U)+(E-N)*(E-N))}return[A,E,B]},_getProjectionToLine(o,b,I){const M=s.Util.cloneObject(o);let U=Number.MAX_VALUE;return b.forEach(function(N,A){if(!I&&A===b.length-1)return;const E=b[(A+1)%b.length],B=s.Util._getProjectionToSegment(N.x,N.y,E.x,E.y,o.x,o.y),q=B[0],l=B[1],_=B[2];_<U&&(M.x=q,M.y=l,U=_)}),M},_prepareArrayForTween(o,b,I){const M=[],U=[];if(o.length>b.length){const A=b;b=o,o=A}for(let A=0;A<o.length;A+=2)M.push({x:o[A],y:o[A+1]});for(let A=0;A<b.length;A+=2)U.push({x:b[A],y:b[A+1]});const N=[];return U.forEach(function(A){const E=s.Util._getProjectionToLine(A,M,I);N.push(E.x),N.push(E.y)}),N},_prepareToStringify(o){let b;o.visitedByCircularReferenceRemoval=!0;for(const I in o)if(o.hasOwnProperty(I)&&o[I]&&typeof o[I]=="object"){if(b=Object.getOwnPropertyDescriptor(o,I),o[I].visitedByCircularReferenceRemoval||s.Util._isElement(o[I]))if(b.configurable)delete o[I];else return null;else if(s.Util._prepareToStringify(o[I])===null)if(b.configurable)delete o[I];else return null}return delete o.visitedByCircularReferenceRemoval,o},_assign(o,b){for(const I in b)o[I]=b[I];return o},_getFirstPointerId(o){return o.touches?o.changedTouches[0].identifier:o.pointerId||999},releaseCanvas(...o){d.Konva.releaseCanvasOnDestroy&&o.forEach(b=>{b.width=0,b.height=0})},drawRoundedRectPath(o,b,I,M){let U=0,N=0,A=0,E=0;typeof M=="number"?U=N=A=E=Math.min(M,b/2,I/2):(U=Math.min(M[0]||0,b/2,I/2),N=Math.min(M[1]||0,b/2,I/2),E=Math.min(M[2]||0,b/2,I/2),A=Math.min(M[3]||0,b/2,I/2)),o.moveTo(U,0),o.lineTo(b-N,0),o.arc(b-N,N,N,Math.PI*3/2,0,!1),o.lineTo(b,I-E),o.arc(b-E,I-E,E,0,Math.PI/2,!1),o.lineTo(A,I),o.arc(A,I-A,A,Math.PI/2,Math.PI,!1),o.lineTo(0,U),o.arc(U,U,U,Math.PI,Math.PI*3/2,!1)}}}(aa)),aa}var Mr={},oa={},Dt={},Ko;function ze(){if(Ko)return Dt;Ko=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.RGBComponent=z,Dt.alphaComponent=R,Dt.getNumberValidator=x,Dt.getNumberOrArrayOfNumbersValidator=a,Dt.getNumberOrAutoValidator=c,Dt.getStringValidator=g,Dt.getStringOrGradientValidator=y,Dt.getFunctionValidator=v,Dt.getNumberArrayValidator=k,Dt.getBooleanValidator=w,Dt.getComponentValidator=m;const s=Re(),d=nt();function L(h){return d.Util._isString(h)?'"'+h+'"':Object.prototype.toString.call(h)==="[object Number]"||d.Util._isBoolean(h)?h:Object.prototype.toString.call(h)}function z(h){return h>255?255:h<0?0:Math.round(h)}function R(h){return h>1?1:h<1e-4?1e-4:h}function x(){if(s.Konva.isUnminified)return function(h,S){return d.Util._isNumber(h)||d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a number.'),h}}function a(h){if(s.Konva.isUnminified)return function(S,P){let D=d.Util._isNumber(S),u=d.Util._isArray(S)&&S.length==h;return!D&&!u&&d.Util.warn(L(S)+' is a not valid value for "'+P+'" attribute. The value should be a number or Array<number>('+h+")"),S}}function c(){if(s.Konva.isUnminified)return function(h,S){var P=d.Util._isNumber(h),D=h==="auto";return P||D||d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a number or "auto".'),h}}function g(){if(s.Konva.isUnminified)return function(h,S){return d.Util._isString(h)||d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a string.'),h}}function y(){if(s.Konva.isUnminified)return function(h,S){const P=d.Util._isString(h),D=Object.prototype.toString.call(h)==="[object CanvasGradient]"||h&&h.addColorStop;return P||D||d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a string or a native gradient.'),h}}function v(){if(s.Konva.isUnminified)return function(h,S){return d.Util._isFunction(h)||d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a function.'),h}}function k(){if(s.Konva.isUnminified)return function(h,S){const P=Int8Array?Object.getPrototypeOf(Int8Array):null;return P&&h instanceof P||(d.Util._isArray(h)?h.forEach(function(D){d.Util._isNumber(D)||d.Util.warn('"'+S+'" attribute has non numeric element '+D+". Make sure that all elements are numbers.")}):d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a array of numbers.')),h}}function w(){if(s.Konva.isUnminified)return function(h,S){var P=h===!0||h===!1;return P||d.Util.warn(L(h)+' is a not valid value for "'+S+'" attribute. The value should be a boolean.'),h}}function m(h){if(s.Konva.isUnminified)return function(S,P){return S==null||d.Util.isObject(S)||d.Util.warn(L(S)+' is a not valid value for "'+P+'" attribute. The value should be an object with properties '+h),S}}return Dt}var Xo;function Ae(){return Xo||(Xo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Factory=void 0;const d=nt(),L=ze(),z="get",R="set";s.Factory={addGetterSetter(x,a,c,g,y){s.Factory.addGetter(x,a,c),s.Factory.addSetter(x,a,g,y),s.Factory.addOverloadedGetterSetter(x,a)},addGetter(x,a,c){var g=z+d.Util._capitalize(a);x.prototype[g]=x.prototype[g]||function(){const y=this.attrs[a];return y===void 0?c:y}},addSetter(x,a,c,g){var y=R+d.Util._capitalize(a);x.prototype[y]||s.Factory.overWriteSetter(x,a,c,g)},overWriteSetter(x,a,c,g){var y=R+d.Util._capitalize(a);x.prototype[y]=function(v){return c&&v!==void 0&&v!==null&&(v=c.call(this,v,a)),this._setAttr(a,v),g&&g.call(this),this}},addComponentsGetterSetter(x,a,c,g,y){const v=c.length,k=d.Util._capitalize,w=z+k(a),m=R+k(a);x.prototype[w]=function(){const S={};for(let P=0;P<v;P++){const D=c[P];S[D]=this.getAttr(a+k(D))}return S};const h=(0,L.getComponentValidator)(c);x.prototype[m]=function(S){const P=this.attrs[a];g&&(S=g.call(this,S,a)),h&&h.call(this,S,a);for(const D in S)S.hasOwnProperty(D)&&this._setAttr(a+k(D),S[D]);return S||c.forEach(D=>{this._setAttr(a+k(D),void 0)}),this._fireChangeEvent(a,P,S),y&&y.call(this),this},s.Factory.addOverloadedGetterSetter(x,a)},addOverloadedGetterSetter(x,a){var c=d.Util._capitalize(a),g=R+c,y=z+c;x.prototype[a]=function(){return arguments.length?(this[g](arguments[0]),this):this[y]()}},addDeprecatedGetterSetter(x,a,c,g){d.Util.error("Adding deprecated "+a);const y=z+d.Util._capitalize(a),v=a+" property is deprecated and will be removed soon. Look at Konva change log for more information.";x.prototype[y]=function(){d.Util.error(v);const k=this.attrs[a];return k===void 0?c:k},s.Factory.addSetter(x,a,g,function(){d.Util.error(v)}),s.Factory.addOverloadedGetterSetter(x,a)},backCompat(x,a){d.Util.each(a,function(c,g){const y=x.prototype[g],v=z+d.Util._capitalize(c),k=R+d.Util._capitalize(c);function w(){y.apply(this,arguments),d.Util.error('"'+c+'" method is deprecated and will be removed soon. Use ""'+g+'" instead.')}x.prototype[c]=w,x.prototype[v]=w,x.prototype[k]=w})},afterSetFilter(){this._filterUpToDate=!1}}}(oa)),oa}var kn={},En={},Qo;function Jo(){if(Qo)return En;Qo=1,Object.defineProperty(En,"__esModule",{value:!0}),En.HitContext=En.SceneContext=En.Context=void 0;const s=nt(),d=Re();function L(D){const u=[],o=D.length,b=s.Util;for(let I=0;I<o;I++){let M=D[I];b._isNumber(M)?M=Math.round(M*1e3)/1e3:b._isString(M)||(M=M+""),u.push(M)}return u}const z=",",R="(",x=")",a="([",c="])",g=";",y="()",v="=",k=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],w=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],m=100;let h=class{constructor(u){this.canvas=u,d.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(u){u.fillEnabled()&&this._fill(u)}_fill(u){}strokeShape(u){u.hasStroke()&&this._stroke(u)}_stroke(u){}fillStrokeShape(u){u.attrs.fillAfterStrokeEnabled?(this.strokeShape(u),this.fillShape(u)):(this.fillShape(u),this.strokeShape(u))}getTrace(u,o){let b=this.traceArr,I=b.length,M="",U,N,A,E;for(U=0;U<I;U++)N=b[U],A=N.method,A?(E=N.args,M+=A,u?M+=y:s.Util._isArray(E[0])?M+=a+E.join(z)+c:(o&&(E=E.map(B=>typeof B=="number"?Math.floor(B):B)),M+=R+E.join(z)+x)):(M+=N.property,u||(M+=v+N.val)),M+=g;return M}clearTrace(){this.traceArr=[]}_trace(u){let o=this.traceArr,b;o.push(u),b=o.length,b>=m&&o.shift()}reset(){const u=this.getCanvas().getPixelRatio();this.setTransform(1*u,0,0,1*u,0,0)}getCanvas(){return this.canvas}clear(u){const o=this.getCanvas();u?this.clearRect(u.x||0,u.y||0,u.width||0,u.height||0):this.clearRect(0,0,o.getWidth()/o.pixelRatio,o.getHeight()/o.pixelRatio)}_applyLineCap(u){const o=u.attrs.lineCap;o&&this.setAttr("lineCap",o)}_applyOpacity(u){const o=u.getAbsoluteOpacity();o!==1&&this.setAttr("globalAlpha",o)}_applyLineJoin(u){const o=u.attrs.lineJoin;o&&this.setAttr("lineJoin",o)}setAttr(u,o){this._context[u]=o}arc(u,o,b,I,M,U){this._context.arc(u,o,b,I,M,U)}arcTo(u,o,b,I,M){this._context.arcTo(u,o,b,I,M)}beginPath(){this._context.beginPath()}bezierCurveTo(u,o,b,I,M,U){this._context.bezierCurveTo(u,o,b,I,M,U)}clearRect(u,o,b,I){this._context.clearRect(u,o,b,I)}clip(...u){this._context.clip.apply(this._context,u)}closePath(){this._context.closePath()}createImageData(u,o){const b=arguments;if(b.length===2)return this._context.createImageData(u,o);if(b.length===1)return this._context.createImageData(u)}createLinearGradient(u,o,b,I){return this._context.createLinearGradient(u,o,b,I)}createPattern(u,o){return this._context.createPattern(u,o)}createRadialGradient(u,o,b,I,M,U){return this._context.createRadialGradient(u,o,b,I,M,U)}drawImage(u,o,b,I,M,U,N,A,E){const B=arguments,q=this._context;B.length===3?q.drawImage(u,o,b):B.length===5?q.drawImage(u,o,b,I,M):B.length===9&&q.drawImage(u,o,b,I,M,U,N,A,E)}ellipse(u,o,b,I,M,U,N,A){this._context.ellipse(u,o,b,I,M,U,N,A)}isPointInPath(u,o,b,I){return b?this._context.isPointInPath(b,u,o,I):this._context.isPointInPath(u,o,I)}fill(...u){this._context.fill.apply(this._context,u)}fillRect(u,o,b,I){this._context.fillRect(u,o,b,I)}strokeRect(u,o,b,I){this._context.strokeRect(u,o,b,I)}fillText(u,o,b,I){I?this._context.fillText(u,o,b,I):this._context.fillText(u,o,b)}measureText(u){return this._context.measureText(u)}getImageData(u,o,b,I){return this._context.getImageData(u,o,b,I)}lineTo(u,o){this._context.lineTo(u,o)}moveTo(u,o){this._context.moveTo(u,o)}rect(u,o,b,I){this._context.rect(u,o,b,I)}roundRect(u,o,b,I,M){this._context.roundRect(u,o,b,I,M)}putImageData(u,o,b){this._context.putImageData(u,o,b)}quadraticCurveTo(u,o,b,I){this._context.quadraticCurveTo(u,o,b,I)}restore(){this._context.restore()}rotate(u){this._context.rotate(u)}save(){this._context.save()}scale(u,o){this._context.scale(u,o)}setLineDash(u){this._context.setLineDash?this._context.setLineDash(u):"mozDash"in this._context?this._context.mozDash=u:"webkitLineDash"in this._context&&(this._context.webkitLineDash=u)}getLineDash(){return this._context.getLineDash()}setTransform(u,o,b,I,M,U){this._context.setTransform(u,o,b,I,M,U)}stroke(u){u?this._context.stroke(u):this._context.stroke()}strokeText(u,o,b,I){this._context.strokeText(u,o,b,I)}transform(u,o,b,I,M,U){this._context.transform(u,o,b,I,M,U)}translate(u,o){this._context.translate(u,o)}_enableTrace(){let u=this,o=k.length,b=this.setAttr,I,M;const U=function(N){let A=u[N],E;u[N]=function(){return M=L(Array.prototype.slice.call(arguments,0)),E=A.apply(u,arguments),u._trace({method:N,args:M}),E}};for(I=0;I<o;I++)U(k[I]);u.setAttr=function(){b.apply(u,arguments);const N=arguments[0];let A=arguments[1];(N==="shadowOffsetX"||N==="shadowOffsetY"||N==="shadowBlur")&&(A=A/this.canvas.getPixelRatio()),u._trace({property:N,val:A})}}_applyGlobalCompositeOperation(u){const o=u.attrs.globalCompositeOperation;!o||o==="source-over"||this.setAttr("globalCompositeOperation",o)}};En.Context=h,w.forEach(function(D){Object.defineProperty(h.prototype,D,{get(){return this._context[D]},set(u){this._context[D]=u}})});class S extends h{constructor(u,{willReadFrequently:o=!1}={}){super(u),this._context=u._canvas.getContext("2d",{willReadFrequently:o})}_fillColor(u){const o=u.fill();this.setAttr("fillStyle",o),u._fillFunc(this)}_fillPattern(u){this.setAttr("fillStyle",u._getFillPattern()),u._fillFunc(this)}_fillLinearGradient(u){const o=u._getLinearGradient();o&&(this.setAttr("fillStyle",o),u._fillFunc(this))}_fillRadialGradient(u){const o=u._getRadialGradient();o&&(this.setAttr("fillStyle",o),u._fillFunc(this))}_fill(u){const o=u.fill(),b=u.getFillPriority();if(o&&b==="color"){this._fillColor(u);return}const I=u.getFillPatternImage();if(I&&b==="pattern"){this._fillPattern(u);return}const M=u.getFillLinearGradientColorStops();if(M&&b==="linear-gradient"){this._fillLinearGradient(u);return}const U=u.getFillRadialGradientColorStops();if(U&&b==="radial-gradient"){this._fillRadialGradient(u);return}o?this._fillColor(u):I?this._fillPattern(u):M?this._fillLinearGradient(u):U&&this._fillRadialGradient(u)}_strokeLinearGradient(u){const o=u.getStrokeLinearGradientStartPoint(),b=u.getStrokeLinearGradientEndPoint(),I=u.getStrokeLinearGradientColorStops(),M=this.createLinearGradient(o.x,o.y,b.x,b.y);if(I){for(let U=0;U<I.length;U+=2)M.addColorStop(I[U],I[U+1]);this.setAttr("strokeStyle",M)}}_stroke(u){const o=u.dash(),b=u.getStrokeScaleEnabled();if(u.hasStroke()){if(!b){this.save();const M=this.getCanvas().getPixelRatio();this.setTransform(M,0,0,M,0,0)}this._applyLineCap(u),o&&u.dashEnabled()&&(this.setLineDash(o),this.setAttr("lineDashOffset",u.dashOffset())),this.setAttr("lineWidth",u.strokeWidth()),u.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),u.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(u):this.setAttr("strokeStyle",u.stroke()),u._strokeFunc(this),b||this.restore()}}_applyShadow(u){var o,b,I;const M=(o=u.getShadowRGBA())!==null&&o!==void 0?o:"black",U=(b=u.getShadowBlur())!==null&&b!==void 0?b:5,N=(I=u.getShadowOffset())!==null&&I!==void 0?I:{x:0,y:0},A=u.getAbsoluteScale(),E=this.canvas.getPixelRatio(),B=A.x*E,q=A.y*E;this.setAttr("shadowColor",M),this.setAttr("shadowBlur",U*Math.min(Math.abs(B),Math.abs(q))),this.setAttr("shadowOffsetX",N.x*B),this.setAttr("shadowOffsetY",N.y*q)}}En.SceneContext=S;class P extends h{constructor(u){super(u),this._context=u._canvas.getContext("2d",{willReadFrequently:!0})}_fill(u){this.save(),this.setAttr("fillStyle",u.colorKey),u._fillFuncHit(this),this.restore()}strokeShape(u){u.hasHitStroke()&&this._stroke(u)}_stroke(u){if(u.hasHitStroke()){const o=u.getStrokeScaleEnabled();if(!o){this.save();const M=this.getCanvas().getPixelRatio();this.setTransform(M,0,0,M,0,0)}this._applyLineCap(u);const b=u.hitStrokeWidth(),I=b==="auto"?u.strokeWidth():b;this.setAttr("lineWidth",I),this.setAttr("strokeStyle",u.colorKey),u._strokeFuncHit(this),o||this.restore()}}}return En.HitContext=P,En}var Zo;function Wi(){if(Zo)return kn;Zo=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.HitCanvas=kn.SceneCanvas=kn.Canvas=void 0;const s=nt(),d=Jo(),L=Re();let z;function R(){if(z)return z;const g=s.Util.createCanvasElement(),y=g.getContext("2d");return z=function(){const v=L.Konva._global.devicePixelRatio||1,k=y.webkitBackingStorePixelRatio||y.mozBackingStorePixelRatio||y.msBackingStorePixelRatio||y.oBackingStorePixelRatio||y.backingStorePixelRatio||1;return v/k}(),s.Util.releaseCanvas(g),z}let x=class{constructor(y){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const k=(y||{}).pixelRatio||L.Konva.pixelRatio||R();this.pixelRatio=k,this._canvas=s.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(y){const v=this.pixelRatio;this.pixelRatio=y,this.setSize(this.getWidth()/v,this.getHeight()/v)}setWidth(y){this.width=this._canvas.width=y*this.pixelRatio,this._canvas.style.width=y+"px";const v=this.pixelRatio;this.getContext()._context.scale(v,v)}setHeight(y){this.height=this._canvas.height=y*this.pixelRatio,this._canvas.style.height=y+"px";const v=this.pixelRatio;this.getContext()._context.scale(v,v)}getWidth(){return this.width}getHeight(){return this.height}setSize(y,v){this.setWidth(y||0),this.setHeight(v||0)}toDataURL(y,v){try{return this._canvas.toDataURL(y,v)}catch{try{return this._canvas.toDataURL()}catch(w){return s.Util.error("Unable to get data URL. "+w.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};kn.Canvas=x;class a extends x{constructor(y={width:0,height:0,willReadFrequently:!1}){super(y),this.context=new d.SceneContext(this,{willReadFrequently:y.willReadFrequently}),this.setSize(y.width,y.height)}}kn.SceneCanvas=a;class c extends x{constructor(y={width:0,height:0}){super(y),this.hitCanvas=!0,this.context=new d.HitContext(this),this.setSize(y.width,y.height)}}return kn.HitCanvas=c,kn}var la={},$o;function da(){return $o||($o=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.DD=void 0;const d=Re(),L=nt();s.DD={get isDragging(){let z=!1;return s.DD._dragElements.forEach(R=>{R.dragStatus==="dragging"&&(z=!0)}),z},justDragged:!1,get node(){let z;return s.DD._dragElements.forEach(R=>{z=R.node}),z},_dragElements:new Map,_drag(z){const R=[];s.DD._dragElements.forEach((x,a)=>{const{node:c}=x,g=c.getStage();g.setPointersPositions(z),x.pointerId===void 0&&(x.pointerId=L.Util._getFirstPointerId(z));const y=g._changedPointerPositions.find(v=>v.id===x.pointerId);if(y){if(x.dragStatus!=="dragging"){const v=c.dragDistance();if(Math.max(Math.abs(y.x-x.startPointerPos.x),Math.abs(y.y-x.startPointerPos.y))<v||(c.startDrag({evt:z}),!c.isDragging()))return}c._setDragPosition(z,x),R.push(c)}}),R.forEach(x=>{x.fire("dragmove",{type:"dragmove",target:x,evt:z},!0)})},_endDragBefore(z){const R=[];s.DD._dragElements.forEach(x=>{const{node:a}=x,c=a.getStage();if(z&&c.setPointersPositions(z),!c._changedPointerPositions.find(v=>v.id===x.pointerId))return;(x.dragStatus==="dragging"||x.dragStatus==="stopped")&&(s.DD.justDragged=!0,d.Konva._mouseListenClick=!1,d.Konva._touchListenClick=!1,d.Konva._pointerListenClick=!1,x.dragStatus="stopped");const y=x.node.getLayer()||x.node instanceof d.Konva.Stage&&x.node;y&&R.indexOf(y)===-1&&R.push(y)}),R.forEach(x=>{x.draw()})},_endDragAfter(z){s.DD._dragElements.forEach((R,x)=>{R.dragStatus==="stopped"&&R.node.fire("dragend",{type:"dragend",target:R.node,evt:z},!0),R.dragStatus!=="dragging"&&s.DD._dragElements.delete(x)})}},d.Konva.isBrowser&&(window.addEventListener("mouseup",s.DD._endDragBefore,!0),window.addEventListener("touchend",s.DD._endDragBefore,!0),window.addEventListener("touchcancel",s.DD._endDragBefore,!0),window.addEventListener("mousemove",s.DD._drag),window.addEventListener("touchmove",s.DD._drag),window.addEventListener("mouseup",s.DD._endDragAfter,!1),window.addEventListener("touchend",s.DD._endDragAfter,!1),window.addEventListener("touchcancel",s.DD._endDragAfter,!1))}(la)),la}var el;function it(){if(el)return Mr;el=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.Node=void 0;const s=nt(),d=Ae(),L=Wi(),z=Re(),R=da(),x=ze(),a="absoluteOpacity",c="allEventListeners",g="absoluteTransform",y="absoluteScale",v="canvas",k="Change",w="children",m="konva",h="listening",S="mouseenter",P="mouseleave",D="set",u="Shape",o=" ",b="stage",I="transform",M="Stage",U="visible",N=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(o);let A=1,E=class Uo{constructor(l){this._id=A++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(l),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(l){(l===I||l===g)&&this._cache.get(l)?this._cache.get(l).dirty=!0:l?this._cache.delete(l):this._cache.clear()}_getCache(l,_){let C=this._cache.get(l);return(C===void 0||(l===I||l===g)&&C.dirty===!0)&&(C=_.call(this),this._cache.set(l,C)),C}_calculate(l,_,C){if(!this._attachedDepsListeners.get(l)){const O=_.map(W=>W+"Change.konva").join(o);this.on(O,()=>{this._clearCache(l)}),this._attachedDepsListeners.set(l,!0)}return this._getCache(l,C)}_getCanvasCache(){return this._cache.get(v)}_clearSelfAndDescendantCache(l){this._clearCache(l),l===g&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(v)){const{scene:l,filter:_,hit:C}=this._cache.get(v);s.Util.releaseCanvas(l,_,C),this._cache.delete(v)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(l){const _=l||{};let C={};(_.x===void 0||_.y===void 0||_.width===void 0||_.height===void 0)&&(C=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let O=Math.ceil(_.width||C.width),W=Math.ceil(_.height||C.height),T=_.pixelRatio,X=_.x===void 0?Math.floor(C.x):_.x,Q=_.y===void 0?Math.floor(C.y):_.y,ne=_.offset||0,le=_.drawBorder||!1,ie=_.hitCanvasPixelRatio||1;if(!O||!W){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const oe=Math.abs(Math.round(C.x)-X)>.5?1:0,ge=Math.abs(Math.round(C.y)-Q)>.5?1:0;O+=ne*2+oe,W+=ne*2+ge,X-=ne,Q-=ne;const fe=new L.SceneCanvas({pixelRatio:T,width:O,height:W}),H=new L.SceneCanvas({pixelRatio:T,width:0,height:0,willReadFrequently:!0}),te=new L.HitCanvas({pixelRatio:ie,width:O,height:W}),de=fe.getContext(),ae=te.getContext();return te.isCache=!0,fe.isCache=!0,this._cache.delete(v),this._filterUpToDate=!1,_.imageSmoothingEnabled===!1&&(fe.getContext()._context.imageSmoothingEnabled=!1,H.getContext()._context.imageSmoothingEnabled=!1),de.save(),ae.save(),de.translate(-X,-Q),ae.translate(-X,-Q),this._isUnderCache=!0,this._clearSelfAndDescendantCache(a),this._clearSelfAndDescendantCache(y),this.drawScene(fe,this),this.drawHit(te,this),this._isUnderCache=!1,de.restore(),ae.restore(),le&&(de.save(),de.beginPath(),de.rect(0,0,O,W),de.closePath(),de.setAttr("strokeStyle","red"),de.setAttr("lineWidth",5),de.stroke(),de.restore()),this._cache.set(v,{scene:fe,filter:H,hit:te,x:X,y:Q}),this._requestDraw(),this}isCached(){return this._cache.has(v)}getClientRect(l){throw new Error('abstract "getClientRect" method call')}_transformedRect(l,_){const C=[{x:l.x,y:l.y},{x:l.x+l.width,y:l.y},{x:l.x+l.width,y:l.y+l.height},{x:l.x,y:l.y+l.height}];let O=1/0,W=1/0,T=-1/0,X=-1/0;const Q=this.getAbsoluteTransform(_);return C.forEach(function(ne){const le=Q.point(ne);O===void 0&&(O=T=le.x,W=X=le.y),O=Math.min(O,le.x),W=Math.min(W,le.y),T=Math.max(T,le.x),X=Math.max(X,le.y)}),{x:O,y:W,width:T-O,height:X-W}}_drawCachedSceneCanvas(l){l.save(),l._applyOpacity(this),l._applyGlobalCompositeOperation(this);const _=this._getCanvasCache();l.translate(_.x,_.y);const C=this._getCachedSceneCanvas(),O=C.pixelRatio;l.drawImage(C._canvas,0,0,C.width/O,C.height/O),l.restore()}_drawCachedHitCanvas(l){const _=this._getCanvasCache(),C=_.hit;l.save(),l.translate(_.x,_.y),l.drawImage(C._canvas,0,0,C.width/C.pixelRatio,C.height/C.pixelRatio),l.restore()}_getCachedSceneCanvas(){let l=this.filters(),_=this._getCanvasCache(),C=_.scene,O=_.filter,W=O.getContext(),T,X,Q,ne;if(l){if(!this._filterUpToDate){const le=C.pixelRatio;O.setSize(C.width/C.pixelRatio,C.height/C.pixelRatio);try{for(T=l.length,W.clear(),W.drawImage(C._canvas,0,0,C.getWidth()/le,C.getHeight()/le),X=W.getImageData(0,0,O.getWidth(),O.getHeight()),Q=0;Q<T;Q++){if(ne=l[Q],typeof ne!="function"){s.Util.error("Filter should be type of function, but got "+typeof ne+" instead. Please check correct filters");continue}ne.call(this,X),W.putImageData(X,0,0)}}catch(ie){s.Util.error("Unable to apply filter. "+ie.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return O}return C}on(l,_){if(this._cache&&this._cache.delete(c),arguments.length===3)return this._delegate.apply(this,arguments);let C=l.split(o),O=C.length,W,T,X,Q,ne;for(W=0;W<O;W++)T=C[W],X=T.split("."),Q=X[0],ne=X[1]||"",this.eventListeners[Q]||(this.eventListeners[Q]=[]),this.eventListeners[Q].push({name:ne,handler:_});return this}off(l,_){let C=(l||"").split(o),O=C.length,W,T,X,Q,ne,le;if(this._cache&&this._cache.delete(c),!l)for(T in this.eventListeners)this._off(T);for(W=0;W<O;W++)if(X=C[W],Q=X.split("."),ne=Q[0],le=Q[1],ne)this.eventListeners[ne]&&this._off(ne,le,_);else for(T in this.eventListeners)this._off(T,le,_);return this}dispatchEvent(l){const _={target:this,type:l.type,evt:l};return this.fire(l.type,_),this}addEventListener(l,_){return this.on(l,function(C){_.call(this,C.evt)}),this}removeEventListener(l){return this.off(l),this}_delegate(l,_,C){const O=this;this.on(l,function(W){const T=W.target.findAncestors(_,!0,O);for(let X=0;X<T.length;X++)W=s.Util.cloneObject(W),W.currentTarget=T[X],C.call(T[X],W)})}remove(){return this.isDragging()&&this.stopDrag(),R.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(g),this._clearSelfAndDescendantCache(a),this._clearSelfAndDescendantCache(y),this._clearSelfAndDescendantCache(b),this._clearSelfAndDescendantCache(U),this._clearSelfAndDescendantCache(h)}_remove(){this._clearCaches();const l=this.getParent();l&&l.children&&(l.children.splice(this.index,1),l._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(l){const _="get"+s.Util._capitalize(l);return s.Util._isFunction(this[_])?this[_]():this.attrs[l]}getAncestors(){let l=this.getParent(),_=[];for(;l;)_.push(l),l=l.getParent();return _}getAttrs(){return this.attrs||{}}setAttrs(l){return this._batchTransformChanges(()=>{let _,C;if(!l)return this;for(_ in l)_!==w&&(C=D+s.Util._capitalize(_),s.Util._isFunction(this[C])?this[C](l[_]):this._setAttr(_,l[_]))}),this}isListening(){return this._getCache(h,this._isListening)}_isListening(l){if(!this.listening())return!1;const C=this.getParent();return C&&C!==l&&this!==l?C._isListening(l):!0}isVisible(){return this._getCache(U,this._isVisible)}_isVisible(l){if(!this.visible())return!1;const C=this.getParent();return C&&C!==l&&this!==l?C._isVisible(l):!0}shouldDrawHit(l,_=!1){if(l)return this._isVisible(l)&&this._isListening(l);const C=this.getLayer();let O=!1;R.DD._dragElements.forEach(T=>{T.dragStatus==="dragging"&&(T.node.nodeType==="Stage"||T.node.getLayer()===C)&&(O=!0)});const W=!_&&!z.Konva.hitOnDragEnabled&&(O||z.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!W}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let l=this.getDepth(),_=this,C=0,O,W,T,X;function Q(le){for(O=[],W=le.length,T=0;T<W;T++)X=le[T],C++,X.nodeType!==u&&(O=O.concat(X.getChildren().slice())),X._id===_._id&&(T=W);O.length>0&&O[0].getDepth()<=l&&Q(O)}const ne=this.getStage();return _.nodeType!==M&&ne&&Q(ne.getChildren()),C}getDepth(){let l=0,_=this.parent;for(;_;)l++,_=_.parent;return l}_batchTransformChanges(l){this._batchingTransformChange=!0,l(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(I),this._clearSelfAndDescendantCache(g)),this._needClearTransformCache=!1}setPosition(l){return this._batchTransformChanges(()=>{this.x(l.x),this.y(l.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const l=this.getStage();if(!l)return null;const _=l.getPointerPosition();if(!_)return null;const C=this.getAbsoluteTransform().copy();return C.invert(),C.point(_)}getAbsolutePosition(l){let _=!1,C=this.parent;for(;C;){if(C.isCached()){_=!0;break}C=C.parent}_&&!l&&(l=!0);const O=this.getAbsoluteTransform(l).getMatrix(),W=new s.Transform,T=this.offset();return W.m=O.slice(),W.translate(T.x,T.y),W.getTranslation()}setAbsolutePosition(l){const{x:_,y:C,...O}=this._clearTransform();this.attrs.x=_,this.attrs.y=C,this._clearCache(I);const W=this._getAbsoluteTransform().copy();return W.invert(),W.translate(l.x,l.y),l={x:this.attrs.x+W.getTranslation().x,y:this.attrs.y+W.getTranslation().y},this._setTransform(O),this.setPosition({x:l.x,y:l.y}),this._clearCache(I),this._clearSelfAndDescendantCache(g),this}_setTransform(l){let _;for(_ in l)this.attrs[_]=l[_]}_clearTransform(){const l={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,l}move(l){let _=l.x,C=l.y,O=this.x(),W=this.y();return _!==void 0&&(O+=_),C!==void 0&&(W+=C),this.setPosition({x:O,y:W}),this}_eachAncestorReverse(l,_){let C=[],O=this.getParent(),W,T;if(!(_&&_._id===this._id)){for(C.unshift(this);O&&(!_||O._id!==_._id);)C.unshift(O),O=O.parent;for(W=C.length,T=0;T<W;T++)l(C[T])}}rotate(l){return this.rotation(this.rotation()+l),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const l=this.index,_=this.parent.getChildren().length;return l<_-1?(this.parent.children.splice(l,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const l=this.index,_=this.parent.getChildren().length;return l<_-1?(this.parent.children.splice(l,1),this.parent.children.splice(l+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const l=this.index;return l>0?(this.parent.children.splice(l,1),this.parent.children.splice(l-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const l=this.index;return l>0?(this.parent.children.splice(l,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(l){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(l<0||l>=this.parent.children.length)&&s.Util.warn("Unexpected value "+l+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const _=this.index;return this.parent.children.splice(_,1),this.parent.children.splice(l,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(a,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let l=this.opacity();const _=this.getParent();return _&&!_._isUnderCache&&(l*=_.getAbsoluteOpacity()),l}moveTo(l){return this.getParent()!==l&&(this._remove(),l.add(this)),this}toObject(){let l=this.getAttrs(),_,C,O,W,T;const X={attrs:{},className:this.getClassName()};for(_ in l)C=l[_],T=s.Util.isObject(C)&&!s.Util._isPlainObject(C)&&!s.Util._isArray(C),!T&&(O=typeof this[_]=="function"&&this[_],delete l[_],W=O?O.call(this):null,l[_]=C,W!==C&&(X.attrs[_]=C));return s.Util._prepareToStringify(X)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(l,_,C){const O=[];_&&this._isMatch(l)&&O.push(this);let W=this.parent;for(;W;){if(W===C)return O;W._isMatch(l)&&O.push(W),W=W.parent}return O}isAncestorOf(l){return!1}findAncestor(l,_,C){return this.findAncestors(l,_,C)[0]}_isMatch(l){if(!l)return!1;if(typeof l=="function")return l(this);let _=l.replace(/ /g,"").split(","),C=_.length,O,W;for(O=0;O<C;O++)if(W=_[O],s.Util.isValidSelector(W)||(s.Util.warn('Selector "'+W+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),W.charAt(0)==="#"){if(this.id()===W.slice(1))return!0}else if(W.charAt(0)==="."){if(this.hasName(W.slice(1)))return!0}else if(this.className===W||this.nodeType===W)return!0;return!1}getLayer(){const l=this.getParent();return l?l.getLayer():null}getStage(){return this._getCache(b,this._getStage)}_getStage(){const l=this.getParent();return l?l.getStage():null}fire(l,_={},C){return _.target=_.target||this,C?this._fireAndBubble(l,_):this._fire(l,_),this}getAbsoluteTransform(l){return l?this._getAbsoluteTransform(l):this._getCache(g,this._getAbsoluteTransform)}_getAbsoluteTransform(l){let _;if(l)return _=new s.Transform,this._eachAncestorReverse(function(C){const O=C.transformsEnabled();O==="all"?_.multiply(C.getTransform()):O==="position"&&_.translate(C.x()-C.offsetX(),C.y()-C.offsetY())},l),_;{_=this._cache.get(g)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(_):_.reset();const C=this.transformsEnabled();if(C==="all")_.multiply(this.getTransform());else if(C==="position"){const O=this.attrs.x||0,W=this.attrs.y||0,T=this.attrs.offsetX||0,X=this.attrs.offsetY||0;_.translate(O-T,W-X)}return _.dirty=!1,_}}getAbsoluteScale(l){let _=this;for(;_;)_._isUnderCache&&(l=_),_=_.getParent();const O=this.getAbsoluteTransform(l).decompose();return{x:O.scaleX,y:O.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(I,this._getTransform)}_getTransform(){var l,_;const C=this._cache.get(I)||new s.Transform;C.reset();const O=this.x(),W=this.y(),T=z.Konva.getAngle(this.rotation()),X=(l=this.attrs.scaleX)!==null&&l!==void 0?l:1,Q=(_=this.attrs.scaleY)!==null&&_!==void 0?_:1,ne=this.attrs.skewX||0,le=this.attrs.skewY||0,ie=this.attrs.offsetX||0,oe=this.attrs.offsetY||0;return(O!==0||W!==0)&&C.translate(O,W),T!==0&&C.rotate(T),(ne!==0||le!==0)&&C.skew(ne,le),(X!==1||Q!==1)&&C.scale(X,Q),(ie!==0||oe!==0)&&C.translate(-1*ie,-1*oe),C.dirty=!1,C}clone(l){let _=s.Util.cloneObject(this.attrs),C,O,W,T,X;for(C in l)_[C]=l[C];const Q=new this.constructor(_);for(C in this.eventListeners)for(O=this.eventListeners[C],W=O.length,T=0;T<W;T++)X=O[T],X.name.indexOf(m)<0&&(Q.eventListeners[C]||(Q.eventListeners[C]=[]),Q.eventListeners[C].push(X));return Q}_toKonvaCanvas(l){l=l||{};const _=this.getClientRect(),C=this.getStage(),O=l.x!==void 0?l.x:Math.floor(_.x),W=l.y!==void 0?l.y:Math.floor(_.y),T=l.pixelRatio||1,X=new L.SceneCanvas({width:l.width||Math.ceil(_.width)||(C?C.width():0),height:l.height||Math.ceil(_.height)||(C?C.height():0),pixelRatio:T}),Q=X.getContext(),ne=new L.SceneCanvas({width:X.width/X.pixelRatio+Math.abs(O),height:X.height/X.pixelRatio+Math.abs(W),pixelRatio:X.pixelRatio});return l.imageSmoothingEnabled===!1&&(Q._context.imageSmoothingEnabled=!1),Q.save(),(O||W)&&Q.translate(-1*O,-1*W),this.drawScene(X,void 0,ne),Q.restore(),X}toCanvas(l){return this._toKonvaCanvas(l)._canvas}toDataURL(l){l=l||{};const _=l.mimeType||null,C=l.quality||null,O=this._toKonvaCanvas(l).toDataURL(_,C);return l.callback&&l.callback(O),O}toImage(l){return new Promise((_,C)=>{try{const O=l==null?void 0:l.callback;O&&delete l.callback,s.Util._urlToImage(this.toDataURL(l),function(W){_(W),O==null||O(W)})}catch(O){C(O)}})}toBlob(l){return new Promise((_,C)=>{try{const O=l==null?void 0:l.callback;O&&delete l.callback,this.toCanvas(l).toBlob(W=>{_(W),O==null||O(W)},l==null?void 0:l.mimeType,l==null?void 0:l.quality)}catch(O){C(O)}})}setSize(l){return this.width(l.width),this.height(l.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():z.Konva.dragDistance}_off(l,_,C){let O=this.eventListeners[l],W,T,X;for(W=0;W<O.length;W++)if(T=O[W].name,X=O[W].handler,(T!=="konva"||_==="konva")&&(!_||T===_)&&(!C||C===X)){if(O.splice(W,1),O.length===0){delete this.eventListeners[l];break}W--}}_fireChangeEvent(l,_,C){this._fire(l+k,{oldVal:_,newVal:C})}addName(l){if(!this.hasName(l)){const _=this.name(),C=_?_+" "+l:l;this.name(C)}return this}hasName(l){if(!l)return!1;const _=this.name();return _?(_||"").split(/\s/g).indexOf(l)!==-1:!1}removeName(l){const _=(this.name()||"").split(/\s/g),C=_.indexOf(l);return C!==-1&&(_.splice(C,1),this.name(_.join(" "))),this}setAttr(l,_){const C=this[D+s.Util._capitalize(l)];return s.Util._isFunction(C)?C.call(this,_):this._setAttr(l,_),this}_requestDraw(){if(z.Konva.autoDrawEnabled){const l=this.getLayer()||this.getStage();l==null||l.batchDraw()}}_setAttr(l,_){const C=this.attrs[l];C===_&&!s.Util.isObject(_)||(_==null?delete this.attrs[l]:this.attrs[l]=_,this._shouldFireChangeEvents&&this._fireChangeEvent(l,C,_),this._requestDraw())}_setComponentAttr(l,_,C){let O;C!==void 0&&(O=this.attrs[l],O||(this.attrs[l]=this.getAttr(l)),this.attrs[l][_]=C,this._fireChangeEvent(l,O,C))}_fireAndBubble(l,_,C){if(_&&this.nodeType===u&&(_.target=this),!((l===S||l===P)&&(C&&(this===C||this.isAncestorOf&&this.isAncestorOf(C))||this.nodeType==="Stage"&&!C))){this._fire(l,_);const W=(l===S||l===P)&&C&&C.isAncestorOf&&C.isAncestorOf(this)&&!C.isAncestorOf(this.parent);(_&&!_.cancelBubble||!_)&&this.parent&&this.parent.isListening()&&!W&&(C&&C.parent?this._fireAndBubble.call(this.parent,l,_,C):this._fireAndBubble.call(this.parent,l,_))}}_getProtoListeners(l){var _,C,O;const W=(_=this._cache.get(c))!==null&&_!==void 0?_:{};let T=W==null?void 0:W[l];if(T===void 0){T=[];let X=Object.getPrototypeOf(this);for(;X;){const Q=(O=(C=X.eventListeners)===null||C===void 0?void 0:C[l])!==null&&O!==void 0?O:[];T.push(...Q),X=Object.getPrototypeOf(X)}W[l]=T,this._cache.set(c,W)}return T}_fire(l,_){_=_||{},_.currentTarget=this,_.type=l;const C=this._getProtoListeners(l);if(C)for(var O=0;O<C.length;O++)C[O].handler.call(this,_);const W=this.eventListeners[l];if(W)for(var O=0;O<W.length;O++)W[O].handler.call(this,_)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(l){const _=l?l.pointerId:void 0,C=this.getStage(),O=this.getAbsolutePosition();if(!C)return;const W=C._getPointerById(_)||C._changedPointerPositions[0]||O;R.DD._dragElements.set(this._id,{node:this,startPointerPos:W,offset:{x:W.x-O.x,y:W.y-O.y},dragStatus:"ready",pointerId:_})}startDrag(l,_=!0){R.DD._dragElements.has(this._id)||this._createDragElement(l);const C=R.DD._dragElements.get(this._id);C.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:l&&l.evt},_)}_setDragPosition(l,_){const C=this.getStage()._getPointerById(_.pointerId);if(!C)return;let O={x:C.x-_.offset.x,y:C.y-_.offset.y};const W=this.dragBoundFunc();if(W!==void 0){const T=W.call(this,O,l);T?O=T:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==O.x||this._lastPos.y!==O.y)&&(this.setAbsolutePosition(O),this._requestDraw()),this._lastPos=O}stopDrag(l){const _=R.DD._dragElements.get(this._id);_&&(_.dragStatus="stopped"),R.DD._endDragBefore(l),R.DD._endDragAfter(l)}setDraggable(l){this._setAttr("draggable",l),this._dragChange()}isDragging(){const l=R.DD._dragElements.get(this._id);return l?l.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(l){if(!(!(l.evt.button!==void 0)||z.Konva.dragButtons.indexOf(l.evt.button)>=0)||this.isDragging())return;let O=!1;R.DD._dragElements.forEach(W=>{this.isAncestorOf(W.node)&&(O=!0)}),O||this._createDragElement(l)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const _=R.DD._dragElements.get(this._id),C=_&&_.dragStatus==="dragging",O=_&&_.dragStatus==="ready";C?this.stopDrag():O&&R.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(l={x:0,y:0}){const _=this.getStage();if(!_)return!1;const C={x:-l.x,y:-l.y,width:_.width()+2*l.x,height:_.height()+2*l.y};return s.Util.haveIntersection(C,this.getClientRect())}static create(l,_){return s.Util._isString(l)&&(l=JSON.parse(l)),this._createNode(l,_)}static _createNode(l,_){let C=Uo.prototype.getClassName.call(l),O=l.children,W,T,X;_&&(l.attrs.container=_),z.Konva[C]||(s.Util.warn('Can not find a node with class name "'+C+'". Fallback to "Shape".'),C="Shape");const Q=z.Konva[C];if(W=new Q(l.attrs),O)for(T=O.length,X=0;X<T;X++)W.add(Uo._createNode(O[X]));return W}};Mr.Node=E,E.prototype.nodeType="Node",E.prototype._attrsAffectingSize=[],E.prototype.eventListeners={},E.prototype.on.call(E.prototype,N,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(I),this._clearSelfAndDescendantCache(g)}),E.prototype.on.call(E.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(U)}),E.prototype.on.call(E.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(h)}),E.prototype.on.call(E.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(a)});const B=d.Factory.addGetterSetter;return B(E,"zIndex"),B(E,"absolutePosition"),B(E,"position"),B(E,"x",0,(0,x.getNumberValidator)()),B(E,"y",0,(0,x.getNumberValidator)()),B(E,"globalCompositeOperation","source-over",(0,x.getStringValidator)()),B(E,"opacity",1,(0,x.getNumberValidator)()),B(E,"name","",(0,x.getStringValidator)()),B(E,"id","",(0,x.getStringValidator)()),B(E,"rotation",0,(0,x.getNumberValidator)()),d.Factory.addComponentsGetterSetter(E,"scale",["x","y"]),B(E,"scaleX",1,(0,x.getNumberValidator)()),B(E,"scaleY",1,(0,x.getNumberValidator)()),d.Factory.addComponentsGetterSetter(E,"skew",["x","y"]),B(E,"skewX",0,(0,x.getNumberValidator)()),B(E,"skewY",0,(0,x.getNumberValidator)()),d.Factory.addComponentsGetterSetter(E,"offset",["x","y"]),B(E,"offsetX",0,(0,x.getNumberValidator)()),B(E,"offsetY",0,(0,x.getNumberValidator)()),B(E,"dragDistance",void 0,(0,x.getNumberValidator)()),B(E,"width",0,(0,x.getNumberValidator)()),B(E,"height",0,(0,x.getNumberValidator)()),B(E,"listening",!0,(0,x.getBooleanValidator)()),B(E,"preventDefault",!0,(0,x.getBooleanValidator)()),B(E,"filters",void 0,function(q){return this._filterUpToDate=!1,q}),B(E,"visible",!0,(0,x.getBooleanValidator)()),B(E,"transformsEnabled","all",(0,x.getStringValidator)()),B(E,"size"),B(E,"dragBoundFunc"),B(E,"draggable",!1,(0,x.getBooleanValidator)()),d.Factory.backCompat(E,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Mr}var Ar={},tl;function Vi(){if(tl)return Ar;tl=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.Container=void 0;const s=Ae(),d=it(),L=ze();let z=class extends d.Node{constructor(){super(...arguments),this.children=[]}getChildren(x){if(!x)return this.children||[];const a=this.children||[],c=[];return a.forEach(function(g){x(g)&&c.push(g)}),c}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(x=>{x.parent=null,x.index=0,x.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(x=>{x.parent=null,x.index=0,x.destroy()}),this.children=[],this._requestDraw(),this}add(...x){if(x.length===0)return this;if(x.length>1){for(let c=0;c<x.length;c++)this.add(x[c]);return this}const a=x[0];return a.getParent()?(a.moveTo(this),this):(this._validateAdd(a),a.index=this.getChildren().length,a.parent=this,a._clearCaches(),this.getChildren().push(a),this._fire("add",{child:a}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(x){return this._generalFind(x,!1)}findOne(x){const a=this._generalFind(x,!0);return a.length>0?a[0]:void 0}_generalFind(x,a){const c=[];return this._descendants(g=>{const y=g._isMatch(x);return y&&c.push(g),!!(y&&a)}),c}_descendants(x){let a=!1;const c=this.getChildren();for(const g of c){if(a=x(g),a)return!0;if(g.hasChildren()&&(a=g._descendants(x),a))return!0}return!1}toObject(){const x=d.Node.prototype.toObject.call(this);return x.children=[],this.getChildren().forEach(a=>{x.children.push(a.toObject())}),x}isAncestorOf(x){let a=x.getParent();for(;a;){if(a._id===this._id)return!0;a=a.getParent()}return!1}clone(x){const a=d.Node.prototype.clone.call(this,x);return this.getChildren().forEach(function(c){a.add(c.clone())}),a}getAllIntersections(x){const a=[];return this.find("Shape").forEach(c=>{c.isVisible()&&c.intersects(x)&&a.push(c)}),a}_clearSelfAndDescendantCache(x){var a;super._clearSelfAndDescendantCache(x),!this.isCached()&&((a=this.children)===null||a===void 0||a.forEach(function(c){c._clearSelfAndDescendantCache(x)}))}_setChildrenIndices(){var x;(x=this.children)===null||x===void 0||x.forEach(function(a,c){a.index=c}),this._requestDraw()}drawScene(x,a,c){const g=this.getLayer(),y=x||g&&g.getCanvas(),v=y&&y.getContext(),k=this._getCanvasCache(),w=k&&k.scene,m=y&&y.isCache;if(!this.isVisible()&&!m)return this;if(w){v.save();const h=this.getAbsoluteTransform(a).getMatrix();v.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(v),v.restore()}else this._drawChildren("drawScene",y,a,c);return this}drawHit(x,a){if(!this.shouldDrawHit(a))return this;const c=this.getLayer(),g=x||c&&c.hitCanvas,y=g&&g.getContext(),v=this._getCanvasCache();if(v&&v.hit){y.save();const w=this.getAbsoluteTransform(a).getMatrix();y.transform(w[0],w[1],w[2],w[3],w[4],w[5]),this._drawCachedHitCanvas(y),y.restore()}else this._drawChildren("drawHit",g,a);return this}_drawChildren(x,a,c,g){var y;const v=a&&a.getContext(),k=this.clipWidth(),w=this.clipHeight(),m=this.clipFunc(),h=typeof k=="number"&&typeof w=="number"||m,S=c===this;if(h){v.save();const D=this.getAbsoluteTransform(c);let u=D.getMatrix();v.transform(u[0],u[1],u[2],u[3],u[4],u[5]),v.beginPath();let o;if(m)o=m.call(this,v,this);else{const b=this.clipX(),I=this.clipY();v.rect(b||0,I||0,k,w)}v.clip.apply(v,o),u=D.copy().invert().getMatrix(),v.transform(u[0],u[1],u[2],u[3],u[4],u[5])}const P=!S&&this.globalCompositeOperation()!=="source-over"&&x==="drawScene";P&&(v.save(),v._applyGlobalCompositeOperation(this)),(y=this.children)===null||y===void 0||y.forEach(function(D){D[x](a,c,g)}),P&&v.restore(),h&&v.restore()}getClientRect(x={}){var a;const c=x.skipTransform,g=x.relativeTo;let y,v,k,w,m={x:1/0,y:1/0,width:0,height:0};const h=this;(a=this.children)===null||a===void 0||a.forEach(function(D){if(!D.visible())return;const u=D.getClientRect({relativeTo:h,skipShadow:x.skipShadow,skipStroke:x.skipStroke});u.width===0&&u.height===0||(y===void 0?(y=u.x,v=u.y,k=u.x+u.width,w=u.y+u.height):(y=Math.min(y,u.x),v=Math.min(v,u.y),k=Math.max(k,u.x+u.width),w=Math.max(w,u.y+u.height)))});const S=this.find("Shape");let P=!1;for(let D=0;D<S.length;D++)if(S[D]._isVisible(this)){P=!0;break}return P&&y!==void 0?m={x:y,y:v,width:k-y,height:w-v}:m={x:0,y:0,width:0,height:0},c?m:this._transformedRect(m,g)}};return Ar.Container=z,s.Factory.addComponentsGetterSetter(z,"clip",["x","y","width","height"]),s.Factory.addGetterSetter(z,"clipX",void 0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(z,"clipY",void 0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(z,"clipWidth",void 0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(z,"clipHeight",void 0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(z,"clipFunc"),Ar}var ua={},Ln={},nl;function rl(){if(nl)return Ln;nl=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.getCapturedShape=z,Ln.createEvent=R,Ln.hasPointerCapture=x,Ln.setPointerCapture=a,Ln.releaseCapture=c;const s=Re(),d=new Map,L=s.Konva._global.PointerEvent!==void 0;function z(g){return d.get(g)}function R(g){return{evt:g,pointerId:g.pointerId}}function x(g,y){return d.get(g)===y}function a(g,y){c(g),y.getStage()&&(d.set(g,y),L&&y._fire("gotpointercapture",R(new PointerEvent("gotpointercapture"))))}function c(g,y){const v=d.get(g);if(!v)return;const k=v.getStage();k&&k.content,d.delete(g),L&&v._fire("lostpointercapture",R(new PointerEvent("lostpointercapture")))}return Ln}var il;function pc(){return il||(il=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Stage=s.stages=void 0;const d=nt(),L=Ae(),z=Vi(),R=Re(),x=Wi(),a=da(),c=Re(),g=rl(),y="Stage",v="string",k="px",w="mouseout",m="mouseleave",h="mouseover",S="mouseenter",P="mousemove",D="mousedown",u="mouseup",o="pointermove",b="pointerdown",I="pointerup",M="pointercancel",U="lostpointercapture",N="pointerout",A="pointerleave",E="pointerover",B="pointerenter",q="contextmenu",l="touchstart",_="touchend",C="touchmove",O="touchcancel",W="wheel",T=5,X=[[S,"_pointerenter"],[D,"_pointerdown"],[P,"_pointermove"],[u,"_pointerup"],[m,"_pointerleave"],[l,"_pointerdown"],[C,"_pointermove"],[_,"_pointerup"],[O,"_pointercancel"],[h,"_pointerover"],[W,"_wheel"],[q,"_contextmenu"],[b,"_pointerdown"],[o,"_pointermove"],[I,"_pointerup"],[M,"_pointercancel"],[U,"_lostpointercapture"]],Q={mouse:{[N]:w,[A]:m,[E]:h,[B]:S,[o]:P,[b]:D,[I]:u,[M]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[N]:"touchout",[A]:"touchleave",[E]:"touchover",[B]:"touchenter",[o]:C,[b]:l,[I]:_,[M]:O,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[N]:N,[A]:A,[E]:E,[B]:B,[o]:o,[b]:b,[I]:I,[M]:M,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ne=fe=>fe.indexOf("pointer")>=0?"pointer":fe.indexOf("touch")>=0?"touch":"mouse",le=fe=>{const H=ne(fe);if(H==="pointer")return R.Konva.pointerEventsEnabled&&Q.pointer;if(H==="touch")return Q.touch;if(H==="mouse")return Q.mouse};function ie(fe={}){return(fe.clipFunc||fe.clipWidth||fe.clipHeight)&&d.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),fe}const oe="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";s.stages=[];class ge extends z.Container{constructor(H){super(ie(H)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),s.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ie(this.attrs)}),this._checkVisibility()}_validateAdd(H){const te=H.getType()==="Layer",de=H.getType()==="FastLayer";te||de||d.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const H=this.visible()?"":"none";this.content.style.display=H}setContainer(H){if(typeof H===v){if(H.charAt(0)==="."){const de=H.slice(1);H=document.getElementsByClassName(de)[0]}else{var te;H.charAt(0)!=="#"?te=H:te=H.slice(1),H=document.getElementById(te)}if(!H)throw"Can not find container in document with id "+te}return this._setAttr("container",H),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),H.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const H=this.children,te=H.length;for(let de=0;de<te;de++)H[de].clear();return this}clone(H){return H||(H={}),H.container=typeof document<"u"&&document.createElement("div"),z.Container.prototype.clone.call(this,H)}destroy(){super.destroy();const H=this.content;H&&d.Util._isInDocument(H)&&this.container().removeChild(H);const te=s.stages.indexOf(this);return te>-1&&s.stages.splice(te,1),d.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const H=this._pointerPositions[0]||this._changedPointerPositions[0];return H?{x:H.x,y:H.y}:(d.Util.warn(oe),null)}_getPointerById(H){return this._pointerPositions.find(te=>te.id===H)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(H){H=H||{},H.x=H.x||0,H.y=H.y||0,H.width=H.width||this.width(),H.height=H.height||this.height();const te=new x.SceneCanvas({width:H.width,height:H.height,pixelRatio:H.pixelRatio||1}),de=te.getContext()._context,ae=this.children;return(H.x||H.y)&&de.translate(-1*H.x,-1*H.y),ae.forEach(function(ce){if(!ce.isVisible())return;const ve=ce._toKonvaCanvas(H);de.drawImage(ve._canvas,H.x,H.y,ve.getWidth()/ve.getPixelRatio(),ve.getHeight()/ve.getPixelRatio())}),te}getIntersection(H){if(!H)return null;const te=this.children,de=te.length,ae=de-1;for(let ce=ae;ce>=0;ce--){const ve=te[ce].getIntersection(H);if(ve)return ve}return null}_resizeDOM(){const H=this.width(),te=this.height();this.content&&(this.content.style.width=H+k,this.content.style.height=te+k),this.bufferCanvas.setSize(H,te),this.bufferHitCanvas.setSize(H,te),this.children.forEach(de=>{de.setSize({width:H,height:te}),de.draw()})}add(H,...te){if(arguments.length>1){for(let ae=0;ae<arguments.length;ae++)this.add(arguments[ae]);return this}super.add(H);const de=this.children.length;return de>T&&d.Util.warn("The stage has "+de+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),H.setSize({width:this.width(),height:this.height()}),H.draw(),R.Konva.isBrowser&&this.content.appendChild(H.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(H){return g.hasPointerCapture(H,this)}setPointerCapture(H){g.setPointerCapture(H,this)}releaseCapture(H){g.releaseCapture(H,this)}getLayers(){return this.children}_bindContentEvents(){R.Konva.isBrowser&&X.forEach(([H,te])=>{this.content.addEventListener(H,de=>{this[te](de)},{passive:!1})})}_pointerenter(H){this.setPointersPositions(H);const te=le(H.type);te&&this._fire(te.pointerenter,{evt:H,target:this,currentTarget:this})}_pointerover(H){this.setPointersPositions(H);const te=le(H.type);te&&this._fire(te.pointerover,{evt:H,target:this,currentTarget:this})}_getTargetShape(H){let te=this[H+"targetShape"];return te&&!te.getStage()&&(te=null),te}_pointerleave(H){const te=le(H.type),de=ne(H.type);if(!te)return;this.setPointersPositions(H);const ae=this._getTargetShape(de),ce=!(R.Konva.isDragging()||R.Konva.isTransforming())||R.Konva.hitOnDragEnabled;ae&&ce?(ae._fireAndBubble(te.pointerout,{evt:H}),ae._fireAndBubble(te.pointerleave,{evt:H}),this._fire(te.pointerleave,{evt:H,target:this,currentTarget:this}),this[de+"targetShape"]=null):ce&&(this._fire(te.pointerleave,{evt:H,target:this,currentTarget:this}),this._fire(te.pointerout,{evt:H,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(H){const te=le(H.type),de=ne(H.type);if(!te)return;this.setPointersPositions(H);let ae=!1;this._changedPointerPositions.forEach(ce=>{const ve=this.getIntersection(ce);if(a.DD.justDragged=!1,R.Konva["_"+de+"ListenClick"]=!0,!ve||!ve.isListening()){this[de+"ClickStartShape"]=void 0;return}R.Konva.capturePointerEventsEnabled&&ve.setPointerCapture(ce.id),this[de+"ClickStartShape"]=ve,ve._fireAndBubble(te.pointerdown,{evt:H,pointerId:ce.id}),ae=!0;const Ce=H.type.indexOf("touch")>=0;ve.preventDefault()&&H.cancelable&&Ce&&H.preventDefault()}),ae||this._fire(te.pointerdown,{evt:H,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(H){const te=le(H.type),de=ne(H.type);if(!te||(R.Konva.isDragging()&&a.DD.node.preventDefault()&&H.cancelable&&H.preventDefault(),this.setPointersPositions(H),!(!(R.Konva.isDragging()||R.Konva.isTransforming())||R.Konva.hitOnDragEnabled)))return;const ce={};let ve=!1;const Ce=this._getTargetShape(de);this._changedPointerPositions.forEach(Fe=>{const be=g.getCapturedShape(Fe.id)||this.getIntersection(Fe),$e=Fe.id,De={evt:H,pointerId:$e},Ue=Ce!==be;if(Ue&&Ce&&(Ce._fireAndBubble(te.pointerout,{...De},be),Ce._fireAndBubble(te.pointerleave,{...De},be)),be){if(ce[be._id])return;ce[be._id]=!0}be&&be.isListening()?(ve=!0,Ue&&(be._fireAndBubble(te.pointerover,{...De},Ce),be._fireAndBubble(te.pointerenter,{...De},Ce),this[de+"targetShape"]=be),be._fireAndBubble(te.pointermove,{...De})):Ce&&(this._fire(te.pointerover,{evt:H,target:this,currentTarget:this,pointerId:$e}),this[de+"targetShape"]=null)}),ve||this._fire(te.pointermove,{evt:H,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(H){const te=le(H.type),de=ne(H.type);if(!te)return;this.setPointersPositions(H);const ae=this[de+"ClickStartShape"],ce=this[de+"ClickEndShape"],ve={};let Ce=!1;this._changedPointerPositions.forEach(Fe=>{const be=g.getCapturedShape(Fe.id)||this.getIntersection(Fe);if(be){if(be.releaseCapture(Fe.id),ve[be._id])return;ve[be._id]=!0}const $e=Fe.id,De={evt:H,pointerId:$e};let Ue=!1;R.Konva["_"+de+"InDblClickWindow"]?(Ue=!0,clearTimeout(this[de+"DblTimeout"])):a.DD.justDragged||(R.Konva["_"+de+"InDblClickWindow"]=!0,clearTimeout(this[de+"DblTimeout"])),this[de+"DblTimeout"]=setTimeout(function(){R.Konva["_"+de+"InDblClickWindow"]=!1},R.Konva.dblClickWindow),be&&be.isListening()?(Ce=!0,this[de+"ClickEndShape"]=be,be._fireAndBubble(te.pointerup,{...De}),R.Konva["_"+de+"ListenClick"]&&ae&&ae===be&&(be._fireAndBubble(te.pointerclick,{...De}),Ue&&ce&&ce===be&&be._fireAndBubble(te.pointerdblclick,{...De}))):(this[de+"ClickEndShape"]=null,R.Konva["_"+de+"ListenClick"]&&this._fire(te.pointerclick,{evt:H,target:this,currentTarget:this,pointerId:$e}),Ue&&this._fire(te.pointerdblclick,{evt:H,target:this,currentTarget:this,pointerId:$e}))}),Ce||this._fire(te.pointerup,{evt:H,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),R.Konva["_"+de+"ListenClick"]=!1,H.cancelable&&de!=="touch"&&de!=="pointer"&&H.preventDefault()}_contextmenu(H){this.setPointersPositions(H);const te=this.getIntersection(this.getPointerPosition());te&&te.isListening()?te._fireAndBubble(q,{evt:H}):this._fire(q,{evt:H,target:this,currentTarget:this})}_wheel(H){this.setPointersPositions(H);const te=this.getIntersection(this.getPointerPosition());te&&te.isListening()?te._fireAndBubble(W,{evt:H}):this._fire(W,{evt:H,target:this,currentTarget:this})}_pointercancel(H){this.setPointersPositions(H);const te=g.getCapturedShape(H.pointerId)||this.getIntersection(this.getPointerPosition());te&&te._fireAndBubble(I,g.createEvent(H)),g.releaseCapture(H.pointerId)}_lostpointercapture(H){g.releaseCapture(H.pointerId)}setPointersPositions(H){const te=this._getContentPosition();let de=null,ae=null;H=H||window.event,H.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(H.touches,ce=>{this._pointerPositions.push({id:ce.identifier,x:(ce.clientX-te.left)/te.scaleX,y:(ce.clientY-te.top)/te.scaleY})}),Array.prototype.forEach.call(H.changedTouches||H.touches,ce=>{this._changedPointerPositions.push({id:ce.identifier,x:(ce.clientX-te.left)/te.scaleX,y:(ce.clientY-te.top)/te.scaleY})})):(de=(H.clientX-te.left)/te.scaleX,ae=(H.clientY-te.top)/te.scaleY,this.pointerPos={x:de,y:ae},this._pointerPositions=[{x:de,y:ae,id:d.Util._getFirstPointerId(H)}],this._changedPointerPositions=[{x:de,y:ae,id:d.Util._getFirstPointerId(H)}])}_setPointerPosition(H){d.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(H)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const H=this.content.getBoundingClientRect();return{top:H.top,left:H.left,scaleX:H.width/this.content.clientWidth||1,scaleY:H.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new x.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new x.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!R.Konva.isBrowser)return;const H=this.container();if(!H)throw"Stage has no container. A container is required.";H.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),H.appendChild(this.content),this._resizeDOM()}cache(){return d.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(H){H.batchDraw()}),this}}s.Stage=ge,ge.prototype.nodeType=y,(0,c._registerNode)(ge),L.Factory.addGetterSetter(ge,"container"),R.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{s.stages.forEach(fe=>{fe.batchDraw()})})}(ua)),ua}var Lr={},ca={},sl;function mt(){return sl||(sl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Shape=s.shapes=void 0;const d=Re(),L=nt(),z=Ae(),R=it(),x=ze(),a=Re(),c=rl(),g="hasShadow",y="shadowRGBA",v="patternImage",k="linearGradient",w="radialGradient";let m;function h(){return m||(m=L.Util.createCanvasElement().getContext("2d"),m)}s.shapes={};function S(A){const E=this.attrs.fillRule;E?A.fill(E):A.fill()}function P(A){A.stroke()}function D(A){const E=this.attrs.fillRule;E?A.fill(E):A.fill()}function u(A){A.stroke()}function o(){this._clearCache(g)}function b(){this._clearCache(y)}function I(){this._clearCache(v)}function M(){this._clearCache(k)}function U(){this._clearCache(w)}class N extends R.Node{constructor(E){super(E);let B;for(;B=L.Util.getRandomColor(),!(B&&!(B in s.shapes)););this.colorKey=B,s.shapes[B]=this}getContext(){return L.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return L.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(g,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(v,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const B=h().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(B&&B.setTransform){const q=new L.Transform;q.translate(this.fillPatternX(),this.fillPatternY()),q.rotate(d.Konva.getAngle(this.fillPatternRotation())),q.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),q.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const l=q.getMatrix(),_=typeof DOMMatrix>"u"?{a:l[0],b:l[1],c:l[2],d:l[3],e:l[4],f:l[5]}:new DOMMatrix(l);B.setTransform(_)}return B}}_getLinearGradient(){return this._getCache(k,this.__getLinearGradient)}__getLinearGradient(){const E=this.fillLinearGradientColorStops();if(E){const B=h(),q=this.fillLinearGradientStartPoint(),l=this.fillLinearGradientEndPoint(),_=B.createLinearGradient(q.x,q.y,l.x,l.y);for(let C=0;C<E.length;C+=2)_.addColorStop(E[C],E[C+1]);return _}}_getRadialGradient(){return this._getCache(w,this.__getRadialGradient)}__getRadialGradient(){const E=this.fillRadialGradientColorStops();if(E){const B=h(),q=this.fillRadialGradientStartPoint(),l=this.fillRadialGradientEndPoint(),_=B.createRadialGradient(q.x,q.y,this.fillRadialGradientStartRadius(),l.x,l.y,this.fillRadialGradientEndRadius());for(let C=0;C<E.length;C+=2)_.addColorStop(E[C],E[C+1]);return _}}getShadowRGBA(){return this._getCache(y,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const E=L.Util.colorToRGBA(this.shadowColor());if(E)return"rgba("+E.r+","+E.g+","+E.b+","+E.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const E=this.hitStrokeWidth();return E==="auto"?this.hasStroke():this.strokeEnabled()&&!!E}intersects(E){const B=this.getStage();if(!B)return!1;const q=B.bufferHitCanvas;return q.getContext().clear(),this.drawHit(q,void 0,!0),q.context.getImageData(Math.round(E.x),Math.round(E.y),1,1).data[3]>0}destroy(){return R.Node.prototype.destroy.call(this),delete s.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(E){var B;if(!((B=this.attrs.perfectDrawEnabled)!==null&&B!==void 0?B:!0))return!1;const l=E||this.hasFill(),_=this.hasStroke(),C=this.getAbsoluteOpacity()!==1;if(l&&_&&C)return!0;const O=this.hasShadow(),W=this.shadowForStrokeEnabled();return!!(l&&_&&O&&W)}setStrokeHitEnabled(E){L.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),E?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const E=this.size();return{x:this._centroid?-E.width/2:0,y:this._centroid?-E.height/2:0,width:E.width,height:E.height}}getClientRect(E={}){let B=!1,q=this.getParent();for(;q;){if(q.isCached()){B=!0;break}q=q.getParent()}const l=E.skipTransform,_=E.relativeTo||B&&this.getStage()||void 0,C=this.getSelfRect(),W=!E.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,T=C.width+W,X=C.height+W,Q=!E.skipShadow&&this.hasShadow(),ne=Q?this.shadowOffsetX():0,le=Q?this.shadowOffsetY():0,ie=T+Math.abs(ne),oe=X+Math.abs(le),ge=Q&&this.shadowBlur()||0,fe=ie+ge*2,H=oe+ge*2,te={width:fe,height:H,x:-(W/2+ge)+Math.min(ne,0)+C.x,y:-(W/2+ge)+Math.min(le,0)+C.y};return l?te:this._transformedRect(te,_)}drawScene(E,B,q){const l=this.getLayer();let _=E||l.getCanvas(),C=_.getContext(),O=this._getCanvasCache(),W=this.getSceneFunc(),T=this.hasShadow(),X,Q;const ne=_.isCache,le=B===this;if(!this.isVisible()&&!le)return this;if(O){C.save();const oe=this.getAbsoluteTransform(B).getMatrix();return C.transform(oe[0],oe[1],oe[2],oe[3],oe[4],oe[5]),this._drawCachedSceneCanvas(C),C.restore(),this}if(!W)return this;if(C.save(),this._useBufferCanvas()&&!ne){X=this.getStage();const oe=q||X.bufferCanvas;Q=oe.getContext(),Q.clear(),Q.save(),Q._applyLineJoin(this);var ie=this.getAbsoluteTransform(B).getMatrix();Q.transform(ie[0],ie[1],ie[2],ie[3],ie[4],ie[5]),W.call(this,Q,this),Q.restore();const ge=oe.pixelRatio;T&&C._applyShadow(this),C._applyOpacity(this),C._applyGlobalCompositeOperation(this),C.drawImage(oe._canvas,0,0,oe.width/ge,oe.height/ge)}else{if(C._applyLineJoin(this),!le){var ie=this.getAbsoluteTransform(B).getMatrix();C.transform(ie[0],ie[1],ie[2],ie[3],ie[4],ie[5]),C._applyOpacity(this),C._applyGlobalCompositeOperation(this)}T&&C._applyShadow(this),W.call(this,C,this)}return C.restore(),this}drawHit(E,B,q=!1){if(!this.shouldDrawHit(B,q))return this;const l=this.getLayer(),_=E||l.hitCanvas,C=_&&_.getContext(),O=this.hitFunc()||this.sceneFunc(),W=this._getCanvasCache(),T=W&&W.hit;if(this.colorKey||L.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),T){C.save();const Q=this.getAbsoluteTransform(B).getMatrix();return C.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5]),this._drawCachedHitCanvas(C),C.restore(),this}if(!O)return this;if(C.save(),C._applyLineJoin(this),!(this===B)){const Q=this.getAbsoluteTransform(B).getMatrix();C.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5])}return O.call(this,C,this),C.restore(),this}drawHitFromCache(E=0){const B=this._getCanvasCache(),q=this._getCachedSceneCanvas(),l=B.hit,_=l.getContext(),C=l.getWidth(),O=l.getHeight();_.clear(),_.drawImage(q._canvas,0,0,C,O);try{const W=_.getImageData(0,0,C,O),T=W.data,X=T.length,Q=L.Util._hexToRgb(this.colorKey);for(let ne=0;ne<X;ne+=4)T[ne+3]>E?(T[ne]=Q.r,T[ne+1]=Q.g,T[ne+2]=Q.b,T[ne+3]=255):T[ne+3]=0;_.putImageData(W,0,0)}catch(W){L.Util.error("Unable to draw hit graph from cached scene canvas. "+W.message)}return this}hasPointerCapture(E){return c.hasPointerCapture(E,this)}setPointerCapture(E){c.setPointerCapture(E,this)}releaseCapture(E){c.releaseCapture(E,this)}}s.Shape=N,N.prototype._fillFunc=S,N.prototype._strokeFunc=P,N.prototype._fillFuncHit=D,N.prototype._strokeFuncHit=u,N.prototype._centroid=!1,N.prototype.nodeType="Shape",(0,a._registerNode)(N),N.prototype.eventListeners={},N.prototype.on.call(N.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",o),N.prototype.on.call(N.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",b),N.prototype.on.call(N.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",I),N.prototype.on.call(N.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",M),N.prototype.on.call(N.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",U),z.Factory.addGetterSetter(N,"stroke",void 0,(0,x.getStringOrGradientValidator)()),z.Factory.addGetterSetter(N,"strokeWidth",2,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"fillAfterStrokeEnabled",!1),z.Factory.addGetterSetter(N,"hitStrokeWidth","auto",(0,x.getNumberOrAutoValidator)()),z.Factory.addGetterSetter(N,"strokeHitEnabled",!0,(0,x.getBooleanValidator)()),z.Factory.addGetterSetter(N,"perfectDrawEnabled",!0,(0,x.getBooleanValidator)()),z.Factory.addGetterSetter(N,"shadowForStrokeEnabled",!0,(0,x.getBooleanValidator)()),z.Factory.addGetterSetter(N,"lineJoin"),z.Factory.addGetterSetter(N,"lineCap"),z.Factory.addGetterSetter(N,"sceneFunc"),z.Factory.addGetterSetter(N,"hitFunc"),z.Factory.addGetterSetter(N,"dash"),z.Factory.addGetterSetter(N,"dashOffset",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"shadowColor",void 0,(0,x.getStringValidator)()),z.Factory.addGetterSetter(N,"shadowBlur",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"shadowOpacity",1,(0,x.getNumberValidator)()),z.Factory.addComponentsGetterSetter(N,"shadowOffset",["x","y"]),z.Factory.addGetterSetter(N,"shadowOffsetX",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"shadowOffsetY",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"fillPatternImage"),z.Factory.addGetterSetter(N,"fill",void 0,(0,x.getStringOrGradientValidator)()),z.Factory.addGetterSetter(N,"fillPatternX",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"fillPatternY",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"fillLinearGradientColorStops"),z.Factory.addGetterSetter(N,"strokeLinearGradientColorStops"),z.Factory.addGetterSetter(N,"fillRadialGradientStartRadius",0),z.Factory.addGetterSetter(N,"fillRadialGradientEndRadius",0),z.Factory.addGetterSetter(N,"fillRadialGradientColorStops"),z.Factory.addGetterSetter(N,"fillPatternRepeat","repeat"),z.Factory.addGetterSetter(N,"fillEnabled",!0),z.Factory.addGetterSetter(N,"strokeEnabled",!0),z.Factory.addGetterSetter(N,"shadowEnabled",!0),z.Factory.addGetterSetter(N,"dashEnabled",!0),z.Factory.addGetterSetter(N,"strokeScaleEnabled",!0),z.Factory.addGetterSetter(N,"fillPriority","color"),z.Factory.addComponentsGetterSetter(N,"fillPatternOffset",["x","y"]),z.Factory.addGetterSetter(N,"fillPatternOffsetX",0,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"fillPatternOffsetY",0,(0,x.getNumberValidator)()),z.Factory.addComponentsGetterSetter(N,"fillPatternScale",["x","y"]),z.Factory.addGetterSetter(N,"fillPatternScaleX",1,(0,x.getNumberValidator)()),z.Factory.addGetterSetter(N,"fillPatternScaleY",1,(0,x.getNumberValidator)()),z.Factory.addComponentsGetterSetter(N,"fillLinearGradientStartPoint",["x","y"]),z.Factory.addComponentsGetterSetter(N,"strokeLinearGradientStartPoint",["x","y"]),z.Factory.addGetterSetter(N,"fillLinearGradientStartPointX",0),z.Factory.addGetterSetter(N,"strokeLinearGradientStartPointX",0),z.Factory.addGetterSetter(N,"fillLinearGradientStartPointY",0),z.Factory.addGetterSetter(N,"strokeLinearGradientStartPointY",0),z.Factory.addComponentsGetterSetter(N,"fillLinearGradientEndPoint",["x","y"]),z.Factory.addComponentsGetterSetter(N,"strokeLinearGradientEndPoint",["x","y"]),z.Factory.addGetterSetter(N,"fillLinearGradientEndPointX",0),z.Factory.addGetterSetter(N,"strokeLinearGradientEndPointX",0),z.Factory.addGetterSetter(N,"fillLinearGradientEndPointY",0),z.Factory.addGetterSetter(N,"strokeLinearGradientEndPointY",0),z.Factory.addComponentsGetterSetter(N,"fillRadialGradientStartPoint",["x","y"]),z.Factory.addGetterSetter(N,"fillRadialGradientStartPointX",0),z.Factory.addGetterSetter(N,"fillRadialGradientStartPointY",0),z.Factory.addComponentsGetterSetter(N,"fillRadialGradientEndPoint",["x","y"]),z.Factory.addGetterSetter(N,"fillRadialGradientEndPointX",0),z.Factory.addGetterSetter(N,"fillRadialGradientEndPointY",0),z.Factory.addGetterSetter(N,"fillPatternRotation",0),z.Factory.addGetterSetter(N,"fillRule",void 0,(0,x.getStringValidator)()),z.Factory.backCompat(N,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(ca)),ca}var al;function ol(){if(al)return Lr;al=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.Layer=void 0;const s=nt(),d=Vi(),L=it(),z=Ae(),R=Wi(),x=ze(),a=mt(),c=Re(),g="#",y="beforeDraw",v="draw",k=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],w=k.length;class m extends d.Container{constructor(S){super(S),this.canvas=new R.SceneCanvas,this.hitCanvas=new R.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(S){return this.getContext().clear(S),this.getHitCanvas().getContext().clear(S),this}setZIndex(S){super.setZIndex(S);const P=this.getStage();return P&&P.content&&(P.content.removeChild(this.getNativeCanvasElement()),S<P.children.length-1?P.content.insertBefore(this.getNativeCanvasElement(),P.children[S+1].getCanvas()._canvas):P.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){L.Node.prototype.moveToTop.call(this);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!L.Node.prototype.moveUp.call(this))return!1;const P=this.getStage();return!P||!P.content?!1:(P.content.removeChild(this.getNativeCanvasElement()),this.index<P.children.length-1?P.content.insertBefore(this.getNativeCanvasElement(),P.children[this.index+1].getCanvas()._canvas):P.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(L.Node.prototype.moveDown.call(this)){const S=this.getStage();if(S){const P=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),P[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(L.Node.prototype.moveToBottom.call(this)){const S=this.getStage();if(S){const P=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),P[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const S=this.getNativeCanvasElement();return L.Node.prototype.remove.call(this),S&&S.parentNode&&s.Util._isInDocument(S)&&S.parentNode.removeChild(S),this}getStage(){return this.parent}setSize({width:S,height:P}){return this.canvas.setSize(S,P),this.hitCanvas.setSize(S,P),this._setSmoothEnabled(),this}_validateAdd(S){const P=S.getType();P!=="Group"&&P!=="Shape"&&s.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(S){return S=S||{},S.width=S.width||this.getWidth(),S.height=S.height||this.getHeight(),S.x=S.x!==void 0?S.x:this.x(),S.y=S.y!==void 0?S.y:this.y(),L.Node.prototype._toKonvaCanvas.call(this,S)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){s.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){s.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,s.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(S){if(!this.isListening()||!this.isVisible())return null;let P=1,D=!1;for(;;){for(let u=0;u<w;u++){const o=k[u],b=this._getIntersection({x:S.x+o.x*P,y:S.y+o.y*P}),I=b.shape;if(I)return I;if(D=!!b.antialiased,!b.antialiased)break}if(D)P+=1;else return null}}_getIntersection(S){const P=this.hitCanvas.pixelRatio,D=this.hitCanvas.context.getImageData(Math.round(S.x*P),Math.round(S.y*P),1,1).data,u=D[3];if(u===255){const o=s.Util._rgbToHex(D[0],D[1],D[2]),b=a.shapes[g+o];return b?{shape:b}:{antialiased:!0}}else if(u>0)return{antialiased:!0};return{}}drawScene(S,P){const D=this.getLayer(),u=S||D&&D.getCanvas();return this._fire(y,{node:this}),this.clearBeforeDraw()&&u.getContext().clear(),d.Container.prototype.drawScene.call(this,u,P),this._fire(v,{node:this}),this}drawHit(S,P){const D=this.getLayer(),u=S||D&&D.hitCanvas;return D&&D.clearBeforeDraw()&&D.getHitCanvas().getContext().clear(),d.Container.prototype.drawHit.call(this,u,P),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(S){s.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(S)}getHitGraphEnabled(S){return s.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const S=this.parent;!!this.hitCanvas._canvas.parentNode?S.content.removeChild(this.hitCanvas._canvas):S.content.appendChild(this.hitCanvas._canvas)}destroy(){return s.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return Lr.Layer=m,m.prototype.nodeType="Layer",(0,c._registerNode)(m),z.Factory.addGetterSetter(m,"imageSmoothingEnabled",!0),z.Factory.addGetterSetter(m,"clearBeforeDraw",!0),z.Factory.addGetterSetter(m,"hitGraphEnabled",!0,(0,x.getBooleanValidator)()),Lr}var zr={},ll;function mc(){if(ll)return zr;ll=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.FastLayer=void 0;const s=nt(),d=ol(),L=Re();let z=class extends d.Layer{constructor(x){super(x),this.listening(!1),s.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return zr.FastLayer=z,z.prototype.nodeType="FastLayer",(0,L._registerNode)(z),zr}var Dr={},dl;function ha(){if(dl)return Dr;dl=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.Group=void 0;const s=nt(),d=Vi(),L=Re();class z extends d.Container{_validateAdd(x){const a=x.getType();a!=="Group"&&a!=="Shape"&&s.Util.throw("You may only add groups and shapes to groups.")}}return Dr.Group=z,z.prototype.nodeType="Group",(0,L._registerNode)(z),Dr}var Or={},ul;function fa(){if(ul)return Or;ul=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.Animation=void 0;const s=Re(),d=nt(),L=function(){return s.glob.performance&&s.glob.performance.now?function(){return s.glob.performance.now()}:function(){return new Date().getTime()}}();let z=class Fr{constructor(x,a){this.id=Fr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:L(),frameRate:0},this.func=x,this.setLayers(a)}setLayers(x){let a=[];return x&&(a=Array.isArray(x)?x:[x]),this.layers=a,this}getLayers(){return this.layers}addLayer(x){const a=this.layers,c=a.length;for(let g=0;g<c;g++)if(a[g]._id===x._id)return!1;return this.layers.push(x),!0}isRunning(){const a=Fr.animations,c=a.length;for(let g=0;g<c;g++)if(a[g].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=L(),Fr._addAnimation(this),this}stop(){return Fr._removeAnimation(this),this}_updateFrameObject(x){this.frame.timeDiff=x-this.frame.lastTime,this.frame.lastTime=x,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(x){this.animations.push(x),this._handleAnimation()}static _removeAnimation(x){const a=x.id,c=this.animations,g=c.length;for(let y=0;y<g;y++)if(c[y].id===a){this.animations.splice(y,1);break}}static _runFrames(){const x={},a=this.animations;for(let c=0;c<a.length;c++){const g=a[c],y=g.layers,v=g.func;g._updateFrameObject(L());const k=y.length;let w;if(v?w=v.call(g,g.frame)!==!1:w=!0,!!w)for(let m=0;m<k;m++){const h=y[m];h._id!==void 0&&(x[h._id]=h)}}for(const c in x)x.hasOwnProperty(c)&&x[c].batchDraw()}static _animationLoop(){const x=Fr;x.animations.length?(x._runFrames(),d.Util.requestAnimFrame(x._animationLoop)):x.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,d.Util.requestAnimFrame(this._animationLoop))}};return Or.Animation=z,z.animations=[],z.animIdCounter=0,z.animRunning=!1,Or}var ga={},cl;function yc(){return cl||(cl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Easings=s.Tween=void 0;const d=nt(),L=fa(),z=it(),R=Re(),x={node:1,duration:1,easing:1,onFinish:1,yoyo:1},a=1,c=2,g=3,y=["fill","stroke","shadowColor"];let v=0;class k{constructor(h,S,P,D,u,o,b){this.prop=h,this.propFunc=S,this.begin=D,this._pos=D,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=b,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=P,this._change=u-this.begin,this.pause()}fire(h){const S=this[h];S&&S()}setTime(h){h>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():h<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=h,this.update())}getTime(){return this._time}setPosition(h){this.prevPos=this._pos,this.propFunc(h),this._pos=h}getPosition(h){return h===void 0&&(h=this._time),this.func(h,this.begin,this._change,this.duration)}play(){this.state=c,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=g,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(h){this.pause(),this._time=h,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const h=this.getTimer()-this._startTime;this.state===c?this.setTime(h):this.state===g&&this.setTime(this.duration-h)}pause(){this.state=a,this.fire("onPause")}getTimer(){return new Date().getTime()}}class w{constructor(h){const S=this,P=h.node,D=P._id,u=h.easing||s.Easings.Linear,o=!!h.yoyo;let b,I;typeof h.duration>"u"?b=.3:h.duration===0?b=.001:b=h.duration,this.node=P,this._id=v++;const M=P.getLayer()||(P instanceof R.Konva.Stage?P.getLayers():null);M||d.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new L.Animation(function(){S.tween.onEnterFrame()},M),this.tween=new k(I,function(U){S._tweenFunc(U)},u,0,1,b*1e3,o),this._addListeners(),w.attrs[D]||(w.attrs[D]={}),w.attrs[D][this._id]||(w.attrs[D][this._id]={}),w.tweens[D]||(w.tweens[D]={});for(I in h)x[I]===void 0&&this._addAttr(I,h[I]);this.reset(),this.onFinish=h.onFinish,this.onReset=h.onReset,this.onUpdate=h.onUpdate}_addAttr(h,S){const P=this.node,D=P._id;let u,o,b,I,M;const U=w.tweens[D][h];U&&delete w.attrs[D][U][h];let N=P.getAttr(h);if(d.Util._isArray(S))if(u=[],o=Math.max(S.length,N.length),h==="points"&&S.length!==N.length&&(S.length>N.length?(I=N,N=d.Util._prepareArrayForTween(N,S,P.closed())):(b=S,S=d.Util._prepareArrayForTween(S,N,P.closed()))),h.indexOf("fill")===0)for(let A=0;A<o;A++)if(A%2===0)u.push(S[A]-N[A]);else{const E=d.Util.colorToRGBA(N[A]);M=d.Util.colorToRGBA(S[A]),N[A]=E,u.push({r:M.r-E.r,g:M.g-E.g,b:M.b-E.b,a:M.a-E.a})}else for(let A=0;A<o;A++)u.push(S[A]-N[A]);else y.indexOf(h)!==-1?(N=d.Util.colorToRGBA(N),M=d.Util.colorToRGBA(S),u={r:M.r-N.r,g:M.g-N.g,b:M.b-N.b,a:M.a-N.a}):u=S-N;w.attrs[D][this._id][h]={start:N,diff:u,end:S,trueEnd:b,trueStart:I},w.tweens[D][h]=this._id}_tweenFunc(h){const S=this.node,P=w.attrs[S._id][this._id];let D,u,o,b,I,M,U,N;for(D in P){if(u=P[D],o=u.start,b=u.diff,N=u.end,d.Util._isArray(o))if(I=[],U=Math.max(o.length,N.length),D.indexOf("fill")===0)for(M=0;M<U;M++)M%2===0?I.push((o[M]||0)+b[M]*h):I.push("rgba("+Math.round(o[M].r+b[M].r*h)+","+Math.round(o[M].g+b[M].g*h)+","+Math.round(o[M].b+b[M].b*h)+","+(o[M].a+b[M].a*h)+")");else for(M=0;M<U;M++)I.push((o[M]||0)+b[M]*h);else y.indexOf(D)!==-1?I="rgba("+Math.round(o.r+b.r*h)+","+Math.round(o.g+b.g*h)+","+Math.round(o.b+b.b*h)+","+(o.a+b.a*h)+")":I=o+b*h;S.setAttr(D,I)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const h=this.node,S=w.attrs[h._id][this._id];S.points&&S.points.trueEnd&&h.setAttr("points",S.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const h=this.node,S=w.attrs[h._id][this._id];S.points&&S.points.trueStart&&h.points(S.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(h){return this.tween.seek(h*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const h=this.node._id,S=this._id,P=w.tweens[h];this.pause();for(const D in P)delete w.tweens[h][D];delete w.attrs[h][S]}}s.Tween=w,w.attrs={},w.tweens={},z.Node.prototype.to=function(m){const h=m.onFinish;m.node=this,m.onFinish=function(){this.destroy(),h&&h()},new w(m).play()},s.Easings={BackEaseIn(m,h,S,P){return S*(m/=P)*m*((1.70158+1)*m-1.70158)+h},BackEaseOut(m,h,S,P){return S*((m=m/P-1)*m*((1.70158+1)*m+1.70158)+1)+h},BackEaseInOut(m,h,S,P){let D=1.70158;return(m/=P/2)<1?S/2*(m*m*(((D*=1.525)+1)*m-D))+h:S/2*((m-=2)*m*(((D*=1.525)+1)*m+D)+2)+h},ElasticEaseIn(m,h,S,P,D,u){let o=0;return m===0?h:(m/=P)===1?h+S:(u||(u=P*.3),!D||D<Math.abs(S)?(D=S,o=u/4):o=u/(2*Math.PI)*Math.asin(S/D),-(D*Math.pow(2,10*(m-=1))*Math.sin((m*P-o)*(2*Math.PI)/u))+h)},ElasticEaseOut(m,h,S,P,D,u){let o=0;return m===0?h:(m/=P)===1?h+S:(u||(u=P*.3),!D||D<Math.abs(S)?(D=S,o=u/4):o=u/(2*Math.PI)*Math.asin(S/D),D*Math.pow(2,-10*m)*Math.sin((m*P-o)*(2*Math.PI)/u)+S+h)},ElasticEaseInOut(m,h,S,P,D,u){let o=0;return m===0?h:(m/=P/2)===2?h+S:(u||(u=P*(.3*1.5)),!D||D<Math.abs(S)?(D=S,o=u/4):o=u/(2*Math.PI)*Math.asin(S/D),m<1?-.5*(D*Math.pow(2,10*(m-=1))*Math.sin((m*P-o)*(2*Math.PI)/u))+h:D*Math.pow(2,-10*(m-=1))*Math.sin((m*P-o)*(2*Math.PI)/u)*.5+S+h)},BounceEaseOut(m,h,S,P){return(m/=P)<1/2.75?S*(7.5625*m*m)+h:m<2/2.75?S*(7.5625*(m-=1.5/2.75)*m+.75)+h:m<2.5/2.75?S*(7.5625*(m-=2.25/2.75)*m+.9375)+h:S*(7.5625*(m-=2.625/2.75)*m+.984375)+h},BounceEaseIn(m,h,S,P){return S-s.Easings.BounceEaseOut(P-m,0,S,P)+h},BounceEaseInOut(m,h,S,P){return m<P/2?s.Easings.BounceEaseIn(m*2,0,S,P)*.5+h:s.Easings.BounceEaseOut(m*2-P,0,S,P)*.5+S*.5+h},EaseIn(m,h,S,P){return S*(m/=P)*m+h},EaseOut(m,h,S,P){return-S*(m/=P)*(m-2)+h},EaseInOut(m,h,S,P){return(m/=P/2)<1?S/2*m*m+h:-S/2*(--m*(m-2)-1)+h},StrongEaseIn(m,h,S,P){return S*(m/=P)*m*m*m*m+h},StrongEaseOut(m,h,S,P){return S*((m=m/P-1)*m*m*m*m+1)+h},StrongEaseInOut(m,h,S,P){return(m/=P/2)<1?S/2*m*m*m*m*m+h:S/2*((m-=2)*m*m*m*m+2)+h},Linear(m,h,S,P){return S*m/P+h}}}(ga)),ga}var hl;function pa(){return hl||(hl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Konva=void 0;const d=Re(),L=nt(),z=it(),R=Vi(),x=pc(),a=ol(),c=mc(),g=ha(),y=da(),v=mt(),k=fa(),w=yc(),m=Jo(),h=Wi();s.Konva=L.Util._assign(d.Konva,{Util:L.Util,Transform:L.Transform,Node:z.Node,Container:R.Container,Stage:x.Stage,stages:x.stages,Layer:a.Layer,FastLayer:c.FastLayer,Group:g.Group,DD:y.DD,Shape:v.Shape,shapes:v.shapes,Animation:k.Animation,Tween:w.Tween,Easings:w.Easings,Context:m.Context,Canvas:h.Canvas}),s.default=s.Konva}(ia)),ia}var Gr={},fl;function vc(){if(fl)return Gr;fl=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.Arc=void 0;const s=Ae(),d=mt(),L=Re(),z=ze(),R=Re();let x=class extends d.Shape{_sceneFunc(c){const g=L.Konva.getAngle(this.angle()),y=this.clockwise();c.beginPath(),c.arc(0,0,this.outerRadius(),0,g,y),c.arc(0,0,this.innerRadius(),g,0,!y),c.closePath(),c.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(c){this.outerRadius(c/2)}setHeight(c){this.outerRadius(c/2)}getSelfRect(){const c=this.innerRadius(),g=this.outerRadius(),y=this.clockwise(),v=L.Konva.getAngle(y?360-this.angle():this.angle()),k=Math.cos(Math.min(v,Math.PI)),w=1,m=Math.sin(Math.min(Math.max(Math.PI,v),3*Math.PI/2)),h=Math.sin(Math.min(v,Math.PI/2)),S=k*(k>0?c:g),P=w*g,D=m*(m>0?c:g),u=h*(h>0?g:c);return{x:S,y:y?-1*u:D,width:P-S,height:u-D}}};return Gr.Arc=x,x.prototype._centroid=!0,x.prototype.className="Arc",x.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,R._registerNode)(x),s.Factory.addGetterSetter(x,"innerRadius",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(x,"outerRadius",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(x,"angle",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(x,"clockwise",!1,(0,z.getBooleanValidator)()),Gr}var Br={},Ur={},gl;function pl(){if(gl)return Ur;gl=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Line=void 0;const s=Ae(),d=Re(),L=mt(),z=ze();function R(c,g,y,v,k,w,m){const h=Math.sqrt(Math.pow(y-c,2)+Math.pow(v-g,2)),S=Math.sqrt(Math.pow(k-y,2)+Math.pow(w-v,2)),P=m*h/(h+S),D=m*S/(h+S),u=y-P*(k-c),o=v-P*(w-g),b=y+D*(k-c),I=v+D*(w-g);return[u,o,b,I]}function x(c,g){const y=c.length,v=[];for(let k=2;k<y-2;k+=2){const w=R(c[k-2],c[k-1],c[k],c[k+1],c[k+2],c[k+3],g);isNaN(w[0])||(v.push(w[0]),v.push(w[1]),v.push(c[k]),v.push(c[k+1]),v.push(w[2]),v.push(w[3]))}return v}let a=class extends L.Shape{constructor(g){super(g),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(g){let y=this.points(),v=y.length,k=this.tension(),w=this.closed(),m=this.bezier(),h,S,P;if(v){if(g.beginPath(),g.moveTo(y[0],y[1]),k!==0&&v>4){for(h=this.getTensionPoints(),S=h.length,P=w?0:4,w||g.quadraticCurveTo(h[0],h[1],h[2],h[3]);P<S-2;)g.bezierCurveTo(h[P++],h[P++],h[P++],h[P++],h[P++],h[P++]);w||g.quadraticCurveTo(h[S-2],h[S-1],y[v-2],y[v-1])}else if(m)for(P=2;P<v;)g.bezierCurveTo(y[P++],y[P++],y[P++],y[P++],y[P++],y[P++]);else for(P=2;P<v;P+=2)g.lineTo(y[P],y[P+1]);w?(g.closePath(),g.fillStrokeShape(this)):g.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():x(this.points(),this.tension())}_getTensionPointsClosed(){const g=this.points(),y=g.length,v=this.tension(),k=R(g[y-2],g[y-1],g[0],g[1],g[2],g[3],v),w=R(g[y-4],g[y-3],g[y-2],g[y-1],g[0],g[1],v),m=x(g,v);return[k[2],k[3]].concat(m).concat([w[0],w[1],g[y-2],g[y-1],w[2],w[3],k[0],k[1],g[0],g[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let g=this.points();if(g.length<4)return{x:g[0]||0,y:g[1]||0,width:0,height:0};this.tension()!==0?g=[g[0],g[1],...this._getTensionPoints(),g[g.length-2],g[g.length-1]]:g=this.points();let y=g[0],v=g[0],k=g[1],w=g[1],m,h;for(let S=0;S<g.length/2;S++)m=g[S*2],h=g[S*2+1],y=Math.min(y,m),v=Math.max(v,m),k=Math.min(k,h),w=Math.max(w,h);return{x:y,y:k,width:v-y,height:w-k}}};return Ur.Line=a,a.prototype.className="Line",a.prototype._attrsAffectingSize=["points","bezier","tension"],(0,d._registerNode)(a),s.Factory.addGetterSetter(a,"closed",!1),s.Factory.addGetterSetter(a,"bezier",!1),s.Factory.addGetterSetter(a,"tension",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(a,"points",[],(0,z.getNumberArrayValidator)()),Ur}var jr={},ma={},ml;function xc(){return ml||(ml=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.t2length=s.getQuadraticArcLength=s.getCubicArcLength=s.binomialCoefficients=s.cValues=s.tValues=void 0,s.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],s.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],s.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const d=(a,c,g)=>{let y,v;const w=g/2;y=0;for(let m=0;m<20;m++)v=w*s.tValues[20][m]+w,y+=s.cValues[20][m]*z(a,c,v);return w*y};s.getCubicArcLength=d;const L=(a,c,g)=>{g===void 0&&(g=1);const y=a[0]-2*a[1]+a[2],v=c[0]-2*c[1]+c[2],k=2*a[1]-2*a[0],w=2*c[1]-2*c[0],m=4*(y*y+v*v),h=4*(y*k+v*w),S=k*k+w*w;if(m===0)return g*Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(c[2]-c[0],2));const P=h/(2*m),D=S/m,u=g+P,o=D-P*P,b=u*u+o>0?Math.sqrt(u*u+o):0,I=P*P+o>0?Math.sqrt(P*P+o):0,M=P+Math.sqrt(P*P+o)!==0?o*Math.log(Math.abs((u+b)/(P+I))):0;return Math.sqrt(m)/2*(u*b-P*I+M)};s.getQuadraticArcLength=L;function z(a,c,g){const y=R(1,g,a),v=R(1,g,c),k=y*y+v*v;return Math.sqrt(k)}const R=(a,c,g)=>{const y=g.length-1;let v,k;if(y===0)return 0;if(a===0){k=0;for(let w=0;w<=y;w++)k+=s.binomialCoefficients[y][w]*Math.pow(1-c,y-w)*Math.pow(c,w)*g[w];return k}else{v=new Array(y);for(let w=0;w<y;w++)v[w]=y*(g[w+1]-g[w]);return R(a-1,c,v)}},x=(a,c,g)=>{let y=1,v=a/c,k=(a-g(v))/c,w=0;for(;y>.001;){const m=g(v+k),h=Math.abs(a-m)/c;if(h<y)y=h,v+=k;else{const S=g(v-k),P=Math.abs(a-S)/c;P<y?(y=P,v-=k):k/=2}if(w++,w>500)break}return v};s.t2length=x}(ma)),ma}var yl;function ya(){if(yl)return jr;yl=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.Path=void 0;const s=Ae(),d=mt(),L=Re(),z=xc();let R=class Ht extends d.Shape{constructor(a){super(a),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ht.parsePathData(this.data()),this.pathLength=Ht.getPathLength(this.dataArray)}_sceneFunc(a){const c=this.dataArray;a.beginPath();let g=!1;for(let b=0;b<c.length;b++){const I=c[b].command,M=c[b].points;switch(I){case"L":a.lineTo(M[0],M[1]);break;case"M":a.moveTo(M[0],M[1]);break;case"C":a.bezierCurveTo(M[0],M[1],M[2],M[3],M[4],M[5]);break;case"Q":a.quadraticCurveTo(M[0],M[1],M[2],M[3]);break;case"A":var y=M[0],v=M[1],k=M[2],w=M[3],m=M[4],h=M[5],S=M[6],P=M[7],D=k>w?k:w,u=k>w?1:k/w,o=k>w?w/k:1;a.translate(y,v),a.rotate(S),a.scale(u,o),a.arc(0,0,D,m,m+h,1-P),a.scale(1/u,1/o),a.rotate(-S),a.translate(-y,-v);break;case"z":g=!0,a.closePath();break}}!g&&!this.hasFill()?a.strokeShape(this):a.fillStrokeShape(this)}getSelfRect(){let a=[];this.dataArray.forEach(function(m){if(m.command==="A"){const h=m.points[4],S=m.points[5],P=m.points[4]+S;let D=Math.PI/180;if(Math.abs(h-P)<D&&(D=Math.abs(h-P)),S<0)for(let u=h-D;u>P;u-=D){const o=Ht.getPointOnEllipticalArc(m.points[0],m.points[1],m.points[2],m.points[3],u,0);a.push(o.x,o.y)}else for(let u=h+D;u<P;u+=D){const o=Ht.getPointOnEllipticalArc(m.points[0],m.points[1],m.points[2],m.points[3],u,0);a.push(o.x,o.y)}}else if(m.command==="C")for(let h=0;h<=1;h+=.01){const S=Ht.getPointOnCubicBezier(h,m.start.x,m.start.y,m.points[0],m.points[1],m.points[2],m.points[3],m.points[4],m.points[5]);a.push(S.x,S.y)}else a=a.concat(m.points)});let c=a[0],g=a[0],y=a[1],v=a[1],k,w;for(let m=0;m<a.length/2;m++)k=a[m*2],w=a[m*2+1],isNaN(k)||(c=Math.min(c,k),g=Math.max(g,k)),isNaN(w)||(y=Math.min(y,w),v=Math.max(v,w));return{x:c,y,width:g-c,height:v-y}}getLength(){return this.pathLength}getPointAtLength(a){return Ht.getPointAtLengthOfDataArray(a,this.dataArray)}static getLineLength(a,c,g,y){return Math.sqrt((g-a)*(g-a)+(y-c)*(y-c))}static getPathLength(a){let c=0;for(let g=0;g<a.length;++g)c+=a[g].pathLength;return c}static getPointAtLengthOfDataArray(a,c){let g,y=0,v=c.length;if(!v)return null;for(;y<v&&a>c[y].pathLength;)a-=c[y].pathLength,++y;if(y===v)return g=c[y-1].points.slice(-2),{x:g[0],y:g[1]};if(a<.01)return g=c[y].points.slice(0,2),{x:g[0],y:g[1]};const k=c[y],w=k.points;switch(k.command){case"L":return Ht.getPointOnLine(a,k.start.x,k.start.y,w[0],w[1]);case"C":return Ht.getPointOnCubicBezier((0,z.t2length)(a,Ht.getPathLength(c),b=>(0,z.getCubicArcLength)([k.start.x,w[0],w[2],w[4]],[k.start.y,w[1],w[3],w[5]],b)),k.start.x,k.start.y,w[0],w[1],w[2],w[3],w[4],w[5]);case"Q":return Ht.getPointOnQuadraticBezier((0,z.t2length)(a,Ht.getPathLength(c),b=>(0,z.getQuadraticArcLength)([k.start.x,w[0],w[2]],[k.start.y,w[1],w[3]],b)),k.start.x,k.start.y,w[0],w[1],w[2],w[3]);case"A":var m=w[0],h=w[1],S=w[2],P=w[3],D=w[4],u=w[5],o=w[6];return D+=u*a/k.pathLength,Ht.getPointOnEllipticalArc(m,h,S,P,D,o)}return null}static getPointOnLine(a,c,g,y,v,k,w){k=k??c,w=w??g;const m=this.getLineLength(c,g,y,v);if(m<1e-10)return{x:c,y:g};if(y===c)return{x:k,y:w+(v>g?a:-a)};const h=(v-g)/(y-c),S=Math.sqrt(a*a/(1+h*h))*(y<c?-1:1),P=h*S;if(Math.abs(w-g-h*(k-c))<1e-10)return{x:k+S,y:w+P};const D=((k-c)*(y-c)+(w-g)*(v-g))/(m*m),u=c+D*(y-c),o=g+D*(v-g),b=this.getLineLength(k,w,u,o),I=Math.sqrt(a*a-b*b),M=Math.sqrt(I*I/(1+h*h))*(y<c?-1:1),U=h*M;return{x:u+M,y:o+U}}static getPointOnCubicBezier(a,c,g,y,v,k,w,m,h){function S(I){return I*I*I}function P(I){return 3*I*I*(1-I)}function D(I){return 3*I*(1-I)*(1-I)}function u(I){return(1-I)*(1-I)*(1-I)}const o=m*S(a)+k*P(a)+y*D(a)+c*u(a),b=h*S(a)+w*P(a)+v*D(a)+g*u(a);return{x:o,y:b}}static getPointOnQuadraticBezier(a,c,g,y,v,k,w){function m(u){return u*u}function h(u){return 2*u*(1-u)}function S(u){return(1-u)*(1-u)}const P=k*m(a)+y*h(a)+c*S(a),D=w*m(a)+v*h(a)+g*S(a);return{x:P,y:D}}static getPointOnEllipticalArc(a,c,g,y,v,k){const w=Math.cos(k),m=Math.sin(k),h={x:g*Math.cos(v),y:y*Math.sin(v)};return{x:a+(h.x*w-h.y*m),y:c+(h.x*m+h.y*w)}}static parsePathData(a){if(!a)return[];let c=a;const g=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];c=c.replace(new RegExp(" ","g"),",");for(var y=0;y<g.length;y++)c=c.replace(new RegExp(g[y],"g"),"|"+g[y]);const v=c.split("|"),k=[],w=[];let m=0,h=0;const S=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let P;for(y=1;y<v.length;y++){let l=v[y],_=l.charAt(0);for(l=l.slice(1),w.length=0;P=S.exec(l);)w.push(P[0]);const C=[];for(let O=0,W=w.length;O<W;O++){if(w[O]==="00"){C.push(0,0);continue}const T=parseFloat(w[O]);isNaN(T)?C.push(0):C.push(T)}for(;C.length>0&&!isNaN(C[0]);){let O="",W=[];const T=m,X=h;var D,u,o,b,I,M,U,N,A,E;switch(_){case"l":m+=C.shift(),h+=C.shift(),O="L",W.push(m,h);break;case"L":m=C.shift(),h=C.shift(),W.push(m,h);break;case"m":var B=C.shift(),q=C.shift();if(m+=B,h+=q,O="M",k.length>2&&k[k.length-1].command==="z"){for(let Q=k.length-2;Q>=0;Q--)if(k[Q].command==="M"){m=k[Q].points[0]+B,h=k[Q].points[1]+q;break}}W.push(m,h),_="l";break;case"M":m=C.shift(),h=C.shift(),O="M",W.push(m,h),_="L";break;case"h":m+=C.shift(),O="L",W.push(m,h);break;case"H":m=C.shift(),O="L",W.push(m,h);break;case"v":h+=C.shift(),O="L",W.push(m,h);break;case"V":h=C.shift(),O="L",W.push(m,h);break;case"C":W.push(C.shift(),C.shift(),C.shift(),C.shift()),m=C.shift(),h=C.shift(),W.push(m,h);break;case"c":W.push(m+C.shift(),h+C.shift(),m+C.shift(),h+C.shift()),m+=C.shift(),h+=C.shift(),O="C",W.push(m,h);break;case"S":u=m,o=h,D=k[k.length-1],D.command==="C"&&(u=m+(m-D.points[2]),o=h+(h-D.points[3])),W.push(u,o,C.shift(),C.shift()),m=C.shift(),h=C.shift(),O="C",W.push(m,h);break;case"s":u=m,o=h,D=k[k.length-1],D.command==="C"&&(u=m+(m-D.points[2]),o=h+(h-D.points[3])),W.push(u,o,m+C.shift(),h+C.shift()),m+=C.shift(),h+=C.shift(),O="C",W.push(m,h);break;case"Q":W.push(C.shift(),C.shift()),m=C.shift(),h=C.shift(),W.push(m,h);break;case"q":W.push(m+C.shift(),h+C.shift()),m+=C.shift(),h+=C.shift(),O="Q",W.push(m,h);break;case"T":u=m,o=h,D=k[k.length-1],D.command==="Q"&&(u=m+(m-D.points[0]),o=h+(h-D.points[1])),m=C.shift(),h=C.shift(),O="Q",W.push(u,o,m,h);break;case"t":u=m,o=h,D=k[k.length-1],D.command==="Q"&&(u=m+(m-D.points[0]),o=h+(h-D.points[1])),m+=C.shift(),h+=C.shift(),O="Q",W.push(u,o,m,h);break;case"A":b=C.shift(),I=C.shift(),M=C.shift(),U=C.shift(),N=C.shift(),A=m,E=h,m=C.shift(),h=C.shift(),O="A",W=this.convertEndpointToCenterParameterization(A,E,m,h,U,N,b,I,M);break;case"a":b=C.shift(),I=C.shift(),M=C.shift(),U=C.shift(),N=C.shift(),A=m,E=h,m+=C.shift(),h+=C.shift(),O="A",W=this.convertEndpointToCenterParameterization(A,E,m,h,U,N,b,I,M);break}k.push({command:O||_,points:W,start:{x:T,y:X},pathLength:this.calcLength(T,X,O||_,W)})}(_==="z"||_==="Z")&&k.push({command:"z",points:[],start:void 0,pathLength:0})}return k}static calcLength(a,c,g,y){let v,k,w,m;const h=Ht;switch(g){case"L":return h.getLineLength(a,c,y[0],y[1]);case"C":return(0,z.getCubicArcLength)([a,y[0],y[2],y[4]],[c,y[1],y[3],y[5]],1);case"Q":return(0,z.getQuadraticArcLength)([a,y[0],y[2]],[c,y[1],y[3]],1);case"A":v=0;var S=y[4],P=y[5],D=y[4]+P,u=Math.PI/180;if(Math.abs(S-D)<u&&(u=Math.abs(S-D)),k=h.getPointOnEllipticalArc(y[0],y[1],y[2],y[3],S,0),P<0)for(m=S-u;m>D;m-=u)w=h.getPointOnEllipticalArc(y[0],y[1],y[2],y[3],m,0),v+=h.getLineLength(k.x,k.y,w.x,w.y),k=w;else for(m=S+u;m<D;m+=u)w=h.getPointOnEllipticalArc(y[0],y[1],y[2],y[3],m,0),v+=h.getLineLength(k.x,k.y,w.x,w.y),k=w;return w=h.getPointOnEllipticalArc(y[0],y[1],y[2],y[3],D,0),v+=h.getLineLength(k.x,k.y,w.x,w.y),v}return 0}static convertEndpointToCenterParameterization(a,c,g,y,v,k,w,m,h){const S=h*(Math.PI/180),P=Math.cos(S)*(a-g)/2+Math.sin(S)*(c-y)/2,D=-1*Math.sin(S)*(a-g)/2+Math.cos(S)*(c-y)/2,u=P*P/(w*w)+D*D/(m*m);u>1&&(w*=Math.sqrt(u),m*=Math.sqrt(u));let o=Math.sqrt((w*w*(m*m)-w*w*(D*D)-m*m*(P*P))/(w*w*(D*D)+m*m*(P*P)));v===k&&(o*=-1),isNaN(o)&&(o=0);const b=o*w*D/m,I=o*-m*P/w,M=(a+g)/2+Math.cos(S)*b-Math.sin(S)*I,U=(c+y)/2+Math.sin(S)*b+Math.cos(S)*I,N=function(C){return Math.sqrt(C[0]*C[0]+C[1]*C[1])},A=function(C,O){return(C[0]*O[0]+C[1]*O[1])/(N(C)*N(O))},E=function(C,O){return(C[0]*O[1]<C[1]*O[0]?-1:1)*Math.acos(A(C,O))},B=E([1,0],[(P-b)/w,(D-I)/m]),q=[(P-b)/w,(D-I)/m],l=[(-1*P-b)/w,(-1*D-I)/m];let _=E(q,l);return A(q,l)<=-1&&(_=Math.PI),A(q,l)>=1&&(_=0),k===0&&_>0&&(_=_-2*Math.PI),k===1&&_<0&&(_=_+2*Math.PI),[M,U,w,m,B,_,S,k]}};return jr.Path=R,R.prototype.className="Path",R.prototype._attrsAffectingSize=["data"],(0,L._registerNode)(R),s.Factory.addGetterSetter(R,"data"),jr}var vl;function _c(){if(vl)return Br;vl=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.Arrow=void 0;const s=Ae(),d=pl(),L=ze(),z=Re(),R=ya();let x=class extends d.Line{_sceneFunc(c){super._sceneFunc(c);const g=Math.PI*2,y=this.points();let v=y;const k=this.tension()!==0&&y.length>4;k&&(v=this.getTensionPoints());const w=this.pointerLength(),m=y.length;let h,S;if(k){const u=[v[v.length-4],v[v.length-3],v[v.length-2],v[v.length-1],y[m-2],y[m-1]],o=R.Path.calcLength(v[v.length-4],v[v.length-3],"C",u),b=R.Path.getPointOnQuadraticBezier(Math.min(1,1-w/o),u[0],u[1],u[2],u[3],u[4],u[5]);h=y[m-2]-b.x,S=y[m-1]-b.y}else h=y[m-2]-y[m-4],S=y[m-1]-y[m-3];const P=(Math.atan2(S,h)+g)%g,D=this.pointerWidth();this.pointerAtEnding()&&(c.save(),c.beginPath(),c.translate(y[m-2],y[m-1]),c.rotate(P),c.moveTo(0,0),c.lineTo(-w,D/2),c.lineTo(-w,-D/2),c.closePath(),c.restore(),this.__fillStroke(c)),this.pointerAtBeginning()&&(c.save(),c.beginPath(),c.translate(y[0],y[1]),k?(h=(v[0]+v[2])/2-y[0],S=(v[1]+v[3])/2-y[1]):(h=y[2]-y[0],S=y[3]-y[1]),c.rotate((Math.atan2(-S,-h)+g)%g),c.moveTo(0,0),c.lineTo(-w,D/2),c.lineTo(-w,-D/2),c.closePath(),c.restore(),this.__fillStroke(c))}__fillStroke(c){const g=this.dashEnabled();g&&(this.attrs.dashEnabled=!1,c.setLineDash([])),c.fillStrokeShape(this),g&&(this.attrs.dashEnabled=!0)}getSelfRect(){const c=super.getSelfRect(),g=this.pointerWidth()/2;return{x:c.x,y:c.y-g,width:c.width,height:c.height+g*2}}};return Br.Arrow=x,x.prototype.className="Arrow",(0,z._registerNode)(x),s.Factory.addGetterSetter(x,"pointerLength",10,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(x,"pointerWidth",10,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(x,"pointerAtBeginning",!1),s.Factory.addGetterSetter(x,"pointerAtEnding",!0),Br}var Hr={},xl;function wc(){if(xl)return Hr;xl=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.Circle=void 0;const s=Ae(),d=mt(),L=ze(),z=Re();let R=class extends d.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius()!==a/2&&this.radius(a/2)}setHeight(a){this.radius()!==a/2&&this.radius(a/2)}};return Hr.Circle=R,R.prototype._centroid=!0,R.prototype.className="Circle",R.prototype._attrsAffectingSize=["radius"],(0,z._registerNode)(R),s.Factory.addGetterSetter(R,"radius",0,(0,L.getNumberValidator)()),Hr}var Wr={},_l;function Sc(){if(_l)return Wr;_l=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.Ellipse=void 0;const s=Ae(),d=mt(),L=ze(),z=Re();let R=class extends d.Shape{_sceneFunc(a){const c=this.radiusX(),g=this.radiusY();a.beginPath(),a.save(),c!==g&&a.scale(1,g/c),a.arc(0,0,c,0,Math.PI*2,!1),a.restore(),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(a){this.radiusX(a/2)}setHeight(a){this.radiusY(a/2)}};return Wr.Ellipse=R,R.prototype.className="Ellipse",R.prototype._centroid=!0,R.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,z._registerNode)(R),s.Factory.addComponentsGetterSetter(R,"radius",["x","y"]),s.Factory.addGetterSetter(R,"radiusX",0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(R,"radiusY",0,(0,L.getNumberValidator)()),Wr}var Vr={},wl;function Cc(){if(wl)return Vr;wl=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.Image=void 0;const s=nt(),d=Ae(),L=mt(),z=Re(),R=ze();class x extends L.Shape{constructor(c){super(c),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",g=>{this._removeImageLoad(g.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const c=this.image();c&&c.complete||c&&c.readyState===4||c&&c.addEventListener&&c.addEventListener("load",this._loadListener)}_removeImageLoad(c){c&&c.removeEventListener&&c.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const c=!!this.cornerRadius(),g=this.hasShadow();return c&&g?!0:super._useBufferCanvas(!0)}_sceneFunc(c){const g=this.getWidth(),y=this.getHeight(),v=this.cornerRadius(),k=this.attrs.image;let w;if(k){const m=this.attrs.cropWidth,h=this.attrs.cropHeight;m&&h?w=[k,this.cropX(),this.cropY(),m,h,0,0,g,y]:w=[k,0,0,g,y]}(this.hasFill()||this.hasStroke()||v)&&(c.beginPath(),v?s.Util.drawRoundedRectPath(c,g,y,v):c.rect(0,0,g,y),c.closePath(),c.fillStrokeShape(this)),k&&(v&&c.clip(),c.drawImage.apply(c,w))}_hitFunc(c){const g=this.width(),y=this.height(),v=this.cornerRadius();c.beginPath(),v?s.Util.drawRoundedRectPath(c,g,y,v):c.rect(0,0,g,y),c.closePath(),c.fillStrokeShape(this)}getWidth(){var c,g;return(c=this.attrs.width)!==null&&c!==void 0?c:(g=this.image())===null||g===void 0?void 0:g.width}getHeight(){var c,g;return(c=this.attrs.height)!==null&&c!==void 0?c:(g=this.image())===null||g===void 0?void 0:g.height}static fromURL(c,g,y=null){const v=s.Util.createImageElement();v.onload=function(){const k=new x({image:v});g(k)},v.onerror=y,v.crossOrigin="Anonymous",v.src=c}}return Vr.Image=x,x.prototype.className="Image",(0,z._registerNode)(x),d.Factory.addGetterSetter(x,"cornerRadius",0,(0,R.getNumberOrArrayOfNumbersValidator)(4)),d.Factory.addGetterSetter(x,"image"),d.Factory.addComponentsGetterSetter(x,"crop",["x","y","width","height"]),d.Factory.addGetterSetter(x,"cropX",0,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(x,"cropY",0,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(x,"cropWidth",0,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(x,"cropHeight",0,(0,R.getNumberValidator)()),Vr}var Xn={},Sl;function bc(){if(Sl)return Xn;Sl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Tag=Xn.Label=void 0;const s=Ae(),d=mt(),L=ha(),z=ze(),R=Re(),x=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],a="Change.konva",c="none",g="up",y="right",v="down",k="left",w=x.length;let m=class extends L.Group{constructor(P){super(P),this.on("add.konva",function(D){this._addListeners(D.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(P){let D=this,u;const o=function(){D._sync()};for(u=0;u<w;u++)P.on(x[u]+a,o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let P=this.getText(),D=this.getTag(),u,o,b,I,M,U,N;if(P&&D){switch(u=P.width(),o=P.height(),b=D.pointerDirection(),I=D.pointerWidth(),N=D.pointerHeight(),M=0,U=0,b){case g:M=u/2,U=-1*N;break;case y:M=u+I,U=o/2;break;case v:M=u/2,U=o+N;break;case k:M=-1*I,U=o/2;break}D.setAttrs({x:-1*M,y:-1*U,width:u,height:o}),P.setAttrs({x:-1*M,y:-1*U})}}};Xn.Label=m,m.prototype.className="Label",(0,R._registerNode)(m);class h extends d.Shape{_sceneFunc(P){const D=this.width(),u=this.height(),o=this.pointerDirection(),b=this.pointerWidth(),I=this.pointerHeight(),M=this.cornerRadius();let U=0,N=0,A=0,E=0;typeof M=="number"?U=N=A=E=Math.min(M,D/2,u/2):(U=Math.min(M[0]||0,D/2,u/2),N=Math.min(M[1]||0,D/2,u/2),E=Math.min(M[2]||0,D/2,u/2),A=Math.min(M[3]||0,D/2,u/2)),P.beginPath(),P.moveTo(U,0),o===g&&(P.lineTo((D-b)/2,0),P.lineTo(D/2,-1*I),P.lineTo((D+b)/2,0)),P.lineTo(D-N,0),P.arc(D-N,N,N,Math.PI*3/2,0,!1),o===y&&(P.lineTo(D,(u-I)/2),P.lineTo(D+b,u/2),P.lineTo(D,(u+I)/2)),P.lineTo(D,u-E),P.arc(D-E,u-E,E,0,Math.PI/2,!1),o===v&&(P.lineTo((D+b)/2,u),P.lineTo(D/2,u+I),P.lineTo((D-b)/2,u)),P.lineTo(A,u),P.arc(A,u-A,A,Math.PI/2,Math.PI,!1),o===k&&(P.lineTo(0,(u+I)/2),P.lineTo(-1*b,u/2),P.lineTo(0,(u-I)/2)),P.lineTo(0,U),P.arc(U,U,U,Math.PI,Math.PI*3/2,!1),P.closePath(),P.fillStrokeShape(this)}getSelfRect(){let P=0,D=0,u=this.pointerWidth(),o=this.pointerHeight(),b=this.pointerDirection(),I=this.width(),M=this.height();return b===g?(D-=o,M+=o):b===v?M+=o:b===k?(P-=u*1.5,I+=u):b===y&&(I+=u*1.5),{x:P,y:D,width:I,height:M}}}return Xn.Tag=h,h.prototype.className="Tag",(0,R._registerNode)(h),s.Factory.addGetterSetter(h,"pointerDirection",c),s.Factory.addGetterSetter(h,"pointerWidth",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(h,"pointerHeight",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(h,"cornerRadius",0,(0,z.getNumberOrArrayOfNumbersValidator)(4)),Xn}var qr={},Cl;function bl(){if(Cl)return qr;Cl=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Rect=void 0;const s=Ae(),d=mt(),L=Re(),z=nt(),R=ze();class x extends d.Shape{_sceneFunc(c){const g=this.cornerRadius(),y=this.width(),v=this.height();c.beginPath(),g?z.Util.drawRoundedRectPath(c,y,v,g):c.rect(0,0,y,v),c.closePath(),c.fillStrokeShape(this)}}return qr.Rect=x,x.prototype.className="Rect",(0,L._registerNode)(x),s.Factory.addGetterSetter(x,"cornerRadius",0,(0,R.getNumberOrArrayOfNumbersValidator)(4)),qr}var Yr={},kl;function kc(){if(kl)return Yr;kl=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.RegularPolygon=void 0;const s=Ae(),d=mt(),L=ze(),z=Re();let R=class extends d.Shape{_sceneFunc(a){const c=this._getPoints();a.beginPath(),a.moveTo(c[0].x,c[0].y);for(let g=1;g<c.length;g++)a.lineTo(c[g].x,c[g].y);a.closePath(),a.fillStrokeShape(this)}_getPoints(){const a=this.attrs.sides,c=this.attrs.radius||0,g=[];for(let y=0;y<a;y++)g.push({x:c*Math.sin(y*2*Math.PI/a),y:-1*c*Math.cos(y*2*Math.PI/a)});return g}getSelfRect(){const a=this._getPoints();let c=a[0].x,g=a[0].y,y=a[0].x,v=a[0].y;return a.forEach(k=>{c=Math.min(c,k.x),g=Math.max(g,k.x),y=Math.min(y,k.y),v=Math.max(v,k.y)}),{x:c,y,width:g-c,height:v-y}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Yr.RegularPolygon=R,R.prototype.className="RegularPolygon",R.prototype._centroid=!0,R.prototype._attrsAffectingSize=["radius"],(0,z._registerNode)(R),s.Factory.addGetterSetter(R,"radius",0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(R,"sides",0,(0,L.getNumberValidator)()),Yr}var Kr={},El;function Ec(){if(El)return Kr;El=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.Ring=void 0;const s=Ae(),d=mt(),L=ze(),z=Re(),R=Math.PI*2;let x=class extends d.Shape{_sceneFunc(c){c.beginPath(),c.arc(0,0,this.innerRadius(),0,R,!1),c.moveTo(this.outerRadius(),0),c.arc(0,0,this.outerRadius(),R,0,!0),c.closePath(),c.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(c){this.outerRadius(c/2)}setHeight(c){this.outerRadius(c/2)}};return Kr.Ring=x,x.prototype.className="Ring",x.prototype._centroid=!0,x.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,z._registerNode)(x),s.Factory.addGetterSetter(x,"innerRadius",0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(x,"outerRadius",0,(0,L.getNumberValidator)()),Kr}var Xr={},Pl;function Pc(){if(Pl)return Xr;Pl=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.Sprite=void 0;const s=Ae(),d=mt(),L=fa(),z=ze(),R=Re();let x=class extends d.Shape{constructor(c){super(c),this._updated=!0,this.anim=new L.Animation(()=>{const g=this._updated;return this._updated=!1,g}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(c){const g=this.animation(),y=this.frameIndex(),v=y*4,k=this.animations()[g],w=this.frameOffsets(),m=k[v+0],h=k[v+1],S=k[v+2],P=k[v+3],D=this.image();if((this.hasFill()||this.hasStroke())&&(c.beginPath(),c.rect(0,0,S,P),c.closePath(),c.fillStrokeShape(this)),D)if(w){const u=w[g],o=y*2;c.drawImage(D,m,h,S,P,u[o+0],u[o+1],S,P)}else c.drawImage(D,m,h,S,P,0,0,S,P)}_hitFunc(c){const g=this.animation(),y=this.frameIndex(),v=y*4,k=this.animations()[g],w=this.frameOffsets(),m=k[v+2],h=k[v+3];if(c.beginPath(),w){const S=w[g],P=y*2;c.rect(S[P+0],S[P+1],m,h)}else c.rect(0,0,m,h);c.closePath(),c.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const c=this;this.interval=setInterval(function(){c._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const c=this.getLayer();this.anim.setLayers(c),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const c=this.frameIndex(),g=this.animation(),y=this.animations(),v=y[g],k=v.length/4;c<k-1?this.frameIndex(c+1):this.frameIndex(0)}};return Xr.Sprite=x,x.prototype.className="Sprite",(0,R._registerNode)(x),s.Factory.addGetterSetter(x,"animation"),s.Factory.addGetterSetter(x,"animations"),s.Factory.addGetterSetter(x,"frameOffsets"),s.Factory.addGetterSetter(x,"image"),s.Factory.addGetterSetter(x,"frameIndex",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(x,"frameRate",17,(0,z.getNumberValidator)()),s.Factory.backCompat(x,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Xr}var Qr={},Tl;function Tc(){if(Tl)return Qr;Tl=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.Star=void 0;const s=Ae(),d=mt(),L=ze(),z=Re();let R=class extends d.Shape{_sceneFunc(a){const c=this.innerRadius(),g=this.outerRadius(),y=this.numPoints();a.beginPath(),a.moveTo(0,0-g);for(let v=1;v<y*2;v++){const k=v%2===0?g:c,w=k*Math.sin(v*Math.PI/y),m=-1*k*Math.cos(v*Math.PI/y);a.lineTo(w,m)}a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Qr.Star=R,R.prototype.className="Star",R.prototype._centroid=!0,R.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,z._registerNode)(R),s.Factory.addGetterSetter(R,"numPoints",5,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(R,"innerRadius",0,(0,L.getNumberValidator)()),s.Factory.addGetterSetter(R,"outerRadius",0,(0,L.getNumberValidator)()),Qr}var or={},Rl;function Fl(){if(Rl)return or;Rl=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Text=void 0,or.stringToArray=a;const s=nt(),d=Ae(),L=mt(),z=Re(),R=ze(),x=Re();function a(le){return[...le].reduce((ie,oe,ge,fe)=>{if(new RegExp("\\p{Emoji}","u").test(oe)){const H=fe[ge+1];H&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(H)?(ie.push(oe+H),fe[ge+1]=""):ie.push(oe)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(oe+(fe[ge+1]||""))?ie.push(oe+fe[ge+1]):ge>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(oe)?ie[ie.length-1]+=oe:oe&&ie.push(oe);return ie},[])}const c="auto",g="center",y="inherit",v="justify",k="Change.konva",w="2d",m="-",h="left",S="text",P="Text",D="top",u="bottom",o="middle",b="normal",I="px ",M=" ",U="right",N="rtl",A="word",E="char",B="none",q="…",l=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],_=l.length;function C(le){return le.split(",").map(ie=>{ie=ie.trim();const oe=ie.indexOf(" ")>=0,ge=ie.indexOf('"')>=0||ie.indexOf("'")>=0;return oe&&!ge&&(ie=`"${ie}"`),ie}).join(", ")}let O;function W(){return O||(O=s.Util.createCanvasElement().getContext(w),O)}function T(le){le.fillText(this._partialText,this._partialTextX,this._partialTextY)}function X(le){le.setAttr("miterLimit",2),le.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Q(le){return le=le||{},!le.fillLinearGradientColorStops&&!le.fillRadialGradientColorStops&&!le.fillPatternImage&&(le.fill=le.fill||"black"),le}class ne extends L.Shape{constructor(ie){super(Q(ie)),this._partialTextX=0,this._partialTextY=0;for(let oe=0;oe<_;oe++)this.on(l[oe]+k,this._setTextData);this._setTextData()}_sceneFunc(ie){const oe=this.textArr,ge=oe.length;if(!this.text())return;let fe=this.padding(),H=this.fontSize(),te=this.lineHeight()*H,de=this.verticalAlign(),ae=this.direction(),ce=0,ve=this.align(),Ce=this.getWidth(),Fe=this.letterSpacing(),be=this.fill(),$e=this.textDecoration(),De=$e.indexOf("underline")!==-1,Ue=$e.indexOf("line-through")!==-1,Mt;ae=ae===y?ie.direction:ae;let dt=te/2,Wt=o;if(z.Konva._fixTextRendering){const Ie=this.measureSize("M");Wt="alphabetic",dt=(Ie.fontBoundingBoxAscent-Ie.fontBoundingBoxDescent)/2+te/2}var He=0,ut=0;for(ae===N&&ie.setAttr("direction",ae),ie.setAttr("font",this._getContextFont()),ie.setAttr("textBaseline",Wt),ie.setAttr("textAlign",h),de===o?ce=(this.getHeight()-ge*te-fe*2)/2:de===u&&(ce=this.getHeight()-ge*te-fe*2),ie.translate(fe,ce+fe),Mt=0;Mt<ge;Mt++){var He=0,ut=0,st=oe[Mt],Vt=st.text,ht=st.width,Kt=st.lastInParagraph,Ot,Xt;if(ie.save(),ve===U?He+=Ce-ht-fe*2:ve===g&&(He+=(Ce-ht-fe*2)/2),De){ie.save(),ie.beginPath();const yt=z.Konva._fixTextRendering?Math.round(H/4):Math.round(H/2),Et=He,Pt=dt+ut+yt;ie.moveTo(Et,Pt),Ot=Vt.split(" ").length-1,Xt=ve===v&&!Kt?Ce-fe*2:ht,ie.lineTo(Et+Math.round(Xt),Pt),ie.lineWidth=H/15;const On=this._getLinearGradient();ie.strokeStyle=On||be,ie.stroke(),ie.restore()}if(Ue){ie.save(),ie.beginPath();const yt=z.Konva._fixTextRendering?-Math.round(H/4):0;ie.moveTo(He,dt+ut+yt),Ot=Vt.split(" ").length-1,Xt=ve===v&&!Kt?Ce-fe*2:ht,ie.lineTo(He+Math.round(Xt),dt+ut+yt),ie.lineWidth=H/15;const Et=this._getLinearGradient();ie.strokeStyle=Et||be,ie.stroke(),ie.restore()}if(ae!==N&&(Fe!==0||ve===v)){Ot=Vt.split(" ").length-1;const yt=a(Vt);for(let Et=0;Et<yt.length;Et++){const Pt=yt[Et];Pt===" "&&!Kt&&ve===v&&(He+=(Ce-fe*2-ht)/Ot),this._partialTextX=He,this._partialTextY=dt+ut,this._partialText=Pt,ie.fillStrokeShape(this),He+=this.measureSize(Pt).width+Fe}}else Fe!==0&&ie.setAttr("letterSpacing",`${Fe}px`),this._partialTextX=He,this._partialTextY=dt+ut,this._partialText=Vt,ie.fillStrokeShape(this);ie.restore(),ge>1&&(dt+=te)}}_hitFunc(ie){const oe=this.getWidth(),ge=this.getHeight();ie.beginPath(),ie.rect(0,0,oe,ge),ie.closePath(),ie.fillStrokeShape(this)}setText(ie){const oe=s.Util._isString(ie)?ie:ie==null?"":ie+"";return this._setAttr(S,oe),this}getWidth(){return this.attrs.width===c||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===c||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return s.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(ie){var oe,ge,fe,H,te,de,ae,ce,ve,Ce,Fe;let be=W(),$e=this.fontSize(),De;be.save(),be.font=this._getContextFont(),De=be.measureText(ie),be.restore();const Ue=$e/100;return{actualBoundingBoxAscent:(oe=De.actualBoundingBoxAscent)!==null&&oe!==void 0?oe:71.58203125*Ue,actualBoundingBoxDescent:(ge=De.actualBoundingBoxDescent)!==null&&ge!==void 0?ge:0,actualBoundingBoxLeft:(fe=De.actualBoundingBoxLeft)!==null&&fe!==void 0?fe:-7.421875*Ue,actualBoundingBoxRight:(H=De.actualBoundingBoxRight)!==null&&H!==void 0?H:75.732421875*Ue,alphabeticBaseline:(te=De.alphabeticBaseline)!==null&&te!==void 0?te:0,emHeightAscent:(de=De.emHeightAscent)!==null&&de!==void 0?de:100*Ue,emHeightDescent:(ae=De.emHeightDescent)!==null&&ae!==void 0?ae:-20*Ue,fontBoundingBoxAscent:(ce=De.fontBoundingBoxAscent)!==null&&ce!==void 0?ce:91*Ue,fontBoundingBoxDescent:(ve=De.fontBoundingBoxDescent)!==null&&ve!==void 0?ve:21*Ue,hangingBaseline:(Ce=De.hangingBaseline)!==null&&Ce!==void 0?Ce:72.80000305175781*Ue,ideographicBaseline:(Fe=De.ideographicBaseline)!==null&&Fe!==void 0?Fe:-21*Ue,width:De.width,height:$e}}_getContextFont(){return this.fontStyle()+M+this.fontVariant()+M+(this.fontSize()+I)+C(this.fontFamily())}_addTextLine(ie){this.align()===v&&(ie=ie.trim());const ge=this._getTextWidth(ie);return this.textArr.push({text:ie,width:ge,lastInParagraph:!1})}_getTextWidth(ie){const oe=this.letterSpacing(),ge=ie.length;return W().measureText(ie).width+oe*ge}_setTextData(){let ie=this.text().split(`
`),oe=+this.fontSize(),ge=0,fe=this.lineHeight()*oe,H=this.attrs.width,te=this.attrs.height,de=H!==c&&H!==void 0,ae=te!==c&&te!==void 0,ce=this.padding(),ve=H-ce*2,Ce=te-ce*2,Fe=0,be=this.wrap(),$e=be!==B,De=be!==E&&$e,Ue=this.ellipsis();this.textArr=[],W().font=this._getContextFont();const Mt=Ue?this._getTextWidth(q):0;for(let dt=0,Wt=ie.length;dt<Wt;++dt){let He=ie[dt],ut=this._getTextWidth(He);if(de&&ut>ve)for(;He.length>0;){let st=0,Vt=a(He).length,ht="",Kt=0;for(;st<Vt;){const Ot=st+Vt>>>1,Xt=a(He),Ie=Xt.slice(0,Ot+1).join(""),ke=this._getTextWidth(Ie);(Ue&&ae&&Fe+fe>Ce?ke+Mt:ke)<=ve?(st=Ot+1,ht=Ie,Kt=ke):Vt=Ot}if(ht){if(De){const Ie=a(He),ke=a(ht),yt=Ie[ke.length],Et=yt===M||yt===m;let Pt;if(Et&&Kt<=ve)Pt=ke.length;else{const On=ke.lastIndexOf(M),Si=ke.lastIndexOf(m);Pt=Math.max(On,Si)+1}Pt>0&&(st=Pt,ht=Ie.slice(0,st).join(""),Kt=this._getTextWidth(ht))}if(ht=ht.trimRight(),this._addTextLine(ht),ge=Math.max(ge,Kt),Fe+=fe,this._shouldHandleEllipsis(Fe)){this._tryToAddEllipsisToLastLine();break}if(He=a(He).slice(st).join("").trimLeft(),He.length>0&&(ut=this._getTextWidth(He),ut<=ve)){this._addTextLine(He),Fe+=fe,ge=Math.max(ge,ut);break}}else break}else this._addTextLine(He),Fe+=fe,ge=Math.max(ge,ut),this._shouldHandleEllipsis(Fe)&&dt<Wt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ae&&Fe+fe>Ce)break}this.textHeight=oe,this.textWidth=ge}_shouldHandleEllipsis(ie){const oe=+this.fontSize(),ge=this.lineHeight()*oe,fe=this.attrs.height,H=fe!==c&&fe!==void 0,te=this.padding(),de=fe-te*2;return!(this.wrap()!==B)||H&&ie+ge>de}_tryToAddEllipsisToLastLine(){const ie=this.attrs.width,oe=ie!==c&&ie!==void 0,ge=this.padding(),fe=ie-ge*2,H=this.ellipsis(),te=this.textArr[this.textArr.length-1];!te||!H||(oe&&(this._getTextWidth(te.text+q)<fe||(te.text=te.text.slice(0,te.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(te.text+q))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const ie=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,oe=this.hasShadow();return ie&&oe?!0:super._useBufferCanvas()}}return or.Text=ne,ne.prototype._fillFunc=T,ne.prototype._strokeFunc=X,ne.prototype.className=P,ne.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,x._registerNode)(ne),d.Factory.overWriteSetter(ne,"width",(0,R.getNumberOrAutoValidator)()),d.Factory.overWriteSetter(ne,"height",(0,R.getNumberOrAutoValidator)()),d.Factory.addGetterSetter(ne,"direction",y),d.Factory.addGetterSetter(ne,"fontFamily","Arial"),d.Factory.addGetterSetter(ne,"fontSize",12,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(ne,"fontStyle",b),d.Factory.addGetterSetter(ne,"fontVariant",b),d.Factory.addGetterSetter(ne,"padding",0,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(ne,"align",h),d.Factory.addGetterSetter(ne,"verticalAlign",D),d.Factory.addGetterSetter(ne,"lineHeight",1,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(ne,"wrap",A),d.Factory.addGetterSetter(ne,"ellipsis",!1,(0,R.getBooleanValidator)()),d.Factory.addGetterSetter(ne,"letterSpacing",0,(0,R.getNumberValidator)()),d.Factory.addGetterSetter(ne,"text","",(0,R.getStringValidator)()),d.Factory.addGetterSetter(ne,"textDecoration",""),or}var Jr={},Nl;function Rc(){if(Nl)return Jr;Nl=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.TextPath=void 0;const s=nt(),d=Ae(),L=mt(),z=ya(),R=Fl(),x=ze(),a=Re(),c="",g="normal";function y(w){w.fillText(this.partialText,0,0)}function v(w){w.strokeText(this.partialText,0,0)}class k extends L.Shape{constructor(m){super(m),this.dummyCanvas=s.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return z.Path.getPathLength(this.dataArray)}_getPointAtLength(m){if(!this.attrs.data)return null;const h=this.pathLength;return m-1>h?null:z.Path.getPointAtLengthOfDataArray(m,this.dataArray)}_readDataAttribute(){this.dataArray=z.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(m){m.setAttr("font",this._getContextFont()),m.setAttr("textBaseline",this.textBaseline()),m.setAttr("textAlign","left"),m.save();const h=this.textDecoration(),S=this.fill(),P=this.fontSize(),D=this.glyphInfo;h==="underline"&&m.beginPath();for(let u=0;u<D.length;u++){m.save();const o=D[u].p0;m.translate(o.x,o.y),m.rotate(D[u].rotation),this.partialText=D[u].text,m.fillStrokeShape(this),h==="underline"&&(u===0&&m.moveTo(0,P/2+1),m.lineTo(P,P/2+1)),m.restore()}h==="underline"&&(m.strokeStyle=S,m.lineWidth=P/20,m.stroke()),m.restore()}_hitFunc(m){m.beginPath();const h=this.glyphInfo;if(h.length>=1){const S=h[0].p0;m.moveTo(S.x,S.y)}for(let S=0;S<h.length;S++){const P=h[S].p1;m.lineTo(P.x,P.y)}m.setAttr("lineWidth",this.fontSize()),m.setAttr("strokeStyle",this.colorKey),m.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return s.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(m){return R.Text.prototype.setText.call(this,m)}_getContextFont(){return R.Text.prototype._getContextFont.call(this)}_getTextSize(m){const S=this.dummyCanvas.getContext("2d");S.save(),S.font=this._getContextFont();const P=S.measureText(m);return S.restore(),{width:P.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:m,height:h}=this._getTextSize(this.attrs.text);if(this.textWidth=m,this.textHeight=h,this.glyphInfo=[],!this.attrs.data)return null;const S=this.letterSpacing(),P=this.align(),D=this.kerningFunc(),u=Math.max(this.textWidth+((this.attrs.text||"").length-1)*S,0);let o=0;P==="center"&&(o=Math.max(0,this.pathLength/2-u/2)),P==="right"&&(o=Math.max(0,this.pathLength-u));const b=(0,R.stringToArray)(this.text());let I=o;for(let M=0;M<b.length;M++){const U=this._getPointAtLength(I);if(!U)return;let N=this._getTextSize(b[M]).width+S;if(b[M]===" "&&P==="justify"){const _=this.text().split(" ").length-1;N+=(this.pathLength-u)/_}const A=this._getPointAtLength(I+N);if(!A)return;const E=z.Path.getLineLength(U.x,U.y,A.x,A.y);let B=0;if(D)try{B=D(b[M-1],b[M])*this.fontSize()}catch{B=0}U.x+=B,A.x+=B,this.textWidth+=B;const q=z.Path.getPointOnLine(B+E/2,U.x,U.y,A.x,A.y),l=Math.atan2(A.y-U.y,A.x-U.x);this.glyphInfo.push({transposeX:q.x,transposeY:q.y,text:b[M],rotation:l,p0:U,p1:A}),I+=N}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const m=[];this.glyphInfo.forEach(function(I){m.push(I.p0.x),m.push(I.p0.y),m.push(I.p1.x),m.push(I.p1.y)});let h=m[0]||0,S=m[0]||0,P=m[1]||0,D=m[1]||0,u,o;for(let I=0;I<m.length/2;I++)u=m[I*2],o=m[I*2+1],h=Math.min(h,u),S=Math.max(S,u),P=Math.min(P,o),D=Math.max(D,o);const b=this.fontSize();return{x:h-b/2,y:P-b/2,width:S-h+b,height:D-P+b}}destroy(){return s.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return Jr.TextPath=k,k.prototype._fillFunc=y,k.prototype._strokeFunc=v,k.prototype._fillFuncHit=y,k.prototype._strokeFuncHit=v,k.prototype.className="TextPath",k.prototype._attrsAffectingSize=["text","fontSize","data"],(0,a._registerNode)(k),d.Factory.addGetterSetter(k,"data"),d.Factory.addGetterSetter(k,"fontFamily","Arial"),d.Factory.addGetterSetter(k,"fontSize",12,(0,x.getNumberValidator)()),d.Factory.addGetterSetter(k,"fontStyle",g),d.Factory.addGetterSetter(k,"align","left"),d.Factory.addGetterSetter(k,"letterSpacing",0,(0,x.getNumberValidator)()),d.Factory.addGetterSetter(k,"textBaseline","middle"),d.Factory.addGetterSetter(k,"fontVariant",g),d.Factory.addGetterSetter(k,"text",c),d.Factory.addGetterSetter(k,"textDecoration",""),d.Factory.addGetterSetter(k,"kerningFunc",void 0),Jr}var Zr={},Il;function Fc(){if(Il)return Zr;Il=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.Transformer=void 0;const s=nt(),d=Ae(),L=it(),z=mt(),R=bl(),x=ha(),a=Re(),c=ze(),g=Re(),y="tr-konva",v=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(N=>N+`.${y}`).join(" "),k="nodesRect",w=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],m={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},h="ontouchstart"in a.Konva._global;function S(N,A,E){if(N==="rotater")return E;A+=s.Util.degToRad(m[N]||0);const B=(s.Util.radToDeg(A)%360+360)%360;return s.Util._inRange(B,315+22.5,360)||s.Util._inRange(B,0,22.5)?"ns-resize":s.Util._inRange(B,45-22.5,45+22.5)?"nesw-resize":s.Util._inRange(B,90-22.5,90+22.5)?"ew-resize":s.Util._inRange(B,135-22.5,135+22.5)?"nwse-resize":s.Util._inRange(B,180-22.5,180+22.5)?"ns-resize":s.Util._inRange(B,225-22.5,225+22.5)?"nesw-resize":s.Util._inRange(B,270-22.5,270+22.5)?"ew-resize":s.Util._inRange(B,315-22.5,315+22.5)?"nwse-resize":(s.Util.error("Transformer has unknown angle for cursor detection: "+B),"pointer")}const P=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function D(N){return{x:N.x+N.width/2*Math.cos(N.rotation)+N.height/2*Math.sin(-N.rotation),y:N.y+N.height/2*Math.cos(N.rotation)+N.width/2*Math.sin(N.rotation)}}function u(N,A,E){const B=E.x+(N.x-E.x)*Math.cos(A)-(N.y-E.y)*Math.sin(A),q=E.y+(N.x-E.x)*Math.sin(A)+(N.y-E.y)*Math.cos(A);return{...N,rotation:N.rotation+A,x:B,y:q}}function o(N,A){const E=D(N);return u(N,A,E)}function b(N,A,E){let B=A;for(let q=0;q<N.length;q++){const l=a.Konva.getAngle(N[q]),_=Math.abs(l-A)%(Math.PI*2);Math.min(_,Math.PI*2-_)<E&&(B=l)}return B}let I=0;class M extends x.Group{constructor(A){super(A),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(v,this.update),this.getNode()&&this.update()}attachTo(A){return this.setNode(A),this}setNode(A){return s.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([A])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return y+this._id}setNodes(A=[]){this._nodes&&this._nodes.length&&this.detach();const E=A.filter(q=>q.isAncestorOf(this)?(s.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=A=E,A.length===1&&this.useSingleNodeRotation()?this.rotation(A[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(q=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(q._attrsAffectingSize.length){const _=q._attrsAffectingSize.map(C=>C+"Change."+this._getEventNamespace()).join(" ");q.on(_,l)}q.on(w.map(_=>_+`.${this._getEventNamespace()}`).join(" "),l),q.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(q)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(A){let E;A.on(`dragstart.${this._getEventNamespace()}`,B=>{E=A.getAbsolutePosition(),!this.isDragging()&&A!==this.findOne(".back")&&this.startDrag(B,!1)}),A.on(`dragmove.${this._getEventNamespace()}`,B=>{if(!E)return;const q=A.getAbsolutePosition(),l=q.x-E.x,_=q.y-E.y;this.nodes().forEach(C=>{if(C===A||C.isDragging())return;const O=C.getAbsolutePosition();C.setAbsolutePosition({x:O.x+l,y:O.y+_}),C.startDrag(B)}),E=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(A=>{A.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(k),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(k,this.__getNodeRect)}__getNodeShape(A,E=this.rotation(),B){const q=A.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=A.getAbsoluteScale(B),_=A.getAbsolutePosition(B),C=q.x*l.x-A.offsetX()*l.x,O=q.y*l.y-A.offsetY()*l.y,W=(a.Konva.getAngle(A.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),T={x:_.x+C*Math.cos(W)+O*Math.sin(-W),y:_.y+O*Math.cos(W)+C*Math.sin(W),width:q.width*l.x,height:q.height*l.y,rotation:W};return u(T,-a.Konva.getAngle(E),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const E=[];this.nodes().map(W=>{const T=W.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),X=[{x:T.x,y:T.y},{x:T.x+T.width,y:T.y},{x:T.x+T.width,y:T.y+T.height},{x:T.x,y:T.y+T.height}],Q=W.getAbsoluteTransform();X.forEach(function(ne){const le=Q.point(ne);E.push(le)})});const B=new s.Transform;B.rotate(-a.Konva.getAngle(this.rotation()));let q=1/0,l=1/0,_=-1/0,C=-1/0;E.forEach(function(W){const T=B.point(W);q===void 0&&(q=_=T.x,l=C=T.y),q=Math.min(q,T.x),l=Math.min(l,T.y),_=Math.max(_,T.x),C=Math.max(C,T.y)}),B.invert();const O=B.point({x:q,y:l});return{x:O.x,y:O.y,width:_-q,height:C-l,rotation:a.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),P.forEach(A=>{this._createAnchor(A)}),this._createAnchor("rotater")}_createAnchor(A){const E=new R.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:A+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:h?10:"auto"}),B=this;E.on("mousedown touchstart",function(q){B._handleMouseDown(q)}),E.on("dragstart",q=>{E.stopDrag(),q.cancelBubble=!0}),E.on("dragend",q=>{q.cancelBubble=!0}),E.on("mouseenter",()=>{const q=a.Konva.getAngle(this.rotation()),l=this.rotateAnchorCursor(),_=S(A,q,l);E.getStage().content&&(E.getStage().content.style.cursor=_),this._cursorChange=!0}),E.on("mouseout",()=>{E.getStage().content&&(E.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(E)}_createBack(){const A=new z.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(E,B){const q=B.getParent(),l=q.padding();E.beginPath(),E.rect(-l,-l,B.width()+l*2,B.height()+l*2),E.moveTo(B.width()/2,-l),q.rotateEnabled()&&q.rotateLineVisible()&&E.lineTo(B.width()/2,-q.rotateAnchorOffset()*s.Util._sign(B.height())-l),E.fillStrokeShape(B)},hitFunc:(E,B)=>{if(!this.shouldOverdrawWholeArea())return;const q=this.padding();E.beginPath(),E.rect(-q,-q,B.width()+q*2,B.height()+q*2),E.fillStrokeShape(B)}});this.add(A),this._proxyDrag(A),A.on("dragstart",E=>{E.cancelBubble=!0}),A.on("dragmove",E=>{E.cancelBubble=!0}),A.on("dragend",E=>{E.cancelBubble=!0}),this.on("dragmove",E=>{this.update()})}_handleMouseDown(A){if(this._transforming)return;this._movingAnchorName=A.target.name().split(" ")[0];const E=this._getNodeRect(),B=E.width,q=E.height,l=Math.sqrt(Math.pow(B,2)+Math.pow(q,2));this.sin=Math.abs(q/l),this.cos=Math.abs(B/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const _=A.target.getAbsolutePosition(),C=A.target.getStage().getPointerPosition();this._anchorDragOffset={x:C.x-_.x,y:C.y-_.y},I++,this._fire("transformstart",{evt:A.evt,target:this.getNode()}),this._nodes.forEach(O=>{O._fire("transformstart",{evt:A.evt,target:O})})}_handleMouseMove(A){let E,B,q;const l=this.findOne("."+this._movingAnchorName),_=l.getStage();_.setPointersPositions(A);const C=_.getPointerPosition();let O={x:C.x-this._anchorDragOffset.x,y:C.y-this._anchorDragOffset.y};const W=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(O=this.anchorDragBoundFunc()(W,O,A)),l.setAbsolutePosition(O);const T=l.getAbsolutePosition();if(W.x===T.x&&W.y===T.y)return;if(this._movingAnchorName==="rotater"){const de=this._getNodeRect();E=l.x()-de.width/2,B=-l.y()+de.height/2;let ae=Math.atan2(-B,E)+Math.PI/2;de.height<0&&(ae-=Math.PI);const ve=a.Konva.getAngle(this.rotation())+ae,Ce=a.Konva.getAngle(this.rotationSnapTolerance()),be=b(this.rotationSnaps(),ve,Ce)-de.rotation,$e=o(de,be);this._fitNodesInto($e,A);return}const X=this.shiftBehavior();let Q;X==="inverted"?Q=this.keepRatio()&&!A.shiftKey:X==="none"?Q=this.keepRatio():Q=this.keepRatio()||A.shiftKey;var ge=this.centeredScaling()||A.altKey;if(this._movingAnchorName==="top-left"){if(Q){var ne=ge?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};q=Math.sqrt(Math.pow(ne.x-l.x(),2)+Math.pow(ne.y-l.y(),2));var le=this.findOne(".top-left").x()>ne.x?-1:1,ie=this.findOne(".top-left").y()>ne.y?-1:1;E=q*this.cos*le,B=q*this.sin*ie,this.findOne(".top-left").x(ne.x-E),this.findOne(".top-left").y(ne.y-B)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(Q){var ne=ge?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};q=Math.sqrt(Math.pow(l.x()-ne.x,2)+Math.pow(ne.y-l.y(),2));var le=this.findOne(".top-right").x()<ne.x?-1:1,ie=this.findOne(".top-right").y()>ne.y?-1:1;E=q*this.cos*le,B=q*this.sin*ie,this.findOne(".top-right").x(ne.x+E),this.findOne(".top-right").y(ne.y-B)}var oe=l.position();this.findOne(".top-left").y(oe.y),this.findOne(".bottom-right").x(oe.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(Q){var ne=ge?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};q=Math.sqrt(Math.pow(ne.x-l.x(),2)+Math.pow(l.y()-ne.y,2));var le=ne.x<l.x()?-1:1,ie=l.y()<ne.y?-1:1;E=q*this.cos*le,B=q*this.sin*ie,l.x(ne.x-E),l.y(ne.y+B)}oe=l.position(),this.findOne(".top-left").x(oe.x),this.findOne(".bottom-right").y(oe.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(Q){var ne=ge?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};q=Math.sqrt(Math.pow(l.x()-ne.x,2)+Math.pow(l.y()-ne.y,2));var le=this.findOne(".bottom-right").x()<ne.x?-1:1,ie=this.findOne(".bottom-right").y()<ne.y?-1:1;E=q*this.cos*le,B=q*this.sin*ie,this.findOne(".bottom-right").x(ne.x+E),this.findOne(".bottom-right").y(ne.y+B)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var ge=this.centeredScaling()||A.altKey;if(ge){const de=this.findOne(".top-left"),ae=this.findOne(".bottom-right"),ce=de.x(),ve=de.y(),Ce=this.getWidth()-ae.x(),Fe=this.getHeight()-ae.y();ae.move({x:-ce,y:-ve}),de.move({x:Ce,y:Fe})}const fe=this.findOne(".top-left").getAbsolutePosition();E=fe.x,B=fe.y;const H=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),te=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:E,y:B,width:H,height:te,rotation:a.Konva.getAngle(this.rotation())},A)}_handleMouseUp(A){this._removeEvents(A)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(A){var E;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const B=this.getNode();I--,this._fire("transformend",{evt:A,target:B}),(E=this.getLayer())===null||E===void 0||E.batchDraw(),B&&this._nodes.forEach(q=>{var l;q._fire("transformend",{evt:A,target:q}),(l=q.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(A,E){const B=this._getNodeRect(),q=1;if(s.Util._inRange(A.width,-this.padding()*2-q,q)){this.update();return}if(s.Util._inRange(A.height,-this.padding()*2-q,q)){this.update();return}const l=new s.Transform;if(l.rotate(a.Konva.getAngle(this.rotation())),this._movingAnchorName&&A.width<0&&this._movingAnchorName.indexOf("left")>=0){const Q=l.point({x:-this.padding()*2,y:0});A.x+=Q.x,A.y+=Q.y,A.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y}else if(this._movingAnchorName&&A.width<0&&this._movingAnchorName.indexOf("right")>=0){const Q=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y,A.width+=this.padding()*2}if(this._movingAnchorName&&A.height<0&&this._movingAnchorName.indexOf("top")>=0){const Q=l.point({x:0,y:-this.padding()*2});A.x+=Q.x,A.y+=Q.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y,A.height+=this.padding()*2}else if(this._movingAnchorName&&A.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const Q=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y,A.height+=this.padding()*2}if(this.boundBoxFunc()){const Q=this.boundBoxFunc()(B,A);Q?A=Q:s.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const _=1e7,C=new s.Transform;C.translate(B.x,B.y),C.rotate(B.rotation),C.scale(B.width/_,B.height/_);const O=new s.Transform,W=A.width/_,T=A.height/_;this.flipEnabled()===!1?(O.translate(A.x,A.y),O.rotate(A.rotation),O.translate(A.width<0?A.width:0,A.height<0?A.height:0),O.scale(Math.abs(W),Math.abs(T))):(O.translate(A.x,A.y),O.rotate(A.rotation),O.scale(W,T));const X=O.multiply(C.invert());this._nodes.forEach(Q=>{var ne;const le=Q.getParent().getAbsoluteTransform(),ie=Q.getTransform().copy();ie.translate(Q.offsetX(),Q.offsetY());const oe=new s.Transform;oe.multiply(le.copy().invert()).multiply(X).multiply(le).multiply(ie);const ge=oe.decompose();Q.setAttrs(ge),(ne=Q.getLayer())===null||ne===void 0||ne.batchDraw()}),this.rotation(s.Util._getRotation(A.rotation)),this._nodes.forEach(Q=>{this._fire("transform",{evt:E,target:Q}),Q._fire("transform",{evt:E,target:Q})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(A,E){this.findOne(A).setAttrs(E)}update(){var A;const E=this._getNodeRect();this.rotation(s.Util._getRotation(E.rotation));const B=E.width,q=E.height,l=this.enabledAnchors(),_=this.resizeEnabled(),C=this.padding(),O=this.anchorSize(),W=this.find("._anchor");W.forEach(X=>{X.setAttrs({width:O,height:O,offsetX:O/2,offsetY:O/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:O/2+C,offsetY:O/2+C,visible:_&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:B/2,y:0,offsetY:O/2+C,visible:_&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:B,y:0,offsetX:O/2-C,offsetY:O/2+C,visible:_&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:q/2,offsetX:O/2+C,visible:_&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:B,y:q/2,offsetX:O/2-C,visible:_&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:q,offsetX:O/2+C,offsetY:O/2-C,visible:_&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:B/2,y:q,offsetY:O/2-C,visible:_&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:B,y:q,offsetX:O/2-C,offsetY:O/2-C,visible:_&&l.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:B/2,y:-this.rotateAnchorOffset()*s.Util._sign(q)-C,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:B,height:q,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const T=this.anchorStyleFunc();T&&W.forEach(X=>{T(X)}),(A=this.getLayer())===null||A===void 0||A.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const A=this.findOne("."+this._movingAnchorName);A&&A.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),x.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return L.Node.prototype.toObject.call(this)}clone(A){return L.Node.prototype.clone.call(this,A)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Zr.Transformer=M,M.isTransforming=()=>I>0;function U(N){return N instanceof Array||s.Util.warn("enabledAnchors value should be an array"),N instanceof Array&&N.forEach(function(A){P.indexOf(A)===-1&&s.Util.warn("Unknown anchor name: "+A+". Available names are: "+P.join(", "))}),N||[]}return M.prototype.className="Transformer",(0,g._registerNode)(M),d.Factory.addGetterSetter(M,"enabledAnchors",P,U),d.Factory.addGetterSetter(M,"flipEnabled",!0,(0,c.getBooleanValidator)()),d.Factory.addGetterSetter(M,"resizeEnabled",!0),d.Factory.addGetterSetter(M,"anchorSize",10,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"rotateEnabled",!0),d.Factory.addGetterSetter(M,"rotateLineVisible",!0),d.Factory.addGetterSetter(M,"rotationSnaps",[]),d.Factory.addGetterSetter(M,"rotateAnchorOffset",50,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"rotateAnchorCursor","crosshair"),d.Factory.addGetterSetter(M,"rotationSnapTolerance",5,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"borderEnabled",!0),d.Factory.addGetterSetter(M,"anchorStroke","rgb(0, 161, 255)"),d.Factory.addGetterSetter(M,"anchorStrokeWidth",1,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"anchorFill","white"),d.Factory.addGetterSetter(M,"anchorCornerRadius",0,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"borderStroke","rgb(0, 161, 255)"),d.Factory.addGetterSetter(M,"borderStrokeWidth",1,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"borderDash"),d.Factory.addGetterSetter(M,"keepRatio",!0),d.Factory.addGetterSetter(M,"shiftBehavior","default"),d.Factory.addGetterSetter(M,"centeredScaling",!1),d.Factory.addGetterSetter(M,"ignoreStroke",!1),d.Factory.addGetterSetter(M,"padding",0,(0,c.getNumberValidator)()),d.Factory.addGetterSetter(M,"nodes"),d.Factory.addGetterSetter(M,"node"),d.Factory.addGetterSetter(M,"boundBoxFunc"),d.Factory.addGetterSetter(M,"anchorDragBoundFunc"),d.Factory.addGetterSetter(M,"anchorStyleFunc"),d.Factory.addGetterSetter(M,"shouldOverdrawWholeArea",!1),d.Factory.addGetterSetter(M,"useSingleNodeRotation",!0),d.Factory.backCompat(M,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Zr}var $r={},Ml;function Nc(){if(Ml)return $r;Ml=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.Wedge=void 0;const s=Ae(),d=mt(),L=Re(),z=ze(),R=Re();let x=class extends d.Shape{_sceneFunc(c){c.beginPath(),c.arc(0,0,this.radius(),0,L.Konva.getAngle(this.angle()),this.clockwise()),c.lineTo(0,0),c.closePath(),c.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(c){this.radius(c/2)}setHeight(c){this.radius(c/2)}};return $r.Wedge=x,x.prototype.className="Wedge",x.prototype._centroid=!0,x.prototype._attrsAffectingSize=["radius"],(0,R._registerNode)(x),s.Factory.addGetterSetter(x,"radius",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(x,"angle",0,(0,z.getNumberValidator)()),s.Factory.addGetterSetter(x,"clockwise",!1),s.Factory.backCompat(x,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),$r}var ei={},Al;function Ic(){if(Al)return ei;Al=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Blur=void 0;const s=Ae(),d=it(),L=ze();function z(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const R=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],x=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function a(g,y){const v=g.data,k=g.width,w=g.height;let m,h,S,P,D,u,o,b,I,M,U,N,A,E,B,q,l,_,C,O,W,T,X,Q;const ne=y+y+1,le=k-1,ie=w-1,oe=y+1,ge=oe*(oe+1)/2,fe=new z,H=R[y],te=x[y];let de=null,ae=fe,ce=null,ve=null;for(S=1;S<ne;S++)ae=ae.next=new z,S===oe&&(de=ae);for(ae.next=fe,o=u=0,h=0;h<w;h++){for(q=l=_=C=b=I=M=U=0,N=oe*(O=v[u]),A=oe*(W=v[u+1]),E=oe*(T=v[u+2]),B=oe*(X=v[u+3]),b+=ge*O,I+=ge*W,M+=ge*T,U+=ge*X,ae=fe,S=0;S<oe;S++)ae.r=O,ae.g=W,ae.b=T,ae.a=X,ae=ae.next;for(S=1;S<oe;S++)P=u+((le<S?le:S)<<2),b+=(ae.r=O=v[P])*(Q=oe-S),I+=(ae.g=W=v[P+1])*Q,M+=(ae.b=T=v[P+2])*Q,U+=(ae.a=X=v[P+3])*Q,q+=O,l+=W,_+=T,C+=X,ae=ae.next;for(ce=fe,ve=de,m=0;m<k;m++)v[u+3]=X=U*H>>te,X!==0?(X=255/X,v[u]=(b*H>>te)*X,v[u+1]=(I*H>>te)*X,v[u+2]=(M*H>>te)*X):v[u]=v[u+1]=v[u+2]=0,b-=N,I-=A,M-=E,U-=B,N-=ce.r,A-=ce.g,E-=ce.b,B-=ce.a,P=o+((P=m+y+1)<le?P:le)<<2,q+=ce.r=v[P],l+=ce.g=v[P+1],_+=ce.b=v[P+2],C+=ce.a=v[P+3],b+=q,I+=l,M+=_,U+=C,ce=ce.next,N+=O=ve.r,A+=W=ve.g,E+=T=ve.b,B+=X=ve.a,q-=O,l-=W,_-=T,C-=X,ve=ve.next,u+=4;o+=k}for(m=0;m<k;m++){for(l=_=C=q=I=M=U=b=0,u=m<<2,N=oe*(O=v[u]),A=oe*(W=v[u+1]),E=oe*(T=v[u+2]),B=oe*(X=v[u+3]),b+=ge*O,I+=ge*W,M+=ge*T,U+=ge*X,ae=fe,S=0;S<oe;S++)ae.r=O,ae.g=W,ae.b=T,ae.a=X,ae=ae.next;for(D=k,S=1;S<=y;S++)u=D+m<<2,b+=(ae.r=O=v[u])*(Q=oe-S),I+=(ae.g=W=v[u+1])*Q,M+=(ae.b=T=v[u+2])*Q,U+=(ae.a=X=v[u+3])*Q,q+=O,l+=W,_+=T,C+=X,ae=ae.next,S<ie&&(D+=k);for(u=m,ce=fe,ve=de,h=0;h<w;h++)P=u<<2,v[P+3]=X=U*H>>te,X>0?(X=255/X,v[P]=(b*H>>te)*X,v[P+1]=(I*H>>te)*X,v[P+2]=(M*H>>te)*X):v[P]=v[P+1]=v[P+2]=0,b-=N,I-=A,M-=E,U-=B,N-=ce.r,A-=ce.g,E-=ce.b,B-=ce.a,P=m+((P=h+oe)<ie?P:ie)*k<<2,b+=q+=ce.r=v[P],I+=l+=ce.g=v[P+1],M+=_+=ce.b=v[P+2],U+=C+=ce.a=v[P+3],ce=ce.next,N+=O=ve.r,A+=W=ve.g,E+=T=ve.b,B+=X=ve.a,q-=O,l-=W,_-=T,C-=X,ve=ve.next,u+=k}}const c=function(y){const v=Math.round(this.blurRadius());v>0&&a(y,v)};return ei.Blur=c,s.Factory.addGetterSetter(d.Node,"blurRadius",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),ei}var ti={},Ll;function Mc(){if(Ll)return ti;Ll=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Brighten=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=this.brightness()*255,a=R.data,c=a.length;for(let g=0;g<c;g+=4)a[g]+=x,a[g+1]+=x,a[g+2]+=x};return ti.Brighten=z,s.Factory.addGetterSetter(d.Node,"brightness",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),ti}var ni={},zl;function Ac(){if(zl)return ni;zl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Contrast=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=Math.pow((this.contrast()+100)/100,2),a=R.data,c=a.length;let g=150,y=150,v=150;for(let k=0;k<c;k+=4)g=a[k],y=a[k+1],v=a[k+2],g/=255,g-=.5,g*=x,g+=.5,g*=255,y/=255,y-=.5,y*=x,y+=.5,y*=255,v/=255,v-=.5,v*=x,v+=.5,v*=255,g=g<0?0:g>255?255:g,y=y<0?0:y>255?255:y,v=v<0?0:v>255?255:v,a[k]=g,a[k+1]=y,a[k+2]=v};return ni.Contrast=z,s.Factory.addGetterSetter(d.Node,"contrast",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),ni}var ri={},Dl;function Lc(){if(Dl)return ri;Dl=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Emboss=void 0;const s=Ae(),d=it(),L=nt(),z=ze(),R=function(x){const a=this.embossStrength()*10,c=this.embossWhiteLevel()*255,g=this.embossDirection(),y=this.embossBlend(),v=x.data,k=x.width,w=x.height,m=k*4;let h=0,S=0,P=w;switch(g){case"top-left":h=-1,S=-1;break;case"top":h=-1,S=0;break;case"top-right":h=-1,S=1;break;case"right":h=0,S=1;break;case"bottom-right":h=1,S=1;break;case"bottom":h=1,S=0;break;case"bottom-left":h=1,S=-1;break;case"left":h=0,S=-1;break;default:L.Util.error("Unknown emboss direction: "+g)}do{const D=(P-1)*m;let u=h;P+u<1&&(u=0),P+u>w&&(u=0);const o=(P-1+u)*k*4;let b=k;do{const I=D+(b-1)*4;let M=S;b+M<1&&(M=0),b+M>k&&(M=0);const U=o+(b-1+M)*4,N=v[I]-v[U],A=v[I+1]-v[U+1],E=v[I+2]-v[U+2];let B=N;const q=B>0?B:-B,l=A>0?A:-A,_=E>0?E:-E;if(l>q&&(B=A),_>q&&(B=E),B*=a,y){const C=v[I]+B,O=v[I+1]+B,W=v[I+2]+B;v[I]=C>255?255:C<0?0:C,v[I+1]=O>255?255:O<0?0:O,v[I+2]=W>255?255:W<0?0:W}else{let C=c-B;C<0?C=0:C>255&&(C=255),v[I]=v[I+1]=v[I+2]=C}}while(--b)}while(--P)};return ri.Emboss=R,s.Factory.addGetterSetter(d.Node,"embossStrength",.5,(0,z.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"embossWhiteLevel",.5,(0,z.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"embossDirection","top-left",void 0,s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"embossBlend",!1,void 0,s.Factory.afterSetFilter),ri}var ii={},Ol;function zc(){if(Ol)return ii;Ol=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Enhance=void 0;const s=Ae(),d=it(),L=ze();function z(x,a,c,g,y){const v=c-a,k=y-g;if(v===0)return g+k/2;if(k===0)return g;let w=(x-a)/v;return w=k*w+g,w}const R=function(x){const a=x.data,c=a.length;let g=a[0],y=g,v,k=a[1],w=k,m,h=a[2],S=h,P;const D=this.enhance();if(D===0)return;for(let B=0;B<c;B+=4)v=a[B+0],v<g?g=v:v>y&&(y=v),m=a[B+1],m<k?k=m:m>w&&(w=m),P=a[B+2],P<h?h=P:P>S&&(S=P);y===g&&(y=255,g=0),w===k&&(w=255,k=0),S===h&&(S=255,h=0);let u,o,b,I,M,U,N,A,E;D>0?(o=y+D*(255-y),b=g-D*(g-0),M=w+D*(255-w),U=k-D*(k-0),A=S+D*(255-S),E=h-D*(h-0)):(u=(y+g)*.5,o=y+D*(y-u),b=g+D*(g-u),I=(w+k)*.5,M=w+D*(w-I),U=k+D*(k-I),N=(S+h)*.5,A=S+D*(S-N),E=h+D*(h-N));for(let B=0;B<c;B+=4)a[B+0]=z(a[B+0],g,y,b,o),a[B+1]=z(a[B+1],k,w,U,M),a[B+2]=z(a[B+2],h,S,E,A)};return ii.Enhance=R,s.Factory.addGetterSetter(d.Node,"enhance",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),ii}var si={},Gl;function Dc(){if(Gl)return si;Gl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Grayscale=void 0;const s=function(d){const L=d.data,z=L.length;for(let R=0;R<z;R+=4){const x=.34*L[R]+.5*L[R+1]+.16*L[R+2];L[R]=x,L[R+1]=x,L[R+2]=x}};return si.Grayscale=s,si}var ai={},Bl;function Oc(){if(Bl)return ai;Bl=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.HSL=void 0;const s=Ae(),d=it(),L=ze();s.Factory.addGetterSetter(d.Node,"hue",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"saturation",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"luminance",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter);const z=function(R){const x=R.data,a=x.length,c=1,g=Math.pow(2,this.saturation()),y=Math.abs(this.hue()+360)%360,v=this.luminance()*127,k=c*g*Math.cos(y*Math.PI/180),w=c*g*Math.sin(y*Math.PI/180),m=.299*c+.701*k+.167*w,h=.587*c-.587*k+.33*w,S=.114*c-.114*k-.497*w,P=.299*c-.299*k-.328*w,D=.587*c+.413*k+.035*w,u=.114*c-.114*k+.293*w,o=.299*c-.3*k+1.25*w,b=.587*c-.586*k-1.05*w,I=.114*c+.886*k-.2*w;let M,U,N,A;for(let E=0;E<a;E+=4)M=x[E+0],U=x[E+1],N=x[E+2],A=x[E+3],x[E+0]=m*M+h*U+S*N+v,x[E+1]=P*M+D*U+u*N+v,x[E+2]=o*M+b*U+I*N+v,x[E+3]=A};return ai.HSL=z,ai}var oi={},Ul;function Gc(){if(Ul)return oi;Ul=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.HSV=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=R.data,a=x.length,c=Math.pow(2,this.value()),g=Math.pow(2,this.saturation()),y=Math.abs(this.hue()+360)%360,v=c*g*Math.cos(y*Math.PI/180),k=c*g*Math.sin(y*Math.PI/180),w=.299*c+.701*v+.167*k,m=.587*c-.587*v+.33*k,h=.114*c-.114*v-.497*k,S=.299*c-.299*v-.328*k,P=.587*c+.413*v+.035*k,D=.114*c-.114*v+.293*k,u=.299*c-.3*v+1.25*k,o=.587*c-.586*v-1.05*k,b=.114*c+.886*v-.2*k;let I,M,U,N;for(let A=0;A<a;A+=4)I=x[A+0],M=x[A+1],U=x[A+2],N=x[A+3],x[A+0]=w*I+m*M+h*U,x[A+1]=S*I+P*M+D*U,x[A+2]=u*I+o*M+b*U,x[A+3]=N};return oi.HSV=z,s.Factory.addGetterSetter(d.Node,"hue",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"saturation",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"value",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),oi}var li={},jl;function Bc(){if(jl)return li;jl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Invert=void 0;const s=function(d){const L=d.data,z=L.length;for(let R=0;R<z;R+=4)L[R]=255-L[R],L[R+1]=255-L[R+1],L[R+2]=255-L[R+2]};return li.Invert=s,li}var di={},Hl;function Uc(){if(Hl)return di;Hl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Kaleidoscope=void 0;const s=Ae(),d=it(),L=nt(),z=ze(),R=function(c,g,y){const v=c.data,k=g.data,w=c.width,m=c.height,h=y.polarCenterX||w/2,S=y.polarCenterY||m/2;let P=Math.sqrt(h*h+S*S),D=w-h,u=m-S;const o=Math.sqrt(D*D+u*u);P=o>P?o:P;const b=m,I=w,M=360/I*Math.PI/180;for(let U=0;U<I;U+=1){const N=Math.sin(U*M),A=Math.cos(U*M);for(let E=0;E<b;E+=1){D=Math.floor(h+P*E/b*A),u=Math.floor(S+P*E/b*N);let B=(u*w+D)*4;const q=v[B+0],l=v[B+1],_=v[B+2],C=v[B+3];B=(U+E*w)*4,k[B+0]=q,k[B+1]=l,k[B+2]=_,k[B+3]=C}}},x=function(c,g,y){const v=c.data,k=g.data,w=c.width,m=c.height,h=y.polarCenterX||w/2,S=y.polarCenterY||m/2;let P=Math.sqrt(h*h+S*S),D=w-h,u=m-S;const o=Math.sqrt(D*D+u*u);P=o>P?o:P;const b=m,I=w,M=0;let U,N;for(D=0;D<w;D+=1)for(u=0;u<m;u+=1){const A=D-h,E=u-S,B=Math.sqrt(A*A+E*E)*b/P;let q=(Math.atan2(E,A)*180/Math.PI+360+M)%360;q=q*I/360,U=Math.floor(q),N=Math.floor(B);let l=(N*w+U)*4;const _=v[l+0],C=v[l+1],O=v[l+2],W=v[l+3];l=(u*w+D)*4,k[l+0]=_,k[l+1]=C,k[l+2]=O,k[l+3]=W}},a=function(c){const g=c.width,y=c.height;let v,k,w,m,h,S,P,D,u,o,b=Math.round(this.kaleidoscopePower());const I=Math.round(this.kaleidoscopeAngle()),M=Math.floor(g*(I%360)/360);if(b<1)return;const U=L.Util.createCanvasElement();U.width=g,U.height=y;const N=U.getContext("2d").getImageData(0,0,g,y);L.Util.releaseCanvas(U),R(c,N,{polarCenterX:g/2,polarCenterY:y/2});let A=g/Math.pow(2,b);for(;A<=8;)A=A*2,b-=1;A=Math.ceil(A);let E=A,B=0,q=E,l=1;for(M+A>g&&(B=E,q=0,l=-1),k=0;k<y;k+=1)for(v=B;v!==q;v+=l)w=Math.round(v+M)%g,u=(g*k+w)*4,h=N.data[u+0],S=N.data[u+1],P=N.data[u+2],D=N.data[u+3],o=(g*k+v)*4,N.data[o+0]=h,N.data[o+1]=S,N.data[o+2]=P,N.data[o+3]=D;for(k=0;k<y;k+=1)for(E=Math.floor(A),m=0;m<b;m+=1){for(v=0;v<E+1;v+=1)u=(g*k+v)*4,h=N.data[u+0],S=N.data[u+1],P=N.data[u+2],D=N.data[u+3],o=(g*k+E*2-v-1)*4,N.data[o+0]=h,N.data[o+1]=S,N.data[o+2]=P,N.data[o+3]=D;E*=2}x(N,c,{})};return di.Kaleidoscope=a,s.Factory.addGetterSetter(d.Node,"kaleidoscopePower",2,(0,z.getNumberValidator)(),s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"kaleidoscopeAngle",0,(0,z.getNumberValidator)(),s.Factory.afterSetFilter),di}var ui={},Wl;function jc(){if(Wl)return ui;Wl=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Mask=void 0;const s=Ae(),d=it(),L=ze();function z(w,m,h){let S=(h*w.width+m)*4;const P=[];return P.push(w.data[S++],w.data[S++],w.data[S++],w.data[S++]),P}function R(w,m){return Math.sqrt(Math.pow(w[0]-m[0],2)+Math.pow(w[1]-m[1],2)+Math.pow(w[2]-m[2],2))}function x(w){const m=[0,0,0];for(let h=0;h<w.length;h++)m[0]+=w[h][0],m[1]+=w[h][1],m[2]+=w[h][2];return m[0]/=w.length,m[1]/=w.length,m[2]/=w.length,m}function a(w,m){const h=z(w,0,0),S=z(w,w.width-1,0),P=z(w,0,w.height-1),D=z(w,w.width-1,w.height-1),u=m||10;if(R(h,S)<u&&R(S,D)<u&&R(D,P)<u&&R(P,h)<u){const o=x([S,h,D,P]),b=[];for(let I=0;I<w.width*w.height;I++){const M=R(o,[w.data[I*4],w.data[I*4+1],w.data[I*4+2]]);b[I]=M<u?0:255}return b}}function c(w,m){for(let h=0;h<w.width*w.height;h++)w.data[4*h+3]=m[h]}function g(w,m,h){const S=[1,1,1,1,0,1,1,1,1],P=Math.round(Math.sqrt(S.length)),D=Math.floor(P/2),u=[];for(let o=0;o<h;o++)for(let b=0;b<m;b++){const I=o*m+b;let M=0;for(let U=0;U<P;U++)for(let N=0;N<P;N++){const A=o+U-D,E=b+N-D;if(A>=0&&A<h&&E>=0&&E<m){const B=A*m+E,q=S[U*P+N];M+=w[B]*q}}u[I]=M===255*8?255:0}return u}function y(w,m,h){const S=[1,1,1,1,1,1,1,1,1],P=Math.round(Math.sqrt(S.length)),D=Math.floor(P/2),u=[];for(let o=0;o<h;o++)for(let b=0;b<m;b++){const I=o*m+b;let M=0;for(let U=0;U<P;U++)for(let N=0;N<P;N++){const A=o+U-D,E=b+N-D;if(A>=0&&A<h&&E>=0&&E<m){const B=A*m+E,q=S[U*P+N];M+=w[B]*q}}u[I]=M>=255*4?255:0}return u}function v(w,m,h){const S=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],P=Math.round(Math.sqrt(S.length)),D=Math.floor(P/2),u=[];for(let o=0;o<h;o++)for(let b=0;b<m;b++){const I=o*m+b;let M=0;for(let U=0;U<P;U++)for(let N=0;N<P;N++){const A=o+U-D,E=b+N-D;if(A>=0&&A<h&&E>=0&&E<m){const B=A*m+E,q=S[U*P+N];M+=w[B]*q}}u[I]=M}return u}const k=function(w){const m=this.threshold();let h=a(w,m);return h&&(h=g(h,w.width,w.height),h=y(h,w.width,w.height),h=v(h,w.width,w.height),c(w,h)),w};return ui.Mask=k,s.Factory.addGetterSetter(d.Node,"threshold",0,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),ui}var ci={},Vl;function Hc(){if(Vl)return ci;Vl=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Noise=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=this.noise()*255,a=R.data,c=a.length,g=x/2;for(let y=0;y<c;y+=4)a[y+0]+=g-2*g*Math.random(),a[y+1]+=g-2*g*Math.random(),a[y+2]+=g-2*g*Math.random()};return ci.Noise=z,s.Factory.addGetterSetter(d.Node,"noise",.2,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),ci}var hi={},ql;function Wc(){if(ql)return hi;ql=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Pixelate=void 0;const s=Ae(),d=nt(),L=it(),z=ze(),R=function(x){let a=Math.ceil(this.pixelSize()),c=x.width,g=x.height,y,v,k,w,m,h,S,P=Math.ceil(c/a),D=Math.ceil(g/a),u,o,b,I,M,U,N,A=x.data;if(a<=0){d.Util.error("pixelSize value can not be <= 0");return}for(M=0;M<P;M+=1)for(U=0;U<D;U+=1){for(w=0,m=0,h=0,S=0,u=M*a,o=u+a,b=U*a,I=b+a,N=0,y=u;y<o;y+=1)if(!(y>=c))for(v=b;v<I;v+=1)v>=g||(k=(c*v+y)*4,w+=A[k+0],m+=A[k+1],h+=A[k+2],S+=A[k+3],N+=1);for(w=w/N,m=m/N,h=h/N,S=S/N,y=u;y<o;y+=1)if(!(y>=c))for(v=b;v<I;v+=1)v>=g||(k=(c*v+y)*4,A[k+0]=w,A[k+1]=m,A[k+2]=h,A[k+3]=S)}};return hi.Pixelate=R,s.Factory.addGetterSetter(L.Node,"pixelSize",8,(0,z.getNumberValidator)(),s.Factory.afterSetFilter),hi}var fi={},Yl;function Vc(){if(Yl)return fi;Yl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Posterize=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=Math.round(this.levels()*254)+1,a=R.data,c=a.length,g=255/x;for(let y=0;y<c;y+=1)a[y]=Math.floor(a[y]/g)*g};return fi.Posterize=z,s.Factory.addGetterSetter(d.Node,"levels",.5,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),fi}var gi={},Kl;function qc(){if(Kl)return gi;Kl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.RGB=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=R.data,a=x.length,c=this.red(),g=this.green(),y=this.blue();for(let v=0;v<a;v+=4){const k=(.34*x[v]+.5*x[v+1]+.16*x[v+2])/255;x[v]=k*c,x[v+1]=k*g,x[v+2]=k*y,x[v+3]=x[v+3]}};return gi.RGB=z,s.Factory.addGetterSetter(d.Node,"red",0,function(R){return this._filterUpToDate=!1,R>255?255:R<0?0:Math.round(R)}),s.Factory.addGetterSetter(d.Node,"green",0,function(R){return this._filterUpToDate=!1,R>255?255:R<0?0:Math.round(R)}),s.Factory.addGetterSetter(d.Node,"blue",0,L.RGBComponent,s.Factory.afterSetFilter),gi}var pi={},Xl;function Yc(){if(Xl)return pi;Xl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.RGBA=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=R.data,a=x.length,c=this.red(),g=this.green(),y=this.blue(),v=this.alpha();for(let k=0;k<a;k+=4){const w=1-v;x[k]=c*v+x[k]*w,x[k+1]=g*v+x[k+1]*w,x[k+2]=y*v+x[k+2]*w}};return pi.RGBA=z,s.Factory.addGetterSetter(d.Node,"red",0,function(R){return this._filterUpToDate=!1,R>255?255:R<0?0:Math.round(R)}),s.Factory.addGetterSetter(d.Node,"green",0,function(R){return this._filterUpToDate=!1,R>255?255:R<0?0:Math.round(R)}),s.Factory.addGetterSetter(d.Node,"blue",0,L.RGBComponent,s.Factory.afterSetFilter),s.Factory.addGetterSetter(d.Node,"alpha",1,function(R){return this._filterUpToDate=!1,R>1?1:R<0?0:R}),pi}var mi={},Ql;function Kc(){if(Ql)return mi;Ql=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Sepia=void 0;const s=function(d){const L=d.data,z=L.length;for(let R=0;R<z;R+=4){const x=L[R+0],a=L[R+1],c=L[R+2];L[R+0]=Math.min(255,x*.393+a*.769+c*.189),L[R+1]=Math.min(255,x*.349+a*.686+c*.168),L[R+2]=Math.min(255,x*.272+a*.534+c*.131)}};return mi.Sepia=s,mi}var yi={},Jl;function Xc(){if(Jl)return yi;Jl=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Solarize=void 0;const s=function(d){const L=d.data,z=d.width,R=d.height,x=z*4;let a=R;do{const c=(a-1)*x;let g=z;do{const y=c+(g-1)*4;let v=L[y],k=L[y+1],w=L[y+2];v>127&&(v=255-v),k>127&&(k=255-k),w>127&&(w=255-w),L[y]=v,L[y+1]=k,L[y+2]=w}while(--g)}while(--a)};return yi.Solarize=s,yi}var vi={},Zl;function Qc(){if(Zl)return vi;Zl=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Threshold=void 0;const s=Ae(),d=it(),L=ze(),z=function(R){const x=this.threshold()*255,a=R.data,c=a.length;for(let g=0;g<c;g+=1)a[g]=a[g]<x?0:255};return vi.Threshold=z,s.Factory.addGetterSetter(d.Node,"threshold",.5,(0,L.getNumberValidator)(),s.Factory.afterSetFilter),vi}var $l;function Jc(){if($l)return Ir;$l=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Konva=void 0;const s=pa(),d=vc(),L=_c(),z=wc(),R=Sc(),x=Cc(),a=bc(),c=pl(),g=ya(),y=bl(),v=kc(),k=Ec(),w=Pc(),m=Tc(),h=Fl(),S=Rc(),P=Fc(),D=Nc(),u=Ic(),o=Mc(),b=Ac(),I=Lc(),M=zc(),U=Dc(),N=Oc(),A=Gc(),E=Bc(),B=Uc(),q=jc(),l=Hc(),_=Wc(),C=Vc(),O=qc(),W=Yc(),T=Kc(),X=Xc(),Q=Qc();return Ir.Konva=s.Konva.Util._assign(s.Konva,{Arc:d.Arc,Arrow:L.Arrow,Circle:z.Circle,Ellipse:R.Ellipse,Image:x.Image,Label:a.Label,Tag:a.Tag,Line:c.Line,Path:g.Path,Rect:y.Rect,RegularPolygon:v.RegularPolygon,Ring:k.Ring,Sprite:w.Sprite,Star:m.Star,Text:h.Text,TextPath:S.TextPath,Transformer:P.Transformer,Wedge:D.Wedge,Filters:{Blur:u.Blur,Brighten:o.Brighten,Contrast:b.Contrast,Emboss:I.Emboss,Enhance:M.Enhance,Grayscale:U.Grayscale,HSL:N.HSL,HSV:A.HSV,Invert:E.Invert,Kaleidoscope:B.Kaleidoscope,Mask:q.Mask,Noise:l.Noise,Pixelate:_.Pixelate,Posterize:C.Posterize,RGB:O.RGB,RGBA:W.RGBA,Sepia:T.Sepia,Solarize:X.Solarize,Threshold:Q.Threshold}}),Ir}var Zc=Hi.exports,ed;function $c(){if(ed)return Hi.exports;ed=1,Object.defineProperty(Zc,"__esModule",{value:!0});const s=Jc();return Hi.exports=s.Konva,Hi.exports}$c();var qi={exports:{}},td;function eh(){return td||(td=1,function(s,d){Object.defineProperty(d,"__esModule",{value:!0}),d.Konva=void 0;var L=pa();Object.defineProperty(d,"Konva",{enumerable:!0,get:function(){return L.Konva}});const z=pa();s.exports=z.Konva}(qi,qi.exports)),qi.exports}var th=eh();const xi=Ui(th);var va={exports:{}},xa={exports:{}},_a={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nd;function nh(){return nd||(nd=1,function(s){function d(T,X){var Q=T.length;T.push(X);e:for(;0<Q;){var ne=Q-1>>>1,le=T[ne];if(0<R(le,X))T[ne]=X,T[Q]=le,Q=ne;else break e}}function L(T){return T.length===0?null:T[0]}function z(T){if(T.length===0)return null;var X=T[0],Q=T.pop();if(Q!==X){T[0]=Q;e:for(var ne=0,le=T.length,ie=le>>>1;ne<ie;){var oe=2*(ne+1)-1,ge=T[oe],fe=oe+1,H=T[fe];if(0>R(ge,Q))fe<le&&0>R(H,ge)?(T[ne]=H,T[fe]=Q,ne=fe):(T[ne]=ge,T[oe]=Q,ne=oe);else if(fe<le&&0>R(H,Q))T[ne]=H,T[fe]=Q,ne=fe;else break e}}return X}function R(T,X){var Q=T.sortIndex-X.sortIndex;return Q!==0?Q:T.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;s.unstable_now=function(){return x.now()}}else{var a=Date,c=a.now();s.unstable_now=function(){return a.now()-c}}var g=[],y=[],v=1,k=null,w=3,m=!1,h=!1,S=!1,P=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,u=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function o(T){for(var X=L(y);X!==null;){if(X.callback===null)z(y);else if(X.startTime<=T)z(y),X.sortIndex=X.expirationTime,d(g,X);else break;X=L(y)}}function b(T){if(S=!1,o(T),!h)if(L(g)!==null)h=!0,O(I);else{var X=L(y);X!==null&&W(b,X.startTime-T)}}function I(T,X){h=!1,S&&(S=!1,D(N),N=-1),m=!0;var Q=w;try{for(o(X),k=L(g);k!==null&&(!(k.expirationTime>X)||T&&!B());){var ne=k.callback;if(typeof ne=="function"){k.callback=null,w=k.priorityLevel;var le=ne(k.expirationTime<=X);X=s.unstable_now(),typeof le=="function"?k.callback=le:k===L(g)&&z(g),o(X)}else z(g);k=L(g)}if(k!==null)var ie=!0;else{var oe=L(y);oe!==null&&W(b,oe.startTime-X),ie=!1}return ie}finally{k=null,w=Q,m=!1}}var M=!1,U=null,N=-1,A=5,E=-1;function B(){return!(s.unstable_now()-E<A)}function q(){if(U!==null){var T=s.unstable_now();E=T;var X=!0;try{X=U(!0,T)}finally{X?l():(M=!1,U=null)}}else M=!1}var l;if(typeof u=="function")l=function(){u(q)};else if(typeof MessageChannel<"u"){var _=new MessageChannel,C=_.port2;_.port1.onmessage=q,l=function(){C.postMessage(null)}}else l=function(){P(q,0)};function O(T){U=T,M||(M=!0,l())}function W(T,X){N=P(function(){T(s.unstable_now())},X)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(T){T.callback=null},s.unstable_continueExecution=function(){h||m||(h=!0,O(I))},s.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<T?Math.floor(1e3/T):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_getFirstCallbackNode=function(){return L(g)},s.unstable_next=function(T){switch(w){case 1:case 2:case 3:var X=3;break;default:X=w}var Q=w;w=X;try{return T()}finally{w=Q}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(T,X){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var Q=w;w=T;try{return X()}finally{w=Q}},s.unstable_scheduleCallback=function(T,X,Q){var ne=s.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ne+Q:ne):Q=ne,T){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Q+le,T={id:v++,callback:X,priorityLevel:T,startTime:Q,expirationTime:le,sortIndex:-1},Q>ne?(T.sortIndex=Q,d(y,T),L(g)===null&&T===L(y)&&(S?(D(N),N=-1):S=!0,W(b,Q-ne))):(T.sortIndex=le,d(g,T),h||m||(h=!0,O(I))),T},s.unstable_shouldYield=B,s.unstable_wrapCallback=function(T){var X=w;return function(){var Q=w;w=X;try{return T.apply(this,arguments)}finally{w=Q}}}}(_a)),_a}var rd;function id(){return rd||(rd=1,xa.exports=nh()),xa.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wa,sd;function rh(){return sd||(sd=1,wa=function(d){var L={},z=he,R=id(),x=Object.assign;function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,g=Symbol.for("react.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),h=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),o=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),I=Symbol.iterator;function M(e){return e===null||typeof e!="object"?null:(e=I&&e[I]||e["@@iterator"],typeof e=="function"?e:null)}function U(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case v:return"Fragment";case y:return"Portal";case w:return"Profiler";case k:return"StrictMode";case P:return"Suspense";case D:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case h:return(e.displayName||"Context")+".Consumer";case m:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case u:return t=e.displayName||null,t!==null?t:U(e.type)||"Memo";case o:t=e._payload,e=e._init;try{return U(e(t))}catch{}}return null}function N(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function A(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function E(e){if(A(e)!==e)throw Error(a(188))}function B(e){var t=e.alternate;if(!t){if(t=A(e),t===null)throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var f=i.alternate;if(f===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===f.child){for(f=i.child;f;){if(f===n)return E(i),e;if(f===r)return E(i),t;f=f.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=f;else{for(var G=!1,J=i.child;J;){if(J===n){G=!0,n=i,r=f;break}if(J===r){G=!0,r=i,n=f;break}J=J.sibling}if(!G){for(J=f.child;J;){if(J===n){G=!0,n=f,r=i;break}if(J===r){G=!0,r=f,n=i;break}J=J.sibling}if(!G)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(n.tag!==3)throw Error(a(188));return n.stateNode.current===n?e:t}function q(e){return e=B(e),e!==null?l(e):null}function l(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=l(e);if(t!==null)return t;e=e.sibling}return null}function _(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){if(e.tag!==4){var t=_(e);if(t!==null)return t}e=e.sibling}return null}var C=Array.isArray,O=d.getPublicInstance,W=d.getRootHostContext,T=d.getChildHostContext,X=d.prepareForCommit,Q=d.resetAfterCommit,ne=d.createInstance,le=d.appendInitialChild,ie=d.finalizeInitialChildren,oe=d.prepareUpdate,ge=d.shouldSetTextContent,fe=d.createTextInstance,H=d.scheduleTimeout,te=d.cancelTimeout,de=d.noTimeout,ae=d.isPrimaryRenderer,ce=d.supportsMutation,ve=d.supportsPersistence,Ce=d.supportsHydration,Fe=d.getInstanceFromNode,be=d.preparePortalMount,$e=d.getCurrentEventPriority,De=d.detachDeletedInstance,Ue=d.supportsMicrotasks,Mt=d.scheduleMicrotask,dt=d.supportsTestSelectors,Wt=d.findFiberRoot,He=d.getBoundingRect,ut=d.getTextContent,st=d.isHiddenSubtree,Vt=d.matchAccessibilityRole,ht=d.setFocusIfFocusable,Kt=d.setupIntersectionObserver,Ot=d.appendChild,Xt=d.appendChildToContainer,Ie=d.commitTextUpdate,ke=d.commitMount,yt=d.commitUpdate,Et=d.insertBefore,Pt=d.insertInContainerBefore,On=d.removeChild,Si=d.removeChildFromContainer,Xi=d.resetTextContent,Ta=d.hideInstance,Ra=d.hideTextInstance,lr=d.unhideInstance,Qi=d.unhideTextInstance,gn=d.clearContainer,Fa=d.cloneInstance,Ji=d.createContainerChildSet,Ci=d.appendChildToContainerChildSet,Na=d.finalizeContainerChildren,dr=d.replaceContainerChildren,bi=d.cloneHiddenInstance,ur=d.cloneHiddenTextInstance,Zi=d.canHydrateInstance,Ia=d.canHydrateTextInstance,Ma=d.canHydrateSuspenseInstance,$i=d.isSuspenseInstancePending,cr=d.isSuspenseInstanceFallback,Aa=d.getSuspenseInstanceFallbackErrorDetails,es=d.registerSuspenseInstanceRetry,hr=d.getNextHydratableSibling,ts=d.getFirstHydratableChild,ns=d.getFirstHydratableChildWithinContainer,rs=d.getFirstHydratableChildWithinSuspenseInstance,is=d.hydrateInstance,ss=d.hydrateTextInstance,as=d.hydrateSuspenseInstance,os=d.getNextHydratableInstanceAfterSuspenseInstance,ls=d.commitHydratedContainer,ds=d.commitHydratedSuspenseInstance,us=d.clearSuspenseBoundary,cs=d.clearSuspenseBoundaryFromContainer,hs=d.shouldDeleteUnhydratedTailInstances,fs=d.didNotMatchHydratedContainerTextInstance,gs=d.didNotMatchHydratedTextInstance,fr;function Gn(e){if(fr===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);fr=t&&t[1]||""}return`
`+fr+e}var gr=!1;function pr(e,t){if(!e||gr)return"";gr=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(ue){var r=ue}Reflect.construct(e,[],t)}else{try{t.call()}catch(ue){r=ue}e.call(t.prototype)}else{try{throw Error()}catch(ue){r=ue}e()}}catch(ue){if(ue&&r&&typeof ue.stack=="string"){for(var i=ue.stack.split(`
`),f=r.stack.split(`
`),G=i.length-1,J=f.length-1;1<=G&&0<=J&&i[G]!==f[J];)J--;for(;1<=G&&0<=J;G--,J--)if(i[G]!==f[J]){if(G!==1||J!==1)do if(G--,J--,0>J||i[G]!==f[J]){var ee=`
`+i[G].replace(" at new "," at ");return e.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",e.displayName)),ee}while(1<=G&&0<=J);break}}}finally{gr=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Gn(e):""}var ps=Object.prototype.hasOwnProperty,mr=[],Pn=-1;function sn(e){return{current:e}}function We(e){0>Pn||(e.current=mr[Pn],mr[Pn]=null,Pn--)}function je(e,t){Pn++,mr[Pn]=e.current,e.current=t}var an={},ft=sn(an),St=sn(!1),pn=an;function p(e,t){var n=e.type.contextTypes;if(!n)return an;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},f;for(f in n)i[f]=t[f];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function F(e){return e=e.childContextTypes,e!=null}function j(){We(St),We(ft)}function V(e,t,n){if(ft.current!==an)throw Error(a(168));je(ft,t),je(St,n)}function Y(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(a(108,N(e)||"Unknown",i));return x({},n,r)}function re(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||an,pn=ft.current,je(ft,e),je(St,St.current),!0}function pe(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Y(e,t,pn),r.__reactInternalMemoizedMergedChildContext=e,We(St),We(ft),je(ft,e)):We(St),je(St,n)}var we=Math.clz32?Math.clz32:Ne,Ke=Math.log,Ve=Math.LN2;function Ne(e){return e>>>=0,e===0?32:31-(Ke(e)/Ve|0)|0}var Le=64,rt=4194304;function qe(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function on(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,f=e.pingedLanes,G=n&268435455;if(G!==0){var J=G&~i;J!==0?r=qe(J):(f&=G,f!==0&&(r=qe(f)))}else G=n&~i,G!==0?r=qe(G):f!==0&&(r=qe(f));if(r===0)return 0;if(t!==0&&t!==r&&(t&i)===0&&(i=r&-r,f=t&-t,i>=f||i===16&&(f&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-we(t),i=1<<n,r|=e[n],t&=~i;return r}function At(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function at(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,f=e.pendingLanes;0<f;){var G=31-we(f),J=1<<G,ee=i[G];ee===-1?((J&n)===0||(J&r)!==0)&&(i[G]=At(J,t)):ee<=t&&(e.expiredLanes|=J),f&=~J}}function Qe(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ct(){var e=Le;return Le<<=1,(Le&4194240)===0&&(Le=64),e}function Tt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ot(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-we(t),e[t]=n}function yr(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-we(n),f=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~f}}function Bn(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-we(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Oe=0;function Md(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var La=R.unstable_scheduleCallback,Ad=R.unstable_cancelCallback,_f=R.unstable_shouldYield,wf=R.unstable_requestPaint,vt=R.unstable_now,za=R.unstable_ImmediatePriority,Sf=R.unstable_UserBlockingPriority,Da=R.unstable_NormalPriority,Cf=R.unstable_IdlePriority,ms=null,mn=null;function bf(e){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(ms,e,void 0,(e.current.flags&128)===128)}catch{}}function kf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ln=typeof Object.is=="function"?Object.is:kf,Tn=null,ys=!1,Oa=!1;function Ld(e){Tn===null?Tn=[e]:Tn.push(e)}function Ef(e){ys=!0,Ld(e)}function yn(){if(!Oa&&Tn!==null){Oa=!0;var e=0,t=Oe;try{var n=Tn;for(Oe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Tn=null,ys=!1}catch(i){throw Tn!==null&&(Tn=Tn.slice(e+1)),La(za,yn),i}finally{Oe=t,Oa=!1}}return null}var vr=[],xr=0,vs=null,xs=0,Qt=[],Jt=0,Jn=null,Rn=1,Fn="";function Zn(e,t){vr[xr++]=xs,vr[xr++]=vs,vs=e,xs=t}function zd(e,t,n){Qt[Jt++]=Rn,Qt[Jt++]=Fn,Qt[Jt++]=Jn,Jn=e;var r=Rn;e=Fn;var i=32-we(r)-1;r&=~(1<<i),n+=1;var f=32-we(t)+i;if(30<f){var G=i-i%5;f=(r&(1<<G)-1).toString(32),r>>=G,i-=G,Rn=1<<32-we(t)+i|n<<i|r,Fn=f+e}else Rn=1<<f|n<<i|r,Fn=e}function Ga(e){e.return!==null&&(Zn(e,1),zd(e,1,0))}function Ba(e){for(;e===vs;)vs=vr[--xr],vr[xr]=null,xs=vr[--xr],vr[xr]=null;for(;e===Jn;)Jn=Qt[--Jt],Qt[Jt]=null,Fn=Qt[--Jt],Qt[Jt]=null,Rn=Qt[--Jt],Qt[Jt]=null}var qt=null,Zt=null,Je=!1,ki=!1,dn=null;function Dd(e,t){var n=rn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Od(e,t){switch(e.tag){case 5:return t=Zi(t,e.type,e.pendingProps),t!==null?(e.stateNode=t,qt=e,Zt=ts(t),!0):!1;case 6:return t=Ia(t,e.pendingProps),t!==null?(e.stateNode=t,qt=e,Zt=null,!0):!1;case 13:if(t=Ma(t),t!==null){var n=Jn!==null?{id:Rn,overflow:Fn}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=rn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,qt=e,Zt=null,!0}return!1;default:return!1}}function Ua(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ja(e){if(Je){var t=Zt;if(t){var n=t;if(!Od(e,t)){if(Ua(e))throw Error(a(418));t=hr(n);var r=qt;t&&Od(e,t)?Dd(r,n):(e.flags=e.flags&-4097|2,Je=!1,qt=e)}}else{if(Ua(e))throw Error(a(418));e.flags=e.flags&-4097|2,Je=!1,qt=e}}}function Gd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qt=e}function _s(e){if(!Ce||e!==qt)return!1;if(!Je)return Gd(e),Je=!0,!1;if(e.tag!==3&&(e.tag!==5||hs(e.type)&&!ge(e.type,e.memoizedProps))){var t=Zt;if(t){if(Ua(e))throw Bd(),Error(a(418));for(;t;)Dd(e,t),t=hr(t)}}if(Gd(e),e.tag===13){if(!Ce)throw Error(a(316));if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Zt=os(e)}else Zt=qt?hr(e.stateNode):null;return!0}function Bd(){for(var e=Zt;e;)e=hr(e)}function _r(){Ce&&(Zt=qt=null,ki=Je=!1)}function Ha(e){dn===null?dn=[e]:dn.push(e)}var Pf=c.ReactCurrentBatchConfig;function ws(e,t){if(ln(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ps.call(t,i)||!ln(e[i],t[i]))return!1}return!0}function Tf(e){switch(e.tag){case 5:return Gn(e.type);case 16:return Gn("Lazy");case 13:return Gn("Suspense");case 19:return Gn("SuspenseList");case 0:case 2:case 15:return e=pr(e.type,!1),e;case 11:return e=pr(e.type.render,!1),e;case 1:return e=pr(e.type,!0),e;default:return""}}function Ei(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,f=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===f?t.ref:(t=function(G){var J=i.refs;G===null?delete J[f]:J[f]=G},t._stringRef=f,t)}if(typeof e!="string")throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ss(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ud(e){var t=e._init;return t(e._payload)}function jd(e){function t($,Z){if(e){var se=$.deletions;se===null?($.deletions=[Z],$.flags|=16):se.push(Z)}}function n($,Z){if(!e)return null;for(;Z!==null;)t($,Z),Z=Z.sibling;return null}function r($,Z){for($=new Map;Z!==null;)Z.key!==null?$.set(Z.key,Z):$.set(Z.index,Z),Z=Z.sibling;return $}function i($,Z){return $=Yn($,Z),$.index=0,$.sibling=null,$}function f($,Z,se){return $.index=se,e?(se=$.alternate,se!==null?(se=se.index,se<Z?($.flags|=2,Z):se):($.flags|=2,Z)):($.flags|=1048576,Z)}function G($){return e&&$.alternate===null&&($.flags|=2),$}function J($,Z,se,ye){return Z===null||Z.tag!==6?(Z=Go(se,$.mode,ye),Z.return=$,Z):(Z=i(Z,se),Z.return=$,Z)}function ee($,Z,se,ye){var Se=se.type;return Se===v?_e($,Z,se.props.children,ye,se.key):Z!==null&&(Z.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===o&&Ud(Se)===Z.type)?(ye=i(Z,se.props),ye.ref=Ei($,Z,se),ye.return=$,ye):(ye=$s(se.type,se.key,se.props,null,$.mode,ye),ye.ref=Ei($,Z,se),ye.return=$,ye)}function ue($,Z,se,ye){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==se.containerInfo||Z.stateNode.implementation!==se.implementation?(Z=Bo(se,$.mode,ye),Z.return=$,Z):(Z=i(Z,se.children||[]),Z.return=$,Z)}function _e($,Z,se,ye,Se){return Z===null||Z.tag!==7?(Z=sr(se,$.mode,ye,Se),Z.return=$,Z):(Z=i(Z,se),Z.return=$,Z)}function Ee($,Z,se){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=Go(""+Z,$.mode,se),Z.return=$,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case g:return se=$s(Z.type,Z.key,Z.props,null,$.mode,se),se.ref=Ei($,null,Z),se.return=$,se;case y:return Z=Bo(Z,$.mode,se),Z.return=$,Z;case o:var ye=Z._init;return Ee($,ye(Z._payload),se)}if(C(Z)||M(Z))return Z=sr(Z,$.mode,se,null),Z.return=$,Z;Ss($,Z)}return null}function me($,Z,se,ye){var Se=Z!==null?Z.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Se!==null?null:J($,Z,""+se,ye);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case g:return se.key===Se?ee($,Z,se,ye):null;case y:return se.key===Se?ue($,Z,se,ye):null;case o:return Se=se._init,me($,Z,Se(se._payload),ye)}if(C(se)||M(se))return Se!==null?null:_e($,Z,se,ye,null);Ss($,se)}return null}function Xe($,Z,se,ye,Se){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return $=$.get(se)||null,J(Z,$,""+ye,Se);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case g:return $=$.get(ye.key===null?se:ye.key)||null,ee(Z,$,ye,Se);case y:return $=$.get(ye.key===null?se:ye.key)||null,ue(Z,$,ye,Se);case o:var Te=ye._init;return Xe($,Z,se,Te(ye._payload),Se)}if(C(ye)||M(ye))return $=$.get(se)||null,_e(Z,$,ye,Se,null);Ss(Z,ye)}return null}function Ye($,Z,se,ye){for(var Se=null,Te=null,Pe=Z,Ge=Z=0,wt=null;Pe!==null&&Ge<se.length;Ge++){Pe.index>Ge?(wt=Pe,Pe=null):wt=Pe.sibling;var Be=me($,Pe,se[Ge],ye);if(Be===null){Pe===null&&(Pe=wt);break}e&&Pe&&Be.alternate===null&&t($,Pe),Z=f(Be,Z,Ge),Te===null?Se=Be:Te.sibling=Be,Te=Be,Pe=wt}if(Ge===se.length)return n($,Pe),Je&&Zn($,Ge),Se;if(Pe===null){for(;Ge<se.length;Ge++)Pe=Ee($,se[Ge],ye),Pe!==null&&(Z=f(Pe,Z,Ge),Te===null?Se=Pe:Te.sibling=Pe,Te=Pe);return Je&&Zn($,Ge),Se}for(Pe=r($,Pe);Ge<se.length;Ge++)wt=Xe(Pe,$,Ge,se[Ge],ye),wt!==null&&(e&&wt.alternate!==null&&Pe.delete(wt.key===null?Ge:wt.key),Z=f(wt,Z,Ge),Te===null?Se=wt:Te.sibling=wt,Te=wt);return e&&Pe.forEach(function(Kn){return t($,Kn)}),Je&&Zn($,Ge),Se}function jt($,Z,se,ye){var Se=M(se);if(typeof Se!="function")throw Error(a(150));if(se=Se.call(se),se==null)throw Error(a(151));for(var Te=Se=null,Pe=Z,Ge=Z=0,wt=null,Be=se.next();Pe!==null&&!Be.done;Ge++,Be=se.next()){Pe.index>Ge?(wt=Pe,Pe=null):wt=Pe.sibling;var Kn=me($,Pe,Be.value,ye);if(Kn===null){Pe===null&&(Pe=wt);break}e&&Pe&&Kn.alternate===null&&t($,Pe),Z=f(Kn,Z,Ge),Te===null?Se=Kn:Te.sibling=Kn,Te=Kn,Pe=wt}if(Be.done)return n($,Pe),Je&&Zn($,Ge),Se;if(Pe===null){for(;!Be.done;Ge++,Be=se.next())Be=Ee($,Be.value,ye),Be!==null&&(Z=f(Be,Z,Ge),Te===null?Se=Be:Te.sibling=Be,Te=Be);return Je&&Zn($,Ge),Se}for(Pe=r($,Pe);!Be.done;Ge++,Be=se.next())Be=Xe(Pe,$,Ge,Be.value,ye),Be!==null&&(e&&Be.alternate!==null&&Pe.delete(Be.key===null?Ge:Be.key),Z=f(Be,Z,Ge),Te===null?Se=Be:Te.sibling=Be,Te=Be);return e&&Pe.forEach(function(i0){return t($,i0)}),Je&&Zn($,Ge),Se}function An($,Z,se,ye){if(typeof se=="object"&&se!==null&&se.type===v&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case g:e:{for(var Se=se.key,Te=Z;Te!==null;){if(Te.key===Se){if(Se=se.type,Se===v){if(Te.tag===7){n($,Te.sibling),Z=i(Te,se.props.children),Z.return=$,$=Z;break e}}else if(Te.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===o&&Ud(Se)===Te.type){n($,Te.sibling),Z=i(Te,se.props),Z.ref=Ei($,Te,se),Z.return=$,$=Z;break e}n($,Te);break}else t($,Te);Te=Te.sibling}se.type===v?(Z=sr(se.props.children,$.mode,ye,se.key),Z.return=$,$=Z):(ye=$s(se.type,se.key,se.props,null,$.mode,ye),ye.ref=Ei($,Z,se),ye.return=$,$=ye)}return G($);case y:e:{for(Te=se.key;Z!==null;){if(Z.key===Te)if(Z.tag===4&&Z.stateNode.containerInfo===se.containerInfo&&Z.stateNode.implementation===se.implementation){n($,Z.sibling),Z=i(Z,se.children||[]),Z.return=$,$=Z;break e}else{n($,Z);break}else t($,Z);Z=Z.sibling}Z=Bo(se,$.mode,ye),Z.return=$,$=Z}return G($);case o:return Te=se._init,An($,Z,Te(se._payload),ye)}if(C(se))return Ye($,Z,se,ye);if(M(se))return jt($,Z,se,ye);Ss($,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,Z!==null&&Z.tag===6?(n($,Z.sibling),Z=i(Z,se),Z.return=$,$=Z):(n($,Z),Z=Go(se,$.mode,ye),Z.return=$,$=Z),G($)):n($,Z)}return An}var wr=jd(!0),Hd=jd(!1),Cs=sn(null),bs=null,Sr=null,Wa=null;function Va(){Wa=Sr=bs=null}function Wd(e,t,n){ae?(je(Cs,t._currentValue),t._currentValue=n):(je(Cs,t._currentValue2),t._currentValue2=n)}function qa(e){var t=Cs.current;We(Cs),ae?e._currentValue=t:e._currentValue2=t}function Ya(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Cr(e,t){bs=e,Wa=Sr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Gt=!0),e.firstContext=null)}function $t(e){var t=ae?e._currentValue:e._currentValue2;if(Wa!==e)if(e={context:e,memoizedValue:t,next:null},Sr===null){if(bs===null)throw Error(a(308));Sr=e,bs.dependencies={lanes:0,firstContext:e}}else Sr=Sr.next=e;return t}var $n=null;function Ka(e){$n===null?$n=[e]:$n.push(e)}function Vd(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Ka(t)):(n.next=i.next,i.next=n),t.interleaved=n,vn(e,r)}function vn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Un=!1;function Xa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function jn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(Me&2)!==0){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,vn(e,n)}return i=r.interleaved,i===null?(t.next=t,Ka(r)):(t.next=i.next,i.next=t),r.interleaved=t,vn(e,n)}function ks(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Bn(e,n)}}function Yd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var G={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};f===null?i=f=G:f=f.next=G,n=n.next}while(n!==null);f===null?i=f=t:f=f.next=t}else i=f=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:f,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Es(e,t,n,r){var i=e.updateQueue;Un=!1;var f=i.firstBaseUpdate,G=i.lastBaseUpdate,J=i.shared.pending;if(J!==null){i.shared.pending=null;var ee=J,ue=ee.next;ee.next=null,G===null?f=ue:G.next=ue,G=ee;var _e=e.alternate;_e!==null&&(_e=_e.updateQueue,J=_e.lastBaseUpdate,J!==G&&(J===null?_e.firstBaseUpdate=ue:J.next=ue,_e.lastBaseUpdate=ee))}if(f!==null){var Ee=i.baseState;G=0,_e=ue=ee=null,J=f;do{var me=J.lane,Xe=J.eventTime;if((r&me)===me){_e!==null&&(_e=_e.next={eventTime:Xe,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var Ye=e,jt=J;switch(me=t,Xe=n,jt.tag){case 1:if(Ye=jt.payload,typeof Ye=="function"){Ee=Ye.call(Xe,Ee,me);break e}Ee=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=jt.payload,me=typeof Ye=="function"?Ye.call(Xe,Ee,me):Ye,me==null)break e;Ee=x({},Ee,me);break e;case 2:Un=!0}}J.callback!==null&&J.lane!==0&&(e.flags|=64,me=i.effects,me===null?i.effects=[J]:me.push(J))}else Xe={eventTime:Xe,lane:me,tag:J.tag,payload:J.payload,callback:J.callback,next:null},_e===null?(ue=_e=Xe,ee=Ee):_e=_e.next=Xe,G|=me;if(J=J.next,J===null){if(J=i.shared.pending,J===null)break;me=J,J=me.next,me.next=null,i.lastBaseUpdate=me,i.shared.pending=null}}while(!0);if(_e===null&&(ee=Ee),i.baseState=ee,i.firstBaseUpdate=ue,i.lastBaseUpdate=_e,t=i.shared.interleaved,t!==null){i=t;do G|=i.lane,i=i.next;while(i!==t)}else f===null&&(i.shared.lanes=0);tr|=G,e.lanes=G,e.memoizedState=Ee}}function Kd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(a(191,i));i.call(r)}}}var Pi={},en=sn(Pi),Ti=sn(Pi),br=sn(Pi);function xn(e){if(e===Pi)throw Error(a(174));return e}function Qa(e,t){je(br,t),je(Ti,e),je(en,Pi),e=W(t),We(en),je(en,e)}function kr(){We(en),We(Ti),We(br)}function Xd(e){var t=xn(br.current),n=xn(en.current);t=T(n,e.type,t),n!==t&&(je(Ti,e),je(en,t))}function Ja(e){Ti.current===e&&(We(en),We(Ti))}var et=sn(0);function Ps(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||$i(n)||cr(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Za=[];function $a(){for(var e=0;e<Za.length;e++){var t=Za[e];ae?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}Za.length=0}var Ts=c.ReactCurrentDispatcher,eo=c.ReactCurrentBatchConfig,er=0,tt=null,gt=null,xt=null,Rs=!1,Ri=!1,Fi=0,Rf=0;function Rt(){throw Error(a(321))}function to(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ln(e[n],t[n]))return!1;return!0}function no(e,t,n,r,i,f){if(er=f,tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ts.current=e===null||e.memoizedState===null?Mf:Af,e=n(r,i),Ri){f=0;do{if(Ri=!1,Fi=0,25<=f)throw Error(a(301));f+=1,xt=gt=null,t.updateQueue=null,Ts.current=Lf,e=n(r,i)}while(Ri)}if(Ts.current=Is,t=gt!==null&&gt.next!==null,er=0,xt=gt=tt=null,Rs=!1,t)throw Error(a(300));return e}function ro(){var e=Fi!==0;return Fi=0,e}function _n(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?tt.memoizedState=xt=e:xt=xt.next=e,xt}function tn(){if(gt===null){var e=tt.alternate;e=e!==null?e.memoizedState:null}else e=gt.next;var t=xt===null?tt.memoizedState:xt.next;if(t!==null)xt=t,gt=e;else{if(e===null)throw Error(a(310));gt=e,e={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},xt===null?tt.memoizedState=xt=e:xt=xt.next=e}return xt}function Ni(e,t){return typeof t=="function"?t(e):t}function io(e){var t=tn(),n=t.queue;if(n===null)throw Error(a(311));n.lastRenderedReducer=e;var r=gt,i=r.baseQueue,f=n.pending;if(f!==null){if(i!==null){var G=i.next;i.next=f.next,f.next=G}r.baseQueue=i=f,n.pending=null}if(i!==null){f=i.next,r=r.baseState;var J=G=null,ee=null,ue=f;do{var _e=ue.lane;if((er&_e)===_e)ee!==null&&(ee=ee.next={lane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),r=ue.hasEagerState?ue.eagerState:e(r,ue.action);else{var Ee={lane:_e,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null};ee===null?(J=ee=Ee,G=r):ee=ee.next=Ee,tt.lanes|=_e,tr|=_e}ue=ue.next}while(ue!==null&&ue!==f);ee===null?G=r:ee.next=J,ln(r,t.memoizedState)||(Gt=!0),t.memoizedState=r,t.baseState=G,t.baseQueue=ee,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do f=i.lane,tt.lanes|=f,tr|=f,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function so(e){var t=tn(),n=t.queue;if(n===null)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,f=t.memoizedState;if(i!==null){n.pending=null;var G=i=i.next;do f=e(f,G.action),G=G.next;while(G!==i);ln(f,t.memoizedState)||(Gt=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,r]}function Qd(){}function Jd(e,t){var n=tt,r=tn(),i=t(),f=!ln(r.memoizedState,i);if(f&&(r.memoizedState=i,Gt=!0),r=r.queue,ao(eu.bind(null,n,r,e),[e]),r.getSnapshot!==t||f||xt!==null&&xt.memoizedState.tag&1){if(n.flags|=2048,Ii(9,$d.bind(null,n,r,i,t),void 0,null),_t===null)throw Error(a(349));(er&30)!==0||Zd(n,t,i)}return i}function Zd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=tt.updateQueue,t===null?(t={lastEffect:null,stores:null},tt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $d(e,t,n,r){t.value=n,t.getSnapshot=r,tu(t)&&nu(e)}function eu(e,t,n){return n(function(){tu(t)&&nu(e)})}function tu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ln(e,n)}catch{return!0}}function nu(e){var t=vn(e,1);t!==null&&nn(t,e,1,-1)}function ru(e){var t=_n();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:e},t.queue=e,e=e.dispatch=If.bind(null,tt,e),[t.memoizedState,e]}function Ii(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=tt.updateQueue,t===null?(t={lastEffect:null,stores:null},tt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function iu(){return tn().memoizedState}function Fs(e,t,n,r){var i=_n();tt.flags|=e,i.memoizedState=Ii(1|t,n,void 0,r===void 0?null:r)}function Ns(e,t,n,r){var i=tn();r=r===void 0?null:r;var f=void 0;if(gt!==null){var G=gt.memoizedState;if(f=G.destroy,r!==null&&to(r,G.deps)){i.memoizedState=Ii(t,n,f,r);return}}tt.flags|=e,i.memoizedState=Ii(1|t,n,f,r)}function su(e,t){return Fs(8390656,8,e,t)}function ao(e,t){return Ns(2048,8,e,t)}function au(e,t){return Ns(4,2,e,t)}function ou(e,t){return Ns(4,4,e,t)}function lu(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function du(e,t,n){return n=n!=null?n.concat([e]):null,Ns(4,4,lu.bind(null,t,e),n)}function oo(){}function uu(e,t){var n=tn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&to(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function cu(e,t){var n=tn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&to(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function hu(e,t,n){return(er&21)===0?(e.baseState&&(e.baseState=!1,Gt=!0),e.memoizedState=n):(ln(n,t)||(n=Ct(),tt.lanes|=n,tr|=n,e.baseState=!0),t)}function Ff(e,t){var n=Oe;Oe=n!==0&&4>n?n:4,e(!0);var r=eo.transition;eo.transition={};try{e(!1),t()}finally{Oe=n,eo.transition=r}}function fu(){return tn().memoizedState}function Nf(e,t,n){var r=Vn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gu(e))pu(t,n);else if(n=Vd(e,t,n,r),n!==null){var i=It();nn(n,e,r,i),mu(n,t,r)}}function If(e,t,n){var r=Vn(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gu(e))pu(t,i);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var G=t.lastRenderedState,J=f(G,n);if(i.hasEagerState=!0,i.eagerState=J,ln(J,G)){var ee=t.interleaved;ee===null?(i.next=i,Ka(t)):(i.next=ee.next,ee.next=i),t.interleaved=i;return}}catch{}finally{}n=Vd(e,t,i,r),n!==null&&(i=It(),nn(n,e,r,i),mu(n,t,r))}}function gu(e){var t=e.alternate;return e===tt||t!==null&&t===tt}function pu(e,t){Ri=Rs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function mu(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Bn(e,n)}}var Is={readContext:$t,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},Mf={readContext:$t,useCallback:function(e,t){return _n().memoizedState=[e,t===void 0?null:t],e},useContext:$t,useEffect:su,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Fs(4194308,4,lu.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fs(4,2,e,t)},useMemo:function(e,t){var n=_n();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_n();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Nf.bind(null,tt,e),[r.memoizedState,e]},useRef:function(e){var t=_n();return e={current:e},t.memoizedState=e},useState:ru,useDebugValue:oo,useDeferredValue:function(e){return _n().memoizedState=e},useTransition:function(){var e=ru(!1),t=e[0];return e=Ff.bind(null,e[1]),_n().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=tt,i=_n();if(Je){if(n===void 0)throw Error(a(407));n=n()}else{if(n=t(),_t===null)throw Error(a(349));(er&30)!==0||Zd(r,t,n)}i.memoizedState=n;var f={value:n,getSnapshot:t};return i.queue=f,su(eu.bind(null,r,f,e),[e]),r.flags|=2048,Ii(9,$d.bind(null,r,f,n,t),void 0,null),n},useId:function(){var e=_n(),t=_t.identifierPrefix;if(Je){var n=Fn,r=Rn;n=(r&~(1<<32-we(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Fi++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Rf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Af={readContext:$t,useCallback:uu,useContext:$t,useEffect:ao,useImperativeHandle:du,useInsertionEffect:au,useLayoutEffect:ou,useMemo:cu,useReducer:io,useRef:iu,useState:function(){return io(Ni)},useDebugValue:oo,useDeferredValue:function(e){var t=tn();return hu(t,gt.memoizedState,e)},useTransition:function(){var e=io(Ni)[0],t=tn().memoizedState;return[e,t]},useMutableSource:Qd,useSyncExternalStore:Jd,useId:fu,unstable_isNewReconciler:!1},Lf={readContext:$t,useCallback:uu,useContext:$t,useEffect:ao,useImperativeHandle:du,useInsertionEffect:au,useLayoutEffect:ou,useMemo:cu,useReducer:so,useRef:iu,useState:function(){return so(Ni)},useDebugValue:oo,useDeferredValue:function(e){var t=tn();return gt===null?t.memoizedState=e:hu(t,gt.memoizedState,e)},useTransition:function(){var e=so(Ni)[0],t=tn().memoizedState;return[e,t]},useMutableSource:Qd,useSyncExternalStore:Jd,useId:fu,unstable_isNewReconciler:!1};function un(e,t){if(e&&e.defaultProps){t=x({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function lo(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ms={isMounted:function(e){return(e=e._reactInternals)?A(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=It(),i=Vn(e),f=Nn(r,i);f.payload=t,n!=null&&(f.callback=n),t=jn(e,f,i),t!==null&&(nn(t,e,i,r),ks(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=It(),i=Vn(e),f=Nn(r,i);f.tag=1,f.payload=t,n!=null&&(f.callback=n),t=jn(e,f,i),t!==null&&(nn(t,e,i,r),ks(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=It(),r=Vn(e),i=Nn(n,r);i.tag=2,t!=null&&(i.callback=t),t=jn(e,i,r),t!==null&&(nn(t,e,r,n),ks(t,e,r))}};function yu(e,t,n,r,i,f,G){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,f,G):t.prototype&&t.prototype.isPureReactComponent?!ws(n,r)||!ws(i,f):!0}function vu(e,t,n){var r=!1,i=an,f=t.contextType;return typeof f=="object"&&f!==null?f=$t(f):(i=F(t)?pn:ft.current,r=t.contextTypes,f=(r=r!=null)?p(e,i):an),t=new t(n,f),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ms,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=f),t}function xu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ms.enqueueReplaceState(t,t.state,null)}function uo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Xa(e);var f=t.contextType;typeof f=="object"&&f!==null?i.context=$t(f):(f=F(t)?pn:ft.current,i.context=p(e,f)),i.state=e.memoizedState,f=t.getDerivedStateFromProps,typeof f=="function"&&(lo(e,t,f,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Ms.enqueueReplaceState(i,i.state,null),Es(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Er(e,t){try{var n="",r=t;do n+=Tf(r),r=r.return;while(r);var i=n}catch(f){i=`
Error generating stack: `+f.message+`
`+f.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var zf=typeof WeakMap=="function"?WeakMap:Map;function _u(e,t,n){n=Nn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ys||(Ys=!0,Io=r),ho(e,t)},n}function wu(e,t,n){n=Nn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(e,t)}}var f=e.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(n.callback=function(){ho(e,t),typeof r!="function"&&(Hn===null?Hn=new Set([this]):Hn.add(this));var G=t.stack;this.componentDidCatch(t.value,{componentStack:G!==null?G:""})}),n}function Su(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new zf;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Qf.bind(null,e,t,n),t.then(e,e))}function Cu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bu(e,t,n,r,i){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Nn(-1,1),t.tag=2,jn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var Df=c.ReactCurrentOwner,Gt=!1;function Lt(e,t,n,r){t.child=e===null?Hd(t,null,n,r):wr(t,e.child,n,r)}function ku(e,t,n,r,i){n=n.render;var f=t.ref;return Cr(t,i),r=no(e,t,n,r,f,i),n=ro(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,In(e,t,i)):(Je&&n&&Ga(t),t.flags|=1,Lt(e,t,r,i),t.child)}function Eu(e,t,n,r,i){if(e===null){var f=n.type;return typeof f=="function"&&!Oo(f)&&f.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=f,Pu(e,t,f,r,i)):(e=$s(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,(e.lanes&i)===0){var G=f.memoizedProps;if(n=n.compare,n=n!==null?n:ws,n(G,r)&&e.ref===t.ref)return In(e,t,i)}return t.flags|=1,e=Yn(f,r),e.ref=t.ref,e.return=t,t.child=e}function Pu(e,t,n,r,i){if(e!==null){var f=e.memoizedProps;if(ws(f,r)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=r=f,(e.lanes&i)!==0)(e.flags&131072)!==0&&(Gt=!0);else return t.lanes=e.lanes,In(e,t,i)}return fo(e,t,n,r,i)}function Tu(e,t,n){var r=t.pendingProps,i=r.children,f=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(Tr,Yt),Yt|=n;else{if((n&1073741824)===0)return e=f!==null?f.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,je(Tr,Yt),Yt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=f!==null?f.baseLanes:n,je(Tr,Yt),Yt|=r}else f!==null?(r=f.baseLanes|n,t.memoizedState=null):r=n,je(Tr,Yt),Yt|=r;return Lt(e,t,i,n),t.child}function Ru(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function fo(e,t,n,r,i){var f=F(n)?pn:ft.current;return f=p(t,f),Cr(t,i),n=no(e,t,n,r,f,i),r=ro(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,In(e,t,i)):(Je&&r&&Ga(t),t.flags|=1,Lt(e,t,n,i),t.child)}function Fu(e,t,n,r,i){if(F(n)){var f=!0;re(t)}else f=!1;if(Cr(t,i),t.stateNode===null)Ls(e,t),vu(t,n,r),uo(t,n,r,i),r=!0;else if(e===null){var G=t.stateNode,J=t.memoizedProps;G.props=J;var ee=G.context,ue=n.contextType;typeof ue=="object"&&ue!==null?ue=$t(ue):(ue=F(n)?pn:ft.current,ue=p(t,ue));var _e=n.getDerivedStateFromProps,Ee=typeof _e=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ee||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(J!==r||ee!==ue)&&xu(t,G,r,ue),Un=!1;var me=t.memoizedState;G.state=me,Es(t,r,G,i),ee=t.memoizedState,J!==r||me!==ee||St.current||Un?(typeof _e=="function"&&(lo(t,n,_e,r),ee=t.memoizedState),(J=Un||yu(t,n,J,r,me,ee,ue))?(Ee||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(t.flags|=4194308)):(typeof G.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=ee),G.props=r,G.state=ee,G.context=ue,r=J):(typeof G.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{G=t.stateNode,qd(e,t),J=t.memoizedProps,ue=t.type===t.elementType?J:un(t.type,J),G.props=ue,Ee=t.pendingProps,me=G.context,ee=n.contextType,typeof ee=="object"&&ee!==null?ee=$t(ee):(ee=F(n)?pn:ft.current,ee=p(t,ee));var Xe=n.getDerivedStateFromProps;(_e=typeof Xe=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(J!==Ee||me!==ee)&&xu(t,G,r,ee),Un=!1,me=t.memoizedState,G.state=me,Es(t,r,G,i);var Ye=t.memoizedState;J!==Ee||me!==Ye||St.current||Un?(typeof Xe=="function"&&(lo(t,n,Xe,r),Ye=t.memoizedState),(ue=Un||yu(t,n,ue,r,me,Ye,ee)||!1)?(_e||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(r,Ye,ee),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(r,Ye,ee)),typeof G.componentDidUpdate=="function"&&(t.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof G.componentDidUpdate!="function"||J===e.memoizedProps&&me===e.memoizedState||(t.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||J===e.memoizedProps&&me===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=Ye),G.props=r,G.state=Ye,G.context=ee,r=ue):(typeof G.componentDidUpdate!="function"||J===e.memoizedProps&&me===e.memoizedState||(t.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||J===e.memoizedProps&&me===e.memoizedState||(t.flags|=1024),r=!1)}return go(e,t,n,r,f,i)}function go(e,t,n,r,i,f){Ru(e,t);var G=(t.flags&128)!==0;if(!r&&!G)return i&&pe(t,n,!1),In(e,t,f);r=t.stateNode,Df.current=t;var J=G&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&G?(t.child=wr(t,e.child,null,f),t.child=wr(t,null,J,f)):Lt(e,t,J,f),t.memoizedState=r.state,i&&pe(t,n,!0),t.child}function Nu(e){var t=e.stateNode;t.pendingContext?V(e,t.pendingContext,t.pendingContext!==t.context):t.context&&V(e,t.context,!1),Qa(e,t.containerInfo)}function Iu(e,t,n,r,i){return _r(),Ha(i),t.flags|=256,Lt(e,t,n,r),t.child}var po={dehydrated:null,treeContext:null,retryLane:0};function mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mu(e,t,n){var r=t.pendingProps,i=et.current,f=!1,G=(t.flags&128)!==0,J;if((J=G)||(J=e!==null&&e.memoizedState===null?!1:(i&2)!==0),J?(f=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),je(et,i&1),e===null)return ja(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:cr(e)?t.lanes=8:t.lanes=1073741824,null):(G=r.children,e=r.fallback,f?(r=t.mode,f=t.child,G={mode:"hidden",children:G},(r&1)===0&&f!==null?(f.childLanes=0,f.pendingProps=G):f=ea(G,r,0,null),e=sr(e,r,n,null),f.return=t,e.return=t,f.sibling=e,t.child=f,t.child.memoizedState=mo(n),t.memoizedState=po,e):yo(t,G));if(i=e.memoizedState,i!==null&&(J=i.dehydrated,J!==null))return Of(e,t,G,r,J,i,n);if(f){f=r.fallback,G=t.mode,i=e.child,J=i.sibling;var ee={mode:"hidden",children:r.children};return(G&1)===0&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=ee,t.deletions=null):(r=Yn(i,ee),r.subtreeFlags=i.subtreeFlags&14680064),J!==null?f=Yn(J,f):(f=sr(f,G,n,null),f.flags|=2),f.return=t,r.return=t,r.sibling=f,t.child=r,r=f,f=t.child,G=e.child.memoizedState,G=G===null?mo(n):{baseLanes:G.baseLanes|n,cachePool:null,transitions:G.transitions},f.memoizedState=G,f.childLanes=e.childLanes&~n,t.memoizedState=po,r}return f=e.child,e=f.sibling,r=Yn(f,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function yo(e,t){return t=ea({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function As(e,t,n,r){return r!==null&&Ha(r),wr(t,e.child,null,n),e=yo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Of(e,t,n,r,i,f,G){if(n)return t.flags&256?(t.flags&=-257,r=co(Error(a(422))),As(e,t,G,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(f=r.fallback,i=t.mode,r=ea({mode:"visible",children:r.children},i,0,null),f=sr(f,i,G,null),f.flags|=2,r.return=t,f.return=t,r.sibling=f,t.child=r,(t.mode&1)!==0&&wr(t,e.child,null,G),t.child.memoizedState=mo(G),t.memoizedState=po,f);if((t.mode&1)===0)return As(e,t,G,null);if(cr(i))return r=Aa(i).digest,f=Error(a(419)),r=co(f,r,void 0),As(e,t,G,r);if(n=(G&e.childLanes)!==0,Gt||n){if(r=_t,r!==null){switch(G&-G){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(r.suspendedLanes|G))!==0?0:i,i!==0&&i!==f.retryLane&&(f.retryLane=i,vn(e,i),nn(r,e,i,-1))}return Do(),r=co(Error(a(421))),As(e,t,G,r)}return $i(i)?(t.flags|=128,t.child=e.child,t=Jf.bind(null,e),es(i,t),null):(e=f.treeContext,Ce&&(Zt=rs(i),qt=t,Je=!0,dn=null,ki=!1,e!==null&&(Qt[Jt++]=Rn,Qt[Jt++]=Fn,Qt[Jt++]=Jn,Rn=e.id,Fn=e.overflow,Jn=t)),t=yo(t,r.children),t.flags|=4096,t)}function Au(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ya(e.return,t,n)}function vo(e,t,n,r,i){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(f.isBackwards=t,f.rendering=null,f.renderingStartTime=0,f.last=r,f.tail=n,f.tailMode=i)}function Lu(e,t,n){var r=t.pendingProps,i=r.revealOrder,f=r.tail;if(Lt(e,t,r.children,n),r=et.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Au(e,n,t);else if(e.tag===19)Au(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(je(et,r),(t.mode&1)===0)t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Ps(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),vo(t,!1,i,n,f);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ps(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}vo(t,!0,n,null,f);break;case"together":vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ls(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function In(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),tr|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,n=Yn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Yn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Gf(e,t,n){switch(t.tag){case 3:Nu(t),_r();break;case 5:Xd(t);break;case 1:F(t.type)&&re(t);break;case 4:Qa(t,t.stateNode.containerInfo);break;case 10:Wd(t,t.type._context,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(je(et,et.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?Mu(e,t,n):(je(et,et.current&1),e=In(e,t,n),e!==null?e.sibling:null);je(et,et.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return Lu(e,t,n);t.flags|=128}var i=t.memoizedState;if(i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),je(et,et.current),r)break;return null;case 22:case 23:return t.lanes=0,Tu(e,t,n)}return In(e,t,n)}function wn(e){e.flags|=4}function zu(e,t){if(e!==null&&e.child===t.child)return!0;if((t.flags&16)!==0)return!1;for(e=t.child;e!==null;){if((e.flags&12854)!==0||(e.subtreeFlags&12854)!==0)return!1;e=e.sibling}return!0}var Mi,Ai,zs,Ds;if(ce)Mi=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)le(e,n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ai=function(){},zs=function(e,t,n,r,i){if(e=e.memoizedProps,e!==r){var f=t.stateNode,G=xn(en.current);n=oe(f,n,e,r,i,G),(t.updateQueue=n)&&wn(t)}},Ds=function(e,t,n,r){n!==r&&wn(t)};else if(ve){Mi=function(e,t,n,r){for(var i=t.child;i!==null;){if(i.tag===5){var f=i.stateNode;n&&r&&(f=bi(f,i.type,i.memoizedProps,i)),le(e,f)}else if(i.tag===6)f=i.stateNode,n&&r&&(f=ur(f,i.memoizedProps,i)),le(e,f);else if(i.tag!==4){if(i.tag===22&&i.memoizedState!==null)f=i.child,f!==null&&(f.return=i),Mi(e,i,!0,!0);else if(i.child!==null){i.child.return=i,i=i.child;continue}}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};var Du=function(e,t,n,r){for(var i=t.child;i!==null;){if(i.tag===5){var f=i.stateNode;n&&r&&(f=bi(f,i.type,i.memoizedProps,i)),Ci(e,f)}else if(i.tag===6)f=i.stateNode,n&&r&&(f=ur(f,i.memoizedProps,i)),Ci(e,f);else if(i.tag!==4){if(i.tag===22&&i.memoizedState!==null)f=i.child,f!==null&&(f.return=i),Du(e,i,!0,!0);else if(i.child!==null){i.child.return=i,i=i.child;continue}}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Ai=function(e,t){var n=t.stateNode;if(!zu(e,t)){e=n.containerInfo;var r=Ji(e);Du(r,t,!1,!1),n.pendingChildren=r,wn(t),Na(e,r)}},zs=function(e,t,n,r,i){var f=e.stateNode,G=e.memoizedProps;if((e=zu(e,t))&&G===r)t.stateNode=f;else{var J=t.stateNode,ee=xn(en.current),ue=null;G!==r&&(ue=oe(J,n,G,r,i,ee)),e&&ue===null?t.stateNode=f:(f=Fa(f,ue,n,G,r,t,e,J),ie(f,n,r,i,ee)&&wn(t),t.stateNode=f,e?wn(t):Mi(f,t,!1,!1))}},Ds=function(e,t,n,r){n!==r?(e=xn(br.current),n=xn(en.current),t.stateNode=fe(r,e,n,t),wn(t)):t.stateNode=e.stateNode}}else Ai=function(){},zs=function(){},Ds=function(){};function Li(e,t){if(!Je)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Bf(e,t,n){var r=t.pendingProps;switch(Ba(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(t),null;case 1:return F(t.type)&&j(),Ft(t),null;case 3:return n=t.stateNode,kr(),We(St),We(ft),$a(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(_s(t)?wn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,dn!==null&&(Lo(dn),dn=null))),Ai(e,t),Ft(t),null;case 5:Ja(t),n=xn(br.current);var i=t.type;if(e!==null&&t.stateNode!=null)zs(e,t,i,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(a(166));return Ft(t),null}if(e=xn(en.current),_s(t)){if(!Ce)throw Error(a(175));e=is(t.stateNode,t.type,t.memoizedProps,n,e,t,!ki),t.updateQueue=e,e!==null&&wn(t)}else{var f=ne(i,r,n,e,t);Mi(f,t,!1,!1),t.stateNode=f,ie(f,i,r,n,e)&&wn(t)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ft(t),null;case 6:if(e&&t.stateNode!=null)Ds(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(a(166));if(e=xn(br.current),n=xn(en.current),_s(t)){if(!Ce)throw Error(a(176));if(e=t.stateNode,n=t.memoizedProps,(r=ss(e,n,t,!ki))&&(i=qt,i!==null))switch(i.tag){case 3:fs(i.stateNode.containerInfo,e,n,(i.mode&1)!==0);break;case 5:gs(i.type,i.memoizedProps,i.stateNode,e,n,(i.mode&1)!==0)}r&&wn(t)}else t.stateNode=fe(r,e,n,t)}return Ft(t),null;case 13:if(We(et),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Je&&Zt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Bd(),_r(),t.flags|=98560,i=!1;else if(i=_s(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(a(318));if(!Ce)throw Error(a(344));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));as(i,t)}else _r(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ft(t),i=!1}else dn!==null&&(Lo(dn),dn=null),i=!0;if(!i)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(n=r!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(et.current&1)!==0?pt===0&&(pt=3):Do())),t.updateQueue!==null&&(t.flags|=4),Ft(t),null);case 4:return kr(),Ai(e,t),e===null&&be(t.stateNode.containerInfo),Ft(t),null;case 10:return qa(t.type._context),Ft(t),null;case 17:return F(t.type)&&j(),Ft(t),null;case 19:if(We(et),i=t.memoizedState,i===null)return Ft(t),null;if(r=(t.flags&128)!==0,f=i.rendering,f===null)if(r)Li(i,!1);else{if(pt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Ps(e),f!==null){for(t.flags|=128,Li(i,!1),e=f.updateQueue,e!==null&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,n=t.child;n!==null;)r=n,i=e,r.flags&=14680066,f=r.alternate,f===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=f.childLanes,r.lanes=f.lanes,r.child=f.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=f.memoizedProps,r.memoizedState=f.memoizedState,r.updateQueue=f.updateQueue,r.type=f.type,i=f.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n=n.sibling;return je(et,et.current&1|2),t.child}e=e.sibling}i.tail!==null&&vt()>No&&(t.flags|=128,r=!0,Li(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ps(f),e!==null){if(t.flags|=128,r=!0,e=e.updateQueue,e!==null&&(t.updateQueue=e,t.flags|=4),Li(i,!0),i.tail===null&&i.tailMode==="hidden"&&!f.alternate&&!Je)return Ft(t),null}else 2*vt()-i.renderingStartTime>No&&n!==1073741824&&(t.flags|=128,r=!0,Li(i,!1),t.lanes=4194304);i.isBackwards?(f.sibling=t.child,t.child=f):(e=i.last,e!==null?e.sibling=f:t.child=f,i.last=f)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=vt(),t.sibling=null,e=et.current,je(et,r?e&1|2:e&1),t):(Ft(t),null);case 22:case 23:return zo(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&(t.mode&1)!==0?(Yt&1073741824)!==0&&(Ft(t),ce&&t.subtreeFlags&6&&(t.flags|=8192)):Ft(t),null;case 24:return null;case 25:return null}throw Error(a(156,t.tag))}function Uf(e,t){switch(Ba(t),t.tag){case 1:return F(t.type)&&j(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return kr(),We(St),We(ft),$a(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Ja(t),null;case 13:if(We(et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));_r()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return We(et),null;case 4:return kr(),null;case 10:return qa(t.type._context),null;case 22:case 23:return zo(),null;case 24:return null;default:return null}}var Os=!1,Nt=!1,jf=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Pr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ze(e,t,r)}else n.current=null}function xo(e,t,n){try{n()}catch(r){Ze(e,t,r)}}var Ou=!1;function Hf(e,t){for(X(e.containerInfo),xe=t;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var n=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(n!==null){var r=n.memoizedProps,i=n.memoizedState,f=e.stateNode,G=f.getSnapshotBeforeUpdate(e.elementType===e.type?r:un(e.type,r),i);f.__reactInternalSnapshotBeforeUpdate=G}break;case 3:ce&&gn(e.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(J){Ze(e,e.return,J)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return n=Ou,Ou=!1,n}function zi(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var f=i.destroy;i.destroy=void 0,f!==void 0&&xo(t,n,f)}i=i.next}while(i!==r)}}function Gs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function _o(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=O(n);break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Gu(e){var t=e.alternate;t!==null&&(e.alternate=null,Gu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&De(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Bu(e){return e.tag===5||e.tag===3||e.tag===4}function Uu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Bu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wo(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?Pt(n,e,t):Xt(n,e);else if(r!==4&&(e=e.child,e!==null))for(wo(e,t,n),e=e.sibling;e!==null;)wo(e,t,n),e=e.sibling}function So(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?Et(n,e,t):Ot(n,e);else if(r!==4&&(e=e.child,e!==null))for(So(e,t,n),e=e.sibling;e!==null;)So(e,t,n),e=e.sibling}var bt=null,cn=!1;function Sn(e,t,n){for(n=n.child;n!==null;)Co(e,t,n),n=n.sibling}function Co(e,t,n){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(ms,n)}catch{}switch(n.tag){case 5:Nt||Pr(n,t);case 6:if(ce){var r=bt,i=cn;bt=null,Sn(e,t,n),bt=r,cn=i,bt!==null&&(cn?Si(bt,n.stateNode):On(bt,n.stateNode))}else Sn(e,t,n);break;case 18:ce&&bt!==null&&(cn?cs(bt,n.stateNode):us(bt,n.stateNode));break;case 4:ce?(r=bt,i=cn,bt=n.stateNode.containerInfo,cn=!0,Sn(e,t,n),bt=r,cn=i):(ve&&(r=n.stateNode.containerInfo,i=Ji(r),dr(r,i)),Sn(e,t,n));break;case 0:case 11:case 14:case 15:if(!Nt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var f=i,G=f.destroy;f=f.tag,G!==void 0&&((f&2)!==0||(f&4)!==0)&&xo(n,t,G),i=i.next}while(i!==r)}Sn(e,t,n);break;case 1:if(!Nt&&(Pr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(J){Ze(n,t,J)}Sn(e,t,n);break;case 21:Sn(e,t,n);break;case 22:n.mode&1?(Nt=(r=Nt)||n.memoizedState!==null,Sn(e,t,n),Nt=r):Sn(e,t,n);break;default:Sn(e,t,n)}}function ju(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new jf),t.forEach(function(r){var i=Zf.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function hn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var f=e,G=t;if(ce){var J=G;e:for(;J!==null;){switch(J.tag){case 5:bt=J.stateNode,cn=!1;break e;case 3:bt=J.stateNode.containerInfo,cn=!0;break e;case 4:bt=J.stateNode.containerInfo,cn=!0;break e}J=J.return}if(bt===null)throw Error(a(160));Co(f,G,i),bt=null,cn=!1}else Co(f,G,i);var ee=i.alternate;ee!==null&&(ee.return=null),i.return=null}catch(ue){Ze(i,t,ue)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hu(t,e),t=t.sibling}function Hu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hn(t,e),Cn(e),r&4){try{zi(3,e,e.return),Gs(3,e)}catch(me){Ze(e,e.return,me)}try{zi(5,e,e.return)}catch(me){Ze(e,e.return,me)}}break;case 1:hn(t,e),Cn(e),r&512&&n!==null&&Pr(n,n.return);break;case 5:if(hn(t,e),Cn(e),r&512&&n!==null&&Pr(n,n.return),ce){if(e.flags&32){var i=e.stateNode;try{Xi(i)}catch(me){Ze(e,e.return,me)}}if(r&4&&(i=e.stateNode,i!=null)){var f=e.memoizedProps;if(n=n!==null?n.memoizedProps:f,r=e.type,t=e.updateQueue,e.updateQueue=null,t!==null)try{yt(i,t,r,n,f,e)}catch(me){Ze(e,e.return,me)}}}break;case 6:if(hn(t,e),Cn(e),r&4&&ce){if(e.stateNode===null)throw Error(a(162));i=e.stateNode,f=e.memoizedProps,n=n!==null?n.memoizedProps:f;try{Ie(i,n,f)}catch(me){Ze(e,e.return,me)}}break;case 3:if(hn(t,e),Cn(e),r&4){if(ce&&Ce&&n!==null&&n.memoizedState.isDehydrated)try{ls(t.containerInfo)}catch(me){Ze(e,e.return,me)}if(ve){i=t.containerInfo,f=t.pendingChildren;try{dr(i,f)}catch(me){Ze(e,e.return,me)}}}break;case 4:if(hn(t,e),Cn(e),r&4&&ve){f=e.stateNode,i=f.containerInfo,f=f.pendingChildren;try{dr(i,f)}catch(me){Ze(e,e.return,me)}}break;case 13:hn(t,e),Cn(e),i=e.child,i.flags&8192&&(f=i.memoizedState!==null,i.stateNode.isHidden=f,!f||i.alternate!==null&&i.alternate.memoizedState!==null||(Fo=vt())),r&4&&ju(e);break;case 22:var G=n!==null&&n.memoizedState!==null;if(e.mode&1?(Nt=(n=Nt)||G,hn(t,e),Nt=n):hn(t,e),Cn(e),r&8192){if(n=e.memoizedState!==null,(e.stateNode.isHidden=n)&&!G&&(e.mode&1)!==0)for(xe=e,r=e.child;r!==null;){for(t=xe=r;xe!==null;){G=xe;var J=G.child;switch(G.tag){case 0:case 11:case 14:case 15:zi(4,G,G.return);break;case 1:Pr(G,G.return);var ee=G.stateNode;if(typeof ee.componentWillUnmount=="function"){var ue=G,_e=G.return;try{var Ee=ue;ee.props=Ee.memoizedProps,ee.state=Ee.memoizedState,ee.componentWillUnmount()}catch(me){Ze(ue,_e,me)}}break;case 5:Pr(G,G.return);break;case 22:if(G.memoizedState!==null){qu(t);continue}}J!==null?(J.return=G,xe=J):qu(t)}r=r.sibling}if(ce){e:if(r=null,ce)for(t=e;;){if(t.tag===5){if(r===null){r=t;try{i=t.stateNode,n?Ta(i):lr(t.stateNode,t.memoizedProps)}catch(me){Ze(e,e.return,me)}}}else if(t.tag===6){if(r===null)try{f=t.stateNode,n?Ra(f):Qi(f,t.memoizedProps)}catch(me){Ze(e,e.return,me)}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}}}break;case 19:hn(t,e),Cn(e),r&4&&ju(e);break;case 21:break;default:hn(t,e),Cn(e)}}function Cn(e){var t=e.flags;if(t&2){try{if(ce){e:{for(var n=e.return;n!==null;){if(Bu(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Xi(i),r.flags&=-33);var f=Uu(e);So(e,f,i);break;case 3:case 4:var G=r.stateNode.containerInfo,J=Uu(e);wo(e,J,G);break;default:throw Error(a(161))}}}catch(ee){Ze(e,e.return,ee)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Wf(e,t,n){xe=e,Wu(e)}function Wu(e,t,n){for(var r=(e.mode&1)!==0;xe!==null;){var i=xe,f=i.child;if(i.tag===22&&r){var G=i.memoizedState!==null||Os;if(!G){var J=i.alternate,ee=J!==null&&J.memoizedState!==null||Nt;J=Os;var ue=Nt;if(Os=G,(Nt=ee)&&!ue)for(xe=i;xe!==null;)G=xe,ee=G.child,G.tag===22&&G.memoizedState!==null?Yu(i):ee!==null?(ee.return=G,xe=ee):Yu(i);for(;f!==null;)xe=f,Wu(f),f=f.sibling;xe=i,Os=J,Nt=ue}Vu(e)}else(i.subtreeFlags&8772)!==0&&f!==null?(f.return=i,xe=f):Vu(e)}}function Vu(e){for(;xe!==null;){var t=xe;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Nt||Gs(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Nt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:un(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var f=t.updateQueue;f!==null&&Kd(t,f,r);break;case 3:var G=t.updateQueue;if(G!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=O(t.child.stateNode);break;case 1:n=t.child.stateNode}Kd(t,G,n)}break;case 5:var J=t.stateNode;n===null&&t.flags&4&&ke(J,t.type,t.memoizedProps,t);break;case 6:break;case 4:break;case 12:break;case 13:if(Ce&&t.memoizedState===null){var ee=t.alternate;if(ee!==null){var ue=ee.memoizedState;if(ue!==null){var _e=ue.dehydrated;_e!==null&&ds(_e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}Nt||t.flags&512&&_o(t)}catch(Ee){Ze(t,t.return,Ee)}}if(t===e){xe=null;break}if(n=t.sibling,n!==null){n.return=t.return,xe=n;break}xe=t.return}}function qu(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xe=n;break}xe=t.return}}function Yu(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Gs(4,t)}catch(ee){Ze(t,n,ee)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(ee){Ze(t,i,ee)}}var f=t.return;try{_o(t)}catch(ee){Ze(t,f,ee)}break;case 5:var G=t.return;try{_o(t)}catch(ee){Ze(t,G,ee)}}}catch(ee){Ze(t,t.return,ee)}if(t===e){xe=null;break}var J=t.sibling;if(J!==null){J.return=t.return,xe=J;break}xe=t.return}}var Bs=0,Us=1,js=2,Hs=3,Ws=4;if(typeof Symbol=="function"&&Symbol.for){var Di=Symbol.for;Bs=Di("selector.component"),Us=Di("selector.has_pseudo_class"),js=Di("selector.role"),Hs=Di("selector.test_id"),Ws=Di("selector.text")}function bo(e){var t=Fe(e);if(t!=null){if(typeof t.memoizedProps["data-testname"]!="string")throw Error(a(364));return t}if(e=Wt(e),e===null)throw Error(a(362));return e.stateNode.current}function ko(e,t){switch(t.$$typeof){case Bs:if(e.type===t.value)return!0;break;case Us:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],i=e[n++],f=t[i];if(r.tag!==5||!st(r)){for(;f!=null&&ko(r,f);)i++,f=t[i];if(i===t.length){t=!0;break e}else for(r=r.child;r!==null;)e.push(r,i),r=r.sibling}}t=!1}return t;case js:if(e.tag===5&&Vt(e.stateNode,t.value))return!0;break;case Ws:if((e.tag===5||e.tag===6)&&(e=ut(e),e!==null&&0<=e.indexOf(t.value)))return!0;break;case Hs:if(e.tag===5&&(e=e.memoizedProps["data-testname"],typeof e=="string"&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Eo(e){switch(e.$$typeof){case Bs:return"<"+(U(e.value)||"Unknown")+">";case Us:return":has("+(Eo(e)||"")+")";case js:return'[role="'+e.value+'"]';case Ws:return'"'+e.value+'"';case Hs:return'[data-testname="'+e.value+'"]';default:throw Error(a(365))}}function Ku(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var i=e[r++],f=e[r++],G=t[f];if(i.tag!==5||!st(i)){for(;G!=null&&ko(i,G);)f++,G=t[f];if(f===t.length)n.push(i);else for(i=i.child;i!==null;)e.push(i,f),i=i.sibling}}return n}function Po(e,t){if(!dt)throw Error(a(363));e=bo(e),e=Ku(e,t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(r.tag===5)st(r)||t.push(r.stateNode);else for(r=r.child;r!==null;)e.push(r),r=r.sibling}return t}var Vf=Math.ceil,Vs=c.ReactCurrentDispatcher,To=c.ReactCurrentOwner,lt=c.ReactCurrentBatchConfig,Me=0,_t=null,ct=null,kt=0,Yt=0,Tr=sn(0),pt=0,Oi=null,tr=0,qs=0,Ro=0,Gi=null,Bt=null,Fo=0,No=1/0,Mn=null;function Rr(){No=vt()+500}var Ys=!1,Io=null,Hn=null,Ks=!1,Wn=null,Xs=0,Bi=0,Mo=null,Qs=-1,Js=0;function It(){return(Me&6)!==0?vt():Qs!==-1?Qs:Qs=vt()}function Vn(e){return(e.mode&1)===0?1:(Me&2)!==0&&kt!==0?kt&-kt:Pf.transition!==null?(Js===0&&(Js=Ct()),Js):(e=Oe,e!==0?e:$e())}function nn(e,t,n,r){if(50<Bi)throw Bi=0,Mo=null,Error(a(185));ot(e,n,r),((Me&2)===0||e!==_t)&&(e===_t&&((Me&2)===0&&(qs|=n),pt===4&&qn(e,kt)),Ut(e,r),n===1&&Me===0&&(t.mode&1)===0&&(Rr(),ys&&yn()))}function Ut(e,t){var n=e.callbackNode;at(e,t);var r=on(e,e===_t?kt:0);if(r===0)n!==null&&Ad(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Ad(n),t===1)e.tag===0?Ef(Qu.bind(null,e)):Ld(Qu.bind(null,e)),Ue?Mt(function(){(Me&6)===0&&yn()}):La(za,yn),n=null;else{switch(Md(r)){case 1:n=za;break;case 4:n=Sf;break;case 16:n=Da;break;case 536870912:n=Cf;break;default:n=Da}n=sc(n,Xu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Xu(e,t){if(Qs=-1,Js=0,(Me&6)!==0)throw Error(a(327));var n=e.callbackNode;if(ir()&&e.callbackNode!==n)return null;var r=on(e,e===_t?kt:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=Zs(e,r);else{t=r;var i=Me;Me|=2;var f=$u();(_t!==e||kt!==t)&&(Mn=null,Rr(),nr(e,t));do try{Kf();break}catch(J){Zu(e,J)}while(!0);Va(),Vs.current=f,Me=i,ct!==null?t=0:(_t=null,kt=0,t=pt)}if(t!==0){if(t===2&&(i=Qe(e),i!==0&&(r=i,t=Ao(e,i))),t===1)throw n=Oi,nr(e,0),qn(e,r),Ut(e,vt()),n;if(t===6)qn(e,r);else{if(i=e.current.alternate,(r&30)===0&&!qf(i)&&(t=Zs(e,r),t===2&&(f=Qe(e),f!==0&&(r=f,t=Ao(e,f))),t===1))throw n=Oi,nr(e,0),qn(e,r),Ut(e,vt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:rr(e,Bt,Mn);break;case 3:if(qn(e,r),(r&130023424)===r&&(t=Fo+500-vt(),10<t)){if(on(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){It(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=H(rr.bind(null,e,Bt,Mn),t);break}rr(e,Bt,Mn);break;case 4:if(qn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var G=31-we(r);f=1<<G,G=t[G],G>i&&(i=G),r&=~f}if(r=i,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Vf(r/1960))-r,10<r){e.timeoutHandle=H(rr.bind(null,e,Bt,Mn),r);break}rr(e,Bt,Mn);break;case 5:rr(e,Bt,Mn);break;default:throw Error(a(329))}}}return Ut(e,vt()),e.callbackNode===n?Xu.bind(null,e):null}function Ao(e,t){var n=Gi;return e.current.memoizedState.isDehydrated&&(nr(e,t).flags|=256),e=Zs(e,t),e!==2&&(t=Bt,Bt=n,t!==null&&Lo(t)),e}function Lo(e){Bt===null?Bt=e:Bt.push.apply(Bt,e)}function qf(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],f=i.getSnapshot;i=i.value;try{if(!ln(f(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qn(e,t){for(t&=~Ro,t&=~qs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-we(t),r=1<<n;e[n]=-1,t&=~r}}function Qu(e){if((Me&6)!==0)throw Error(a(327));ir();var t=on(e,0);if((t&1)===0)return Ut(e,vt()),null;var n=Zs(e,t);if(e.tag!==0&&n===2){var r=Qe(e);r!==0&&(t=r,n=Ao(e,r))}if(n===1)throw n=Oi,nr(e,0),qn(e,t),Ut(e,vt()),n;if(n===6)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,rr(e,Bt,Mn),Ut(e,vt()),null}function Ju(e){Wn!==null&&Wn.tag===0&&(Me&6)===0&&ir();var t=Me;Me|=1;var n=lt.transition,r=Oe;try{if(lt.transition=null,Oe=1,e)return e()}finally{Oe=r,lt.transition=n,Me=t,(Me&6)===0&&yn()}}function zo(){Yt=Tr.current,We(Tr)}function nr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==de&&(e.timeoutHandle=de,te(n)),ct!==null)for(n=ct.return;n!==null;){var r=n;switch(Ba(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&j();break;case 3:kr(),We(St),We(ft),$a();break;case 5:Ja(r);break;case 4:kr();break;case 13:We(et);break;case 19:We(et);break;case 10:qa(r.type._context);break;case 22:case 23:zo()}n=n.return}if(_t=e,ct=e=Yn(e.current,null),kt=Yt=t,pt=0,Oi=null,Ro=qs=tr=0,Bt=Gi=null,$n!==null){for(t=0;t<$n.length;t++)if(n=$n[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,f=n.pending;if(f!==null){var G=f.next;f.next=i,r.next=G}n.pending=r}$n=null}return e}function Zu(e,t){do{var n=ct;try{if(Va(),Ts.current=Is,Rs){for(var r=tt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Rs=!1}if(er=0,xt=gt=tt=null,Ri=!1,Fi=0,To.current=null,n===null||n.return===null){pt=1,Oi=t,ct=null;break}e:{var f=e,G=n.return,J=n,ee=t;if(t=kt,J.flags|=32768,ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var ue=ee,_e=J,Ee=_e.tag;if((_e.mode&1)===0&&(Ee===0||Ee===11||Ee===15)){var me=_e.alternate;me?(_e.updateQueue=me.updateQueue,_e.memoizedState=me.memoizedState,_e.lanes=me.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var Xe=Cu(G);if(Xe!==null){Xe.flags&=-257,bu(Xe,G,J,f,t),Xe.mode&1&&Su(f,ue,t),t=Xe,ee=ue;var Ye=t.updateQueue;if(Ye===null){var jt=new Set;jt.add(ee),t.updateQueue=jt}else Ye.add(ee);break e}else{if((t&1)===0){Su(f,ue,t),Do();break e}ee=Error(a(426))}}else if(Je&&J.mode&1){var An=Cu(G);if(An!==null){(An.flags&65536)===0&&(An.flags|=256),bu(An,G,J,f,t),Ha(Er(ee,J));break e}}f=ee=Er(ee,J),pt!==4&&(pt=2),Gi===null?Gi=[f]:Gi.push(f),f=G;do{switch(f.tag){case 3:f.flags|=65536,t&=-t,f.lanes|=t;var $=_u(f,ee,t);Yd(f,$);break e;case 1:J=ee;var Z=f.type,se=f.stateNode;if((f.flags&128)===0&&(typeof Z.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(Hn===null||!Hn.has(se)))){f.flags|=65536,t&=-t,f.lanes|=t;var ye=wu(f,J,t);Yd(f,ye);break e}}f=f.return}while(f!==null)}tc(n)}catch(Se){t=Se,ct===n&&n!==null&&(ct=n=n.return);continue}break}while(!0)}function $u(){var e=Vs.current;return Vs.current=Is,e===null?Is:e}function Do(){(pt===0||pt===3||pt===2)&&(pt=4),_t===null||(tr&268435455)===0&&(qs&268435455)===0||qn(_t,kt)}function Zs(e,t){var n=Me;Me|=2;var r=$u();(_t!==e||kt!==t)&&(Mn=null,nr(e,t));do try{Yf();break}catch(i){Zu(e,i)}while(!0);if(Va(),Me=n,Vs.current=r,ct!==null)throw Error(a(261));return _t=null,kt=0,pt}function Yf(){for(;ct!==null;)ec(ct)}function Kf(){for(;ct!==null&&!_f();)ec(ct)}function ec(e){var t=ic(e.alternate,e,Yt);e.memoizedProps=e.pendingProps,t===null?tc(e):ct=t,To.current=null}function tc(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=Bf(n,t,Yt),n!==null){ct=n;return}}else{if(n=Uf(n,t),n!==null){n.flags&=32767,ct=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,ct=null;return}}if(t=t.sibling,t!==null){ct=t;return}ct=t=e}while(t!==null);pt===0&&(pt=5)}function rr(e,t,n){var r=Oe,i=lt.transition;try{lt.transition=null,Oe=1,Xf(e,t,n,r)}finally{lt.transition=i,Oe=r}return null}function Xf(e,t,n,r){do ir();while(Wn!==null);if((Me&6)!==0)throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var f=n.lanes|n.childLanes;if(yr(e,f),e===_t&&(ct=_t=null,kt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Ks||(Ks=!0,sc(Da,function(){return ir(),null})),f=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||f){f=lt.transition,lt.transition=null;var G=Oe;Oe=1;var J=Me;Me|=4,To.current=null,Hf(e,n),Hu(n,e),Q(e.containerInfo),e.current=n,Wf(n),wf(),Me=J,Oe=G,lt.transition=f}else e.current=n;if(Ks&&(Ks=!1,Wn=e,Xs=i),f=e.pendingLanes,f===0&&(Hn=null),bf(n.stateNode),Ut(e,vt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ys)throw Ys=!1,e=Io,Io=null,e;return(Xs&1)!==0&&e.tag!==0&&ir(),f=e.pendingLanes,(f&1)!==0?e===Mo?Bi++:(Bi=0,Mo=e):Bi=0,yn(),null}function ir(){if(Wn!==null){var e=Md(Xs),t=lt.transition,n=Oe;try{if(lt.transition=null,Oe=16>e?16:e,Wn===null)var r=!1;else{if(e=Wn,Wn=null,Xs=0,(Me&6)!==0)throw Error(a(331));var i=Me;for(Me|=4,xe=e.current;xe!==null;){var f=xe,G=f.child;if((xe.flags&16)!==0){var J=f.deletions;if(J!==null){for(var ee=0;ee<J.length;ee++){var ue=J[ee];for(xe=ue;xe!==null;){var _e=xe;switch(_e.tag){case 0:case 11:case 15:zi(8,_e,f)}var Ee=_e.child;if(Ee!==null)Ee.return=_e,xe=Ee;else for(;xe!==null;){_e=xe;var me=_e.sibling,Xe=_e.return;if(Gu(_e),_e===ue){xe=null;break}if(me!==null){me.return=Xe,xe=me;break}xe=Xe}}}var Ye=f.alternate;if(Ye!==null){var jt=Ye.child;if(jt!==null){Ye.child=null;do{var An=jt.sibling;jt.sibling=null,jt=An}while(jt!==null)}}xe=f}}if((f.subtreeFlags&2064)!==0&&G!==null)G.return=f,xe=G;else e:for(;xe!==null;){if(f=xe,(f.flags&2048)!==0)switch(f.tag){case 0:case 11:case 15:zi(9,f,f.return)}var $=f.sibling;if($!==null){$.return=f.return,xe=$;break e}xe=f.return}}var Z=e.current;for(xe=Z;xe!==null;){G=xe;var se=G.child;if((G.subtreeFlags&2064)!==0&&se!==null)se.return=G,xe=se;else e:for(G=Z;xe!==null;){if(J=xe,(J.flags&2048)!==0)try{switch(J.tag){case 0:case 11:case 15:Gs(9,J)}}catch(Se){Ze(J,J.return,Se)}if(J===G){xe=null;break e}var ye=J.sibling;if(ye!==null){ye.return=J.return,xe=ye;break e}xe=J.return}}if(Me=i,yn(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(ms,e)}catch{}r=!0}return r}finally{Oe=n,lt.transition=t}}return!1}function nc(e,t,n){t=Er(n,t),t=_u(e,t,1),e=jn(e,t,1),t=It(),e!==null&&(ot(e,1,t),Ut(e,t))}function Ze(e,t,n){if(e.tag===3)nc(e,e,n);else for(;t!==null;){if(t.tag===3){nc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hn===null||!Hn.has(r))){e=Er(n,e),e=wu(t,e,1),t=jn(t,e,1),e=It(),t!==null&&(ot(t,1,e),Ut(t,e));break}}t=t.return}}function Qf(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=It(),e.pingedLanes|=e.suspendedLanes&n,_t===e&&(kt&n)===n&&(pt===4||pt===3&&(kt&130023424)===kt&&500>vt()-Fo?nr(e,0):Ro|=n),Ut(e,t)}function rc(e,t){t===0&&((e.mode&1)===0?t=1:(t=rt,rt<<=1,(rt&130023424)===0&&(rt=4194304)));var n=It();e=vn(e,t),e!==null&&(ot(e,t,n),Ut(e,n))}function Jf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),rc(e,n)}function Zf(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}r!==null&&r.delete(t),rc(e,n)}var ic;ic=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||St.current)Gt=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return Gt=!1,Gf(e,t,n);Gt=(e.flags&131072)!==0}else Gt=!1,Je&&(t.flags&1048576)!==0&&zd(t,xs,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ls(e,t),e=t.pendingProps;var i=p(t,ft.current);Cr(t,n),i=no(null,t,r,e,i,n);var f=ro();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,F(r)?(f=!0,re(t)):f=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Xa(t),i.updater=Ms,t.stateNode=i,i._reactInternals=t,uo(t,r,e,n),t=go(null,t,r,!0,f,n)):(t.tag=0,Je&&f&&Ga(t),Lt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ls(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=e0(r),e=un(r,e),i){case 0:t=fo(null,t,r,e,n);break e;case 1:t=Fu(null,t,r,e,n);break e;case 11:t=ku(null,t,r,e,n);break e;case 14:t=Eu(null,t,r,un(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),fo(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),Fu(e,t,r,i,n);case 3:e:{if(Nu(t),e===null)throw Error(a(387));r=t.pendingProps,f=t.memoizedState,i=f.element,qd(e,t),Es(t,r,null,n);var G=t.memoizedState;if(r=G.element,Ce&&f.isDehydrated)if(f={element:r,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){i=Er(Error(a(423)),t),t=Iu(e,t,r,n,i);break e}else if(r!==i){i=Er(Error(a(424)),t),t=Iu(e,t,r,n,i);break e}else for(Ce&&(Zt=ns(t.stateNode.containerInfo),qt=t,Je=!0,dn=null,ki=!1),n=Hd(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_r(),r===i){t=In(e,t,n);break e}Lt(e,t,r,n)}t=t.child}return t;case 5:return Xd(t),e===null&&ja(t),r=t.type,i=t.pendingProps,f=e!==null?e.memoizedProps:null,G=i.children,ge(r,i)?G=null:f!==null&&ge(r,f)&&(t.flags|=32),Ru(e,t),Lt(e,t,G,n),t.child;case 6:return e===null&&ja(t),null;case 13:return Mu(e,t,n);case 4:return Qa(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=wr(t,null,r,n):Lt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),ku(e,t,r,i,n);case 7:return Lt(e,t,t.pendingProps,n),t.child;case 8:return Lt(e,t,t.pendingProps.children,n),t.child;case 12:return Lt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,f=t.memoizedProps,G=i.value,Wd(t,r,G),f!==null)if(ln(f.value,G)){if(f.children===i.children&&!St.current){t=In(e,t,n);break e}}else for(f=t.child,f!==null&&(f.return=t);f!==null;){var J=f.dependencies;if(J!==null){G=f.child;for(var ee=J.firstContext;ee!==null;){if(ee.context===r){if(f.tag===1){ee=Nn(-1,n&-n),ee.tag=2;var ue=f.updateQueue;if(ue!==null){ue=ue.shared;var _e=ue.pending;_e===null?ee.next=ee:(ee.next=_e.next,_e.next=ee),ue.pending=ee}}f.lanes|=n,ee=f.alternate,ee!==null&&(ee.lanes|=n),Ya(f.return,n,t),J.lanes|=n;break}ee=ee.next}}else if(f.tag===10)G=f.type===t.type?null:f.child;else if(f.tag===18){if(G=f.return,G===null)throw Error(a(341));G.lanes|=n,J=G.alternate,J!==null&&(J.lanes|=n),Ya(G,n,t),G=f.sibling}else G=f.child;if(G!==null)G.return=f;else for(G=f;G!==null;){if(G===t){G=null;break}if(f=G.sibling,f!==null){f.return=G.return,G=f;break}G=G.return}f=G}Lt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Cr(t,n),i=$t(i),r=r(i),t.flags|=1,Lt(e,t,r,n),t.child;case 14:return r=t.type,i=un(r,t.pendingProps),i=un(r.type,i),Eu(e,t,r,i,n);case 15:return Pu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),Ls(e,t),t.tag=1,F(r)?(e=!0,re(t)):e=!1,Cr(t,n),vu(t,r,i),uo(t,r,i,n),go(null,t,r,!0,e,n);case 19:return Lu(e,t,n);case 22:return Tu(e,t,n)}throw Error(a(156,t.tag))};function sc(e,t){return La(e,t)}function $f(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(e,t,n,r){return new $f(e,t,n,r)}function Oo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function e0(e){if(typeof e=="function")return Oo(e)?1:0;if(e!=null){if(e=e.$$typeof,e===S)return 11;if(e===u)return 14}return 2}function Yn(e,t){var n=e.alternate;return n===null?(n=rn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function $s(e,t,n,r,i,f){var G=2;if(r=e,typeof e=="function")Oo(e)&&(G=1);else if(typeof e=="string")G=5;else e:switch(e){case v:return sr(n.children,i,f,t);case k:G=8,i|=8;break;case w:return e=rn(12,n,t,i|2),e.elementType=w,e.lanes=f,e;case P:return e=rn(13,n,t,i),e.elementType=P,e.lanes=f,e;case D:return e=rn(19,n,t,i),e.elementType=D,e.lanes=f,e;case b:return ea(n,i,f,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case m:G=10;break e;case h:G=9;break e;case S:G=11;break e;case u:G=14;break e;case o:G=16,r=null;break e}throw Error(a(130,e==null?e:typeof e,""))}return t=rn(G,n,t,i),t.elementType=e,t.type=r,t.lanes=f,t}function sr(e,t,n,r){return e=rn(7,e,r,t),e.lanes=n,e}function ea(e,t,n,r){return e=rn(22,e,r,t),e.elementType=b,e.lanes=n,e.stateNode={isHidden:!1},e}function Go(e,t,n){return e=rn(6,e,null,t),e.lanes=n,e}function Bo(e,t,n){return t=rn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function t0(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=de,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tt(0),this.expirationTimes=Tt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tt(0),this.identifierPrefix=r,this.onRecoverableError=i,Ce&&(this.mutableSourceEagerHydrationData=null)}function ac(e,t,n,r,i,f,G,J,ee){return e=new t0(e,t,n,J,ee),t===1?(t=1,f===!0&&(t|=8)):t=0,f=rn(3,null,null,t),e.current=f,f.stateNode=e,f.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xa(f),e}function oc(e){if(!e)return an;e=e._reactInternals;e:{if(A(e)!==e||e.tag!==1)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(F(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(a(171))}if(e.tag===1){var n=e.type;if(F(n))return Y(e,n,t)}return t}function lc(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=q(t),e===null?null:e.stateNode}function dc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ta(e,t){dc(e,t),(e=e.alternate)&&dc(e,t)}function n0(e){return e=q(e),e===null?null:e.stateNode}function r0(){return null}return L.attemptContinuousHydration=function(e){if(e.tag===13){var t=vn(e,134217728);if(t!==null){var n=It();nn(t,e,134217728,n)}ta(e,134217728)}},L.attemptDiscreteHydration=function(e){if(e.tag===13){var t=vn(e,1);if(t!==null){var n=It();nn(t,e,1,n)}ta(e,1)}},L.attemptHydrationAtCurrentPriority=function(e){if(e.tag===13){var t=Vn(e),n=vn(e,t);if(n!==null){var r=It();nn(n,e,t,r)}ta(e,t)}},L.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=qe(t.pendingLanes);n!==0&&(Bn(t,n|1),Ut(t,vt()),(Me&6)===0&&(Rr(),yn()))}break;case 13:Ju(function(){var r=vn(e,1);if(r!==null){var i=It();nn(r,e,1,i)}}),ta(e,1)}},L.batchedUpdates=function(e,t){var n=Me;Me|=1;try{return e(t)}finally{Me=n,Me===0&&(Rr(),ys&&yn())}},L.createComponentSelector=function(e){return{$$typeof:Bs,value:e}},L.createContainer=function(e,t,n,r,i,f,G){return ac(e,t,!1,null,n,r,i,f,G)},L.createHasPseudoClassSelector=function(e){return{$$typeof:Us,value:e}},L.createHydrationContainer=function(e,t,n,r,i,f,G,J,ee){return e=ac(n,r,!0,e,i,f,G,J,ee),e.context=oc(null),n=e.current,r=It(),i=Vn(n),f=Nn(r,i),f.callback=t??null,jn(n,f,i),e.current.lanes=i,ot(e,i,r),Ut(e,r),e},L.createPortal=function(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}},L.createRoleSelector=function(e){return{$$typeof:js,value:e}},L.createTestNameSelector=function(e){return{$$typeof:Hs,value:e}},L.createTextSelector=function(e){return{$$typeof:Ws,value:e}},L.deferredUpdates=function(e){var t=Oe,n=lt.transition;try{return lt.transition=null,Oe=16,e()}finally{Oe=t,lt.transition=n}},L.discreteUpdates=function(e,t,n,r,i){var f=Oe,G=lt.transition;try{return lt.transition=null,Oe=1,e(t,n,r,i)}finally{Oe=f,lt.transition=G,Me===0&&Rr()}},L.findAllNodes=Po,L.findBoundingRects=function(e,t){if(!dt)throw Error(a(363));t=Po(e,t),e=[];for(var n=0;n<t.length;n++)e.push(He(t[n]));for(t=e.length-1;0<t;t--){n=e[t];for(var r=n.x,i=r+n.width,f=n.y,G=f+n.height,J=t-1;0<=J;J--)if(t!==J){var ee=e[J],ue=ee.x,_e=ue+ee.width,Ee=ee.y,me=Ee+ee.height;if(r>=ue&&f>=Ee&&i<=_e&&G<=me){e.splice(t,1);break}else if(r!==ue||n.width!==ee.width||me<f||Ee>G){if(!(f!==Ee||n.height!==ee.height||_e<r||ue>i)){ue>r&&(ee.width+=ue-r,ee.x=r),_e<i&&(ee.width=i-ue),e.splice(t,1);break}}else{Ee>f&&(ee.height+=Ee-f,ee.y=f),me<G&&(ee.height=G-Ee),e.splice(t,1);break}}}return e},L.findHostInstance=lc,L.findHostInstanceWithNoPortals=function(e){return e=B(e),e=e!==null?_(e):null,e===null?null:e.stateNode},L.findHostInstanceWithWarning=function(e){return lc(e)},L.flushControlled=function(e){var t=Me;Me|=1;var n=lt.transition,r=Oe;try{lt.transition=null,Oe=1,e()}finally{Oe=r,lt.transition=n,Me=t,Me===0&&(Rr(),yn())}},L.flushPassiveEffects=ir,L.flushSync=Ju,L.focusWithin=function(e,t){if(!dt)throw Error(a(363));for(e=bo(e),t=Ku(e,t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!st(n)){if(n.tag===5&&ht(n.stateNode))return!0;for(n=n.child;n!==null;)t.push(n),n=n.sibling}}return!1},L.getCurrentUpdatePriority=function(){return Oe},L.getFindAllNodesFailureDescription=function(e,t){if(!dt)throw Error(a(363));var n=0,r=[];e=[bo(e),0];for(var i=0;i<e.length;){var f=e[i++],G=e[i++],J=t[G];if((f.tag!==5||!st(f))&&(ko(f,J)&&(r.push(Eo(J)),G++,G>n&&(n=G)),G<t.length))for(f=f.child;f!==null;)e.push(f,G),f=f.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Eo(t[n]));return`findAllNodes was able to match part of the selector:
  `+(r.join(" > ")+`

No matching component was found for:
  `)+e.join(" > ")}return null},L.getPublicRootInstance=function(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return O(e.child.stateNode);default:return e.child.stateNode}},L.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:n0,findFiberByHostInstance:e.findFiberByHostInstance||r0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{ms=t.inject(e),mn=t}catch{}e=!!t.checkDCE}}return e},L.isAlreadyRendering=function(){return!1},L.observeVisibleRects=function(e,t,n,r){if(!dt)throw Error(a(363));e=Po(e,t);var i=Kt(e,n,r).disconnect;return{disconnect:function(){i()}}},L.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},L.runWithPriority=function(e,t){var n=Oe;try{return Oe=e,t()}finally{Oe=n}},L.shouldError=function(){return null},L.shouldSuspend=function(){return!1},L.updateContainer=function(e,t,n,r){var i=t.current,f=It(),G=Vn(i);return n=oc(n),t.context===null?t.context=n:t.pendingContext=n,t=Nn(f,G),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=jn(i,t,G),e!==null&&(nn(e,i,G,f),ks(e,i,G)),G},L}),wa}var ad;function ih(){return ad||(ad=1,va.exports=rh()),va.exports}var sh=ih();const ah=Ui(sh);var Sa={exports:{}},zn={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var od;function oh(){return od||(od=1,zn.ConcurrentRoot=1,zn.ContinuousEventPriority=4,zn.DefaultEventPriority=16,zn.DiscreteEventPriority=1,zn.IdleEventPriority=536870912,zn.LegacyRoot=0),zn}var ld;function lh(){return ld||(ld=1,Sa.exports=oh()),Sa.exports}var dd=lh(),dh=Re();const ud={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let cd=!1,hd=!1;const Ca=".react-konva-event",uh=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,ch=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,hh={};function Yi(s,d,L=hh){if(!cd&&"zIndex"in d&&(console.warn(ch),cd=!0),!hd&&d.draggable){var z=d.x!==void 0||d.y!==void 0,R=d.onDragEnd||d.onDragMove;z&&!R&&(console.warn(uh),hd=!0)}for(var x in L)if(!ud[x]){var a=x.slice(0,2)==="on",c=L[x]!==d[x];if(a&&c){var g=x.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),s.off(g,L[x])}var y=!d.hasOwnProperty(x);y&&s.setAttr(x,void 0)}var v=d._useStrictMode,k={},w=!1;const m={};for(var x in d)if(!ud[x]){var a=x.slice(0,2)==="on",h=L[x]!==d[x];if(a&&h){var g=x.substr(2).toLowerCase();g.substr(0,7)==="content"&&(g="content"+g.substr(7,1).toUpperCase()+g.substr(8)),d[x]&&(m[g]=d[x])}!a&&(d[x]!==L[x]||v&&d[x]!==s.getAttr(x))&&(w=!0,k[x]=d[x])}w&&(s.setAttrs(k),Dn(s));for(var g in m)s.on(g+Ca,m[g])}function Dn(s){if(!dh.Konva.autoDrawEnabled){var d=s.getLayer()||s.getStage();d&&d.batchDraw()}}var ba=id();const fd={},fh={};xi.Node.prototype._applyProps=Yi;function gh(s,d){if(typeof d=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${d}`);return}s.add(d),Dn(s)}function ph(s,d,L){let z=xi[s];z||(console.error(`Konva has no node with the type ${s}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${s}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),z=xi.Group);const R={},x={};for(var a in d){var c=a.slice(0,2)==="on";c?x[a]=d[a]:R[a]=d[a]}const g=new z(R);return Yi(g,x),g}function mh(s,d,L){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${s}"`)}function yh(s,d,L){return!1}function vh(s){return s}function xh(){return null}function _h(){return null}function wh(s,d,L,z){return fh}function Sh(){}function Ch(s){}function bh(s,d){return!1}function kh(){return fd}function Eh(){return fd}const Ph=setTimeout,Th=clearTimeout,Rh=-1;function Fh(s,d){return!1}const Nh=!1,Ih=!0,Mh=!0;function Ah(s,d){d.parent===s?d.moveToTop():s.add(d),Dn(s)}function Lh(s,d){d.parent===s?d.moveToTop():s.add(d),Dn(s)}function gd(s,d,L){d._remove(),s.add(d),d.setZIndex(L.getZIndex()),Dn(s)}function zh(s,d,L){gd(s,d,L)}function Dh(s,d){d.destroy(),d.off(Ca),Dn(s)}function Oh(s,d){d.destroy(),d.off(Ca),Dn(s)}function Gh(s,d,L){console.error(`Text components are not yet supported in ReactKonva. You text is: "${L}"`)}function Bh(s,d,L){}function Uh(s,d,L,z,R){Yi(s,R,z)}function jh(s){s.hide(),Dn(s)}function Hh(s){}function Wh(s,d){(d.visible==null||d.visible)&&s.show()}function Vh(s,d){}function qh(s){}function Yh(){}const Kh=Object.freeze(Object.defineProperty({__proto__:null,appendChild:Ah,appendChildToContainer:Lh,appendInitialChild:gh,cancelTimeout:Th,clearContainer:qh,commitMount:Bh,commitTextUpdate:Gh,commitUpdate:Uh,createInstance:ph,createTextInstance:mh,detachDeletedInstance:Yh,finalizeInitialChildren:yh,getChildHostContext:Eh,getCurrentEventPriority:()=>dd.DefaultEventPriority,getPublicInstance:vh,getRootHostContext:kh,hideInstance:jh,hideTextInstance:Hh,idlePriority:ba.unstable_IdlePriority,insertBefore:gd,insertInContainerBefore:zh,isPrimaryRenderer:Nh,noTimeout:Rh,now:ba.unstable_now,prepareForCommit:xh,preparePortalMount:_h,prepareUpdate:wh,removeChild:Dh,removeChildFromContainer:Oh,resetAfterCommit:Sh,resetTextContent:Ch,run:ba.unstable_runWithPriority,scheduleTimeout:Ph,shouldDeprioritizeSubtree:bh,shouldSetTextContent:Fh,supportsMutation:Mh,unhideInstance:Wh,unhideTextInstance:Vh,warnsIfNotActing:Ih},Symbol.toStringTag,{value:"Module"}));var Xh=Object.defineProperty,Qh=Object.defineProperties,Jh=Object.getOwnPropertyDescriptors,pd=Object.getOwnPropertySymbols,Zh=Object.prototype.hasOwnProperty,$h=Object.prototype.propertyIsEnumerable,md=(s,d,L)=>d in s?Xh(s,d,{enumerable:!0,configurable:!0,writable:!0,value:L}):s[d]=L,yd=(s,d)=>{for(var L in d||(d={}))Zh.call(d,L)&&md(s,L,d[L]);if(pd)for(var L of pd(d))$h.call(d,L)&&md(s,L,d[L]);return s},ef=(s,d)=>Qh(s,Jh(d)),vd,xd;typeof window<"u"&&((vd=window.document)!=null&&vd.createElement||((xd=window.navigator)==null?void 0:xd.product)==="ReactNative")?zt.useLayoutEffect:zt.useEffect;function _d(s,d,L){if(!s)return;if(L(s)===!0)return s;let z=s.child;for(;z;){const R=_d(z,d,L);if(R)return R;z=z.sibling}}function wd(s){try{return Object.defineProperties(s,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return s}}const Sd=console.error;console.error=function(){const s=[...arguments].join("");if(s!=null&&s.startsWith("Warning:")&&s.includes("useContext")){console.error=Sd;return}return Sd.apply(this,arguments)};const ka=wd(zt.createContext(null));class Cd extends zt.Component{render(){return zt.createElement(ka.Provider,{value:this._reactInternals},this.props.children)}}function tf(){const s=zt.useContext(ka);if(s===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const d=zt.useId();return zt.useMemo(()=>{for(const z of[s,s==null?void 0:s.alternate]){if(!z)continue;const R=_d(z,!1,x=>{let a=x.memoizedState;for(;a;){if(a.memoizedState===d)return!0;a=a.next}});if(R)return R}},[s,d])}function nf(){const s=tf(),[d]=zt.useState(()=>new Map);d.clear();let L=s;for(;L;){if(L.type&&typeof L.type=="object"){const R=L.type._context===void 0&&L.type.Provider===L.type?L.type:L.type._context;R&&R!==ka&&!d.has(R)&&d.set(R,zt.useContext(wd(R)))}L=L.return}return d}function rf(){const s=nf();return zt.useMemo(()=>Array.from(s.keys()).reduce((d,L)=>z=>zt.createElement(d,null,zt.createElement(L.Provider,ef(yd({},z),{value:s.get(L)}))),d=>zt.createElement(Cd,yd({},d))),[s])}function sf(s){const d=he.useRef({});return he.useLayoutEffect(()=>{d.current=s}),he.useLayoutEffect(()=>()=>{d.current={}},[]),d.current}const af=s=>{const d=he.useRef(),L=he.useRef(),z=he.useRef(),R=sf(s),x=rf(),a=c=>{const{forwardedRef:g}=s;g&&(typeof g=="function"?g(c):g.current=c)};return he.useLayoutEffect(()=>(L.current=new xi.Stage({width:s.width,height:s.height,container:d.current}),a(L.current),z.current=_i.createContainer(L.current,dd.LegacyRoot,!1,null),_i.updateContainer(he.createElement(x,{},s.children),z.current),()=>{xi.isBrowser&&(a(null),_i.updateContainer(null,z.current,null),L.current.destroy())}),[]),he.useLayoutEffect(()=>{a(L.current),Yi(L.current,s,R),_i.updateContainer(he.createElement(x,{},s.children),z.current,null)}),he.createElement("div",{ref:d,id:s.id,accessKey:s.accessKey,className:s.className,role:s.role,style:s.style,tabIndex:s.tabIndex,title:s.title})},of="Layer",bd="Group",kd="Rect",Ed="Image",Pd="Text",lf="TextPath",df="Transformer",_i=ah(Kh);_i.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:he.version,rendererPackageName:"react-konva"});const uf=he.forwardRef((s,d)=>he.createElement(Cd,{},he.createElement(af,{...s,forwardedRef:d})));var Ea,Td;function cf(){if(Td)return Ea;Td=1;var s=he;return Ea=function(L,z,R){const x=s.useRef("loading"),a=s.useRef(),[c,g]=s.useState(0),y=s.useRef(),v=s.useRef(),k=s.useRef();return(y.current!==L||v.current!==z||k.current!==R)&&(x.current="loading",a.current=void 0,y.current=L,v.current=z,k.current=R),s.useLayoutEffect(function(){if(!L)return;var w=document.createElement("img");function m(){w.decode().catch(()=>{}).finally(()=>{x.current="loaded",a.current=w,g(Math.random())})}function h(){x.current="failed",a.current=void 0,g(Math.random())}return w.addEventListener("load",m),w.addEventListener("error",h),z&&(w.crossOrigin=z),R&&(w.referrerPolicy=R),w.src=L,function(){w.removeEventListener("load",m),w.removeEventListener("error",h)}},[L,z,R]),[a.current,x.current]},Ea}var hf=cf();const Rd=Ui(hf),fn=[{id:"arial",family:"Arial",displayName:"Arial",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/arial/arial-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/arial/arial-bold.woff2"}},fallback:"sans-serif"},{id:"roboto",family:"Roboto",displayName:"Roboto",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/roboto/roboto-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/roboto/roboto-bold.woff2"}},fallback:"sans-serif"},{id:"open-sans",family:"Open Sans",displayName:"Open Sans",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/open-sans/open-sans-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/open-sans/open-sans-bold.woff2"}},fallback:"sans-serif"},{id:"lato",family:"Lato",displayName:"Lato",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/lato/lato-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/lato/lato-bold.woff2"}},fallback:"sans-serif"},{id:"montserrat",family:"Montserrat",displayName:"Montserrat",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/montserrat/montserrat-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/montserrat/montserrat-bold.woff2"}},fallback:"sans-serif"},{id:"raleway",family:"Raleway",displayName:"Raleway",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/raleway/raleway-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/raleway/raleway-bold.woff2"}},fallback:"sans-serif"},{id:"poppins",family:"Poppins",displayName:"Poppins",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/poppins/poppins-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/poppins/poppins-bold.woff2"}},fallback:"sans-serif"},{id:"archivo",family:"Archivo",displayName:"Archivo",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/archivo/archivo-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/archivo/archivo-bold.woff2"}},fallback:"sans-serif"},{id:"archivo-narrow",family:"Archivo Narrow",displayName:"Archivo Narrow",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/archivo-narrow/archivo-narrow-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/archivo-narrow/archivo-narrow-bold.woff2"}},fallback:"sans-serif"},{id:"barlow-semi-condensed",family:"Barlow Semi Condensed",displayName:"Barlow Semi Condensed",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/barlow-semi-condensed/barlow-semi-condensed-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/barlow-semi-condensed/barlow-semi-condensed-bold.woff2"}},fallback:"sans-serif"},{id:"alumni-sans",family:"Alumni Sans",displayName:"Alumni Sans",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/alumni-sans/alumni-sans-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/alumni-sans/alumni-sans-bold.woff2"}},fallback:"sans-serif"},{id:"arimo",family:"Arimo",displayName:"Arimo",category:"sans-serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/arimo/arimo-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/arimo/arimo-bold.woff2"}},fallback:"sans-serif"},{id:"times-new-roman",family:"Times New Roman",displayName:"Times New Roman",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/times-new-roman/times-new-roman-regular.woff2"}},fallback:"serif"},{id:"georgia",family:"Georgia",displayName:"Georgia",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/georgia/georgia-regular.woff2"}},fallback:"serif"},{id:"playfair-display",family:"Playfair Display",displayName:"Playfair Display",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/playfair-display/playfair-display-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/playfair-display/playfair-display-bold.woff2"}},fallback:"serif"},{id:"merriweather",family:"Merriweather",displayName:"Merriweather",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/merriweather/merriweather-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/merriweather/merriweather-bold.woff2"}},fallback:"serif"},{id:"lora",family:"Lora",displayName:"Lora",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/lora/lora-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/lora/lora-bold.woff2"}},fallback:"serif"},{id:"abril-fatface",family:"Abril Fatface",displayName:"Abril Fatface",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/abril-fatface/abril-fatface-regular.woff2"}},fallback:"serif"},{id:"antic-slab",family:"Antic Slab",displayName:"Antic Slab",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/antic-slab/antic-slab-regular.woff2"}},fallback:"serif"},{id:"bellota",family:"Bellota",displayName:"Bellota",category:"serif",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/bellota/bellota-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/bellota/bellota-bold.woff2"}},fallback:"serif"},{id:"bebas-neue",family:"Bebas Neue",displayName:"Bebas Neue",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/bebas-neue/bebas-neue-regular.woff2"}},fallback:"sans-serif"},{id:"oswald",family:"Oswald",displayName:"Oswald",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/oswald/oswald-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/oswald/oswald-bold.woff2"}},fallback:"sans-serif"},{id:"anton",family:"Anton",displayName:"Anton",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/anton/anton-regular.woff2"}},fallback:"sans-serif"},{id:"righteous",family:"Righteous",displayName:"Righteous",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/righteous/righteous-regular.woff2"}},fallback:"sans-serif"},{id:"bowlby-one",family:"Bowlby One",displayName:"Bowlby One",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/bowlby-one/bowlby-one-regular.woff2"}},fallback:"sans-serif"},{id:"boogaloo",family:"Boogaloo",displayName:"Boogaloo",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/boogaloo/boogaloo-regular.woff2"}},fallback:"sans-serif"},{id:"fredoka-one",family:"Fredoka One",displayName:"Fredoka One",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/fredoka-one/fredoka-one-regular.woff2"}},fallback:"sans-serif"},{id:"pacifico",family:"Pacifico",displayName:"Pacifico",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/pacifico/pacifico-regular.woff2"}},fallback:"cursive"},{id:"lobster",family:"Lobster",displayName:"Lobster",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/lobster/lobster-regular.woff2"}},fallback:"cursive"},{id:"amaranth",family:"Amaranth",displayName:"Amaranth",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/amaranth/amaranth-regular.woff2"}},fallback:"sans-serif"},{id:"bevan",family:"Bevan",displayName:"Bevan",category:"display",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/bevan/bevan-regular.woff2"}},fallback:"serif"},{id:"alex-brush",family:"Alex Brush",displayName:"Alex Brush",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/alex-brush/alex-brush-regular.woff2"}},fallback:"cursive"},{id:"allison",family:"Allison",displayName:"Allison",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/allison/allison-regular.woff2"}},fallback:"cursive"},{id:"dancing-script",family:"Dancing Script",displayName:"Dancing Script",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/dancing-script/dancing-script-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/dancing-script/dancing-script-bold.woff2"}},fallback:"cursive"},{id:"great-vibes",family:"Great Vibes",displayName:"Great Vibes",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/great-vibes/great-vibes-regular.woff2"}},fallback:"cursive"},{id:"parisienne",family:"Parisienne",displayName:"Parisienne",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/parisienne/parisienne-regular.woff2"}},fallback:"cursive"},{id:"sacramento",family:"Sacramento",displayName:"Sacramento",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/sacramento/sacramento-regular.woff2"}},fallback:"cursive"},{id:"caveat",family:"Caveat",displayName:"Caveat",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/caveat/caveat-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/caveat/caveat-bold.woff2"}},fallback:"cursive"},{id:"kalam",family:"Kalam",displayName:"Kalam",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/kalam/kalam-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/kalam/kalam-bold.woff2"}},fallback:"cursive"},{id:"satisfy",family:"Satisfy",displayName:"Satisfy",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/satisfy/satisfy-regular.woff2"}},fallback:"cursive"},{id:"amatic-sc",family:"Amatic SC",displayName:"Amatic SC",category:"script",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/amatic-sc/amatic-sc-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/amatic-sc/amatic-sc-bold.woff2"}},fallback:"cursive"},{id:"courier-new",family:"Courier New",displayName:"Courier New",category:"monospace",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/courier-new/courier-new-regular.woff2"}},fallback:"monospace"},{id:"roboto-mono",family:"Roboto Mono",displayName:"Roboto Mono",category:"monospace",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/roboto-mono/roboto-mono-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/roboto-mono/roboto-mono-bold.woff2"}},fallback:"monospace"},{id:"source-code-pro",family:"Source Code Pro",displayName:"Source Code Pro",category:"monospace",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/source-code-pro/source-code-pro-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/source-code-pro/source-code-pro-bold.woff2"}},fallback:"monospace"},{id:"ibm-plex-mono",family:"IBM Plex Mono",displayName:"IBM Plex Mono",category:"monospace",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/ibm-plex-mono/ibm-plex-mono-regular.woff2"},700:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/ibm-plex-mono/ibm-plex-mono-bold.woff2"}},fallback:"monospace"},{id:"jetbrains-mono",family:"JetBrains Mono",displayName:"JetBrains Mono",category:"monospace",weights:{400:{style:"normal",url:"https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/jetbrains-mono/jetbrains-mono-regular.woff2"}},fallback:"monospace"}].map(s=>({...s,previewUrl:`https://shopify-designs.s3.us-west-1.amazonaws.com/fonts/${s.id}/preview.png?v=3`}));function ff(s){return fn.filter(d=>d.category===s)}const Fd=fn[0],Qn=class Qn{constructor(){na(this,"loadedFonts",new Set);na(this,"loadingFonts",new Map);["Arial","Times New Roman","Georgia","Courier New"].forEach(L=>{this.loadedFonts.add(`${L}-400`),this.loadedFonts.add(`${L}-700`)})}static getInstance(){return Qn.instance||(Qn.instance=new Qn),Qn.instance}async loadFont(d,L=400){const z=`${d.family}-${L}`;if(this.loadedFonts.has(z))return Promise.resolve();if(this.loadingFonts.has(z))return this.loadingFonts.get(z);if(["Arial","Times New Roman","Georgia","Courier New"].includes(d.family))return this.loadedFonts.add(z),Promise.resolve();const x=d.weights[L];if(!x)return console.warn(`Weight ${L} not available for ${d.family}`),Promise.resolve();const a=this.loadFontFace(d,L,x);this.loadingFonts.set(z,a);try{await a,this.loadedFonts.add(z)}finally{this.loadingFonts.delete(z)}}async loadFontFace(d,L,z){try{if(typeof FontFace>"u"){this.injectFontFace(d,L,z);return}const R=new FontFace(d.family,`url(${z.url})`,{weight:L.toString(),style:z.style,display:"swap"});await R.load(),document.fonts.add(R),await document.fonts.ready}catch(R){console.error(`Failed to load font ${d.family}:`,R),this.injectFontFace(d,L,z)}}injectFontFace(d,L,z){const R=`font-${d.id}-${L}`;if(document.getElementById(R))return;const x=document.createElement("style");x.id=R,x.textContent=`
      @font-face {
        font-family: '${d.family}';
        src: url('${z.url}') format('woff2');
        font-weight: ${L};
        font-style: ${z.style};
        font-display: swap;
      }
    `,document.head.appendChild(x)}async preloadFonts(d){const L=d.map(z=>{const R=fn.find(x=>x.id===z);if(R){const x=Object.keys(R.weights).map(a=>parseInt(a));return Promise.all(x.map(a=>this.loadFont(R,a)))}return Promise.resolve()});await Promise.all(L)}isFontLoaded(d,L=400){return this.loadedFonts.has(`${d}-${L}`)}getLoadedFonts(){return Array.from(this.loadedFonts)}async preloadAllFonts(){console.log("Preloading all fonts...");const d=fn.map(L=>{const z=Object.keys(L.weights).map(R=>parseInt(R));return Promise.all(z.map(R=>this.loadFont(L,R)))});await Promise.all(d),console.log(`All ${fn.length} fonts loaded!`)}async loadFontByFamily(d,L=400){const z=fn.find(R=>R.family===d);z?await this.loadFont(z,L):console.warn(`Font family "${d}" not found in curated fonts`)}};na(Qn,"instance");let Ki=Qn;const wi=Ki.getInstance(),Pa=Ki.getInstance(),gf=[{id:"all",label:"All Fonts"},{id:"sans-serif",label:"Sans Serif"},{id:"serif",label:"Serif"},{id:"display",label:"Display"},{id:"script",label:"Script"},{id:"monospace",label:"Monospace"}],pf="The quick brown fox jumps over the lazy dog",Nd="designer-recent-fonts",Id=8;function mf({isOpen:s,onClose:d,onSelectFont:L,currentFont:z,previewText:R=pf}){const[x,a]=he.useState(""),[c,g]=he.useState("all"),[y,v]=he.useState([]),[k,w]=he.useState(new Set),[m,h]=he.useState(new Set),[S,P]=he.useState(new Set),D=he.useRef(null),u=he.useRef(new Map);he.useRef([]),he.useRef(!1),he.useEffect(()=>{const U=localStorage.getItem(Nd);if(U)try{v(JSON.parse(U))}catch(N){console.error("Failed to load recent fonts:",N)}},[]),he.useEffect(()=>{if(!s)return;const U=new IntersectionObserver(N=>{N.forEach(A=>{if(A.isIntersecting){const E=A.target.getAttribute("data-font-id");E&&h(B=>B.has(E)?B:(console.log("Font becoming visible:",E),new Set(B).add(E)))}})},{root:null,rootMargin:"50px",threshold:.1});return D.current=U,setTimeout(()=>{let N=0;u.current.forEach((A,E)=>{if(N>=5)return;const B=A.getBoundingClientRect();B.top<window.innerHeight&&B.bottom>0&&(console.log("Font initially in viewport:",E),h(l=>new Set(l).add(E)),N++)})},100),()=>{U.disconnect(),u.current.clear(),h(new Set)}},[s]);const o=he.useMemo(()=>fn.filter(U=>{if(c!=="all"&&U.category!==c)return!1;if(x){const N=x.toLowerCase();return U.displayName.toLowerCase().includes(N)||U.family.toLowerCase().includes(N)}return!0}),[x,c]),b=he.useMemo(()=>y.map(U=>fn.find(N=>N.family===U)).filter(U=>U!==void 0).slice(0,Id),[y]),I=async U=>{w(N=>new Set(N).add(U.id));try{await Pa.loadFont(U);const N=[U.family,...y.filter(A=>A!==U.family)].slice(0,Id);v(N),localStorage.setItem(Nd,JSON.stringify(N)),L(U.family),d()}catch(N){console.error("Failed to load font:",N)}finally{w(N=>{const A=new Set(N);return A.delete(U.id),A})}},M=({font:U,isRecent:N=!1})=>{const A=N||m.has(U.id),E=k.has(U.id),B=U.family===z,q=S.has(U.id)||Pa.isFontLoaded(U.family);return he.useEffect(()=>{A&&!q&&!E&&(console.log(`Loading font: ${U.family}`),w(l=>new Set(l).add(U.id)),Pa.loadFont(U).then(()=>{console.log(`Font loaded: ${U.family}`),w(l=>{const _=new Set(l);return _.delete(U.id),_}),P(l=>new Set(l).add(U.id))}).catch(l=>{console.error(`Failed to load font ${U.family}:`,l),w(_=>{const C=new Set(_);return C.delete(U.id),C})}))},[A,q,E,U]),K.jsxs("div",{ref:l=>{if(l&&!N)u.current.has(U.id)||(u.current.set(U.id,l),D.current&&D.current.observe(l));else if(!l&&!N&&u.current.has(U.id)){const _=u.current.get(U.id);_&&D.current&&D.current.unobserve(_),u.current.delete(U.id)}},"data-font-id":U.id,onClick:()=>!E&&I(U),style:{padding:"12px 16px",borderRadius:"6px",cursor:E?"wait":"pointer",backgroundColor:B?"#e3f2fd":"transparent",border:B?"2px solid #0066ff":"1px solid #e0e0e0",transition:"all 0.2s",opacity:E?.6:1,minHeight:"60px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"16px"},onMouseEnter:l=>{!B&&!E&&(l.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:l=>{B||(l.currentTarget.style.backgroundColor="transparent")},children:[K.jsxs("div",{style:{flex:1,minWidth:0},children:[K.jsx("div",{style:{fontSize:"13px",color:"#666",marginBottom:"4px"},children:U.displayName}),A?K.jsx("div",{style:{fontFamily:q?U.family:U.fallback,fontSize:"18px",lineHeight:1.2,color:"#000",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R}):K.jsx("div",{style:{fontSize:"18px",color:"#ccc",fontStyle:"italic"},children:"Loading..."})]}),K.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[U.weights&&Object.keys(U.weights).length>1&&K.jsxs("span",{style:{fontSize:"12px",color:"#999"},children:[Object.keys(U.weights).length," weights"]}),q&&K.jsx("span",{style:{fontSize:"12px",color:"#4caf50"},children:"✓"}),E&&K.jsx("span",{style:{fontSize:"12px",color:"#666",animation:"pulse 1.5s ease-in-out infinite"},children:"⏳"})]})]})};return s?K.jsxs(K.Fragment,{children:[K.jsx("div",{onClick:d,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:2e3,animation:"fadeIn 0.2s ease-out"}}),K.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",borderRadius:"12px",width:"90%",maxWidth:"900px",height:"80vh",maxHeight:"700px",display:"flex",flexDirection:"column",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.15)",zIndex:2001,animation:"slideIn 0.3s ease-out"},children:[K.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e0e0e0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[K.jsx("h2",{style:{margin:0,fontSize:"24px",fontWeight:600},children:"Choose a Font"}),K.jsx("button",{onClick:d,style:{width:"36px",height:"36px",borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",color:"#666",transition:"all 0.2s"},onMouseEnter:U=>{U.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:U=>{U.currentTarget.style.backgroundColor="transparent"},children:"×"})]}),K.jsxs("div",{style:{padding:"16px 24px",borderBottom:"1px solid #e0e0e0",display:"flex",gap:"16px",flexWrap:"wrap",alignItems:"center"},children:[K.jsx("input",{type:"text",placeholder:"Search fonts...",value:x,onChange:U=>a(U.target.value),style:{flex:"1",minWidth:"200px",padding:"8px 12px",fontSize:"14px",border:"1px solid #ddd",borderRadius:"6px",outline:"none"},onFocus:U=>{U.currentTarget.style.borderColor="#0066ff"},onBlur:U=>{U.currentTarget.style.borderColor="#ddd"}}),K.jsx("div",{style:{display:"flex",gap:"8px"},children:gf.map(U=>K.jsx("button",{onClick:()=>g(U.id),style:{padding:"6px 12px",fontSize:"14px",border:"none",borderRadius:"20px",backgroundColor:c===U.id?"#0066ff":"#f0f0f0",color:c===U.id?"white":"#666",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:N=>{c!==U.id&&(N.currentTarget.style.backgroundColor="#e0e0e0")},onMouseLeave:N=>{c!==U.id&&(N.currentTarget.style.backgroundColor="#f0f0f0")},children:U.label},U.id))})]}),K.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"24px"},children:[b.length>0&&c==="all"&&!x&&K.jsxs("div",{style:{marginBottom:"32px"},children:[K.jsx("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:"#333"},children:"Recently Used"}),K.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:b.map(U=>K.jsx(M,{font:U,isRecent:!0},U.id))})]}),K.jsxs("div",{children:[c==="all"&&!x&&b.length>0&&K.jsx("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:"#333"},children:"All Fonts"}),K.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:o.map(U=>K.jsx(M,{font:U},U.id))}),o.length===0&&K.jsxs("div",{style:{textAlign:"center",padding:"48px",color:"#666"},children:['No fonts found matching "',x,'"']})]})]})]}),K.jsx("style",{dangerouslySetInnerHTML:{__html:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translate(-50%, -48%);
          }
          to {
            opacity: 1;
            transform: translate(-50%, -50%);
          }
        }
        
        @keyframes pulse {
          0% { opacity: 0.6; }
          50% { opacity: 1; }
          100% { opacity: 0.6; }
        }
      `}})]}):null}const yf=({imageElement:s,onSelect:d,onChange:L,onDragEnd:z,onTransformEnd:R})=>{const[x]=Rd(s.url,"anonymous"),a=he.useRef(null);return K.jsx(Ed,{ref:a,id:s.id,image:x,x:s.x+s.width/2,y:s.y+s.height/2,width:s.width,height:s.height,offsetX:s.width/2,offsetY:s.height/2,rotation:s.rotation||0,draggable:!0,onClick:d,onTap:d,onDragEnd:c=>{const g=c.target;L({x:g.x()-s.width/2,y:g.y()-s.height/2}),z&&z()},onTransformEnd:()=>{const c=a.current,g=c.scaleX(),y=c.scaleY(),v=Math.max(5,c.width()*g),k=Math.max(5,c.height()*y);c.scaleX(1),c.scaleY(1),c.offsetX(v/2),c.offsetY(k/2),L({x:c.x()-v/2,y:c.y()-k/2,width:v,height:k,rotation:c.rotation()}),R&&R()}})},vf=({initialTemplate:s,productLayout:d,shopifyProduct:L,shopifyVariant:z,initialState:R,onSave:x,isAdminView:a=!0,templateColors:c=[],initialColorVariant:g})=>{var ts,ns,rs,is,ss,as,os,ls,ds,us,cs,hs,fs,gs,fr,Gn,gr,pr,ps,mr,Pn,sn,We,je,an,ft,St,pn;const y=he.useRef(null),v=he.useRef(null),k=he.useRef(null),[w,m]=he.useState({width:z?1368:(d==null?void 0:d.width)||1e3,height:z?1368:(d==null?void 0:d.height)||1e3}),[h,S]=he.useState({width:800,height:600}),P=()=>{var p;if((p=z==null?void 0:z.image)!=null&&p.url)return z.image.url;if(d&&(s!=null&&s.colorVariant)){const F=d.variantImages||{},j=s.colorVariant;for(const[V,Y]of Object.entries(F))if(V.startsWith(`${j}-`))return Y}return(d==null?void 0:d.baseImageUrl)||"media/images/8-spot-red-base-image.png"},[D,u]=he.useState(P()),[o,b]=he.useState(null),[I]=Rd(D,D.startsWith("http")?"anonymous":void 0),[M,U]=he.useState([]),[N,A]=he.useState([]),[E,B]=he.useState([]),[q,l]=he.useState([]),[_,C]=he.useState(()=>{if(d!=null&&d.designableArea){const Y=d.designableArea;return Y.shape==="circle"?{width:Y.diameter,height:Y.diameter,cornerRadius:Y.diameter/2,x:Y.x,y:Y.y,visible:!0}:{width:Y.width,height:Y.height,cornerRadius:Y.cornerRadius||0,x:Y.x,y:Y.y,visible:!0}}const p=z?1368:(d==null?void 0:d.width)||1e3,F=z?1368:(d==null?void 0:d.height)||1e3,j=Math.min(p,F)*.744,V=j/2;return{width:j,height:j,cornerRadius:V,x:p/2-V,y:F/2-V,visible:!0}}),[O,W]=he.useState("transparent"),[T,X]=he.useState(null),[Q,ne]=he.useState(!1),[le,ie]=he.useState(!1),[oe,ge]=he.useState([]),[fe,H]=he.useState(null),[te,de]=he.useState(null),ae=he.useRef(null),[ce,ve]=he.useState(!1),[Ce,Fe]=he.useState(!1),[be,$e]=he.useState(!1),[De,Ue]=he.useState(!1),[Mt,dt]=he.useState(g||null),[Wt,He]=he.useState(!1),[ut,st]=he.useState(!1),[Vt,ht]=he.useState(!1),Kt=["arial","roboto","open-sans","montserrat","playfair-display"],Ot=async p=>{try{await wi.loadFontByFamily(p)}catch(F){console.warn(`Failed to load font: ${p}`,F)}};he.useEffect(()=>{(async()=>{await wi.preloadFonts(Kt)})()},[]);const Xt=20,Ie=Math.min((h.width-Xt*2)/w.width,(h.height-Xt*2)/w.height,1);he.useEffect(()=>{const p=z?{width:1368,height:1368}:{width:1e3,height:1e3};m(p),C(F=>({...F,x:p.width/2-F.width/2,y:p.height/2-F.height/2})),console.log(y.current)},[]),he.useEffect(()=>{const p=()=>{if(k.current){const V=k.current.getBoundingClientRect();S({width:V.width,height:V.height})}};setTimeout(p,100),window.addEventListener("resize",p);const F=new ResizeObserver(p);return k.current&&F.observe(k.current),()=>{window.removeEventListener("resize",p),F.disconnect()}},[]),he.useEffect(()=>{var p;if(T&&ae.current){const F=ae.current.getStage(),j=F.findOne("#"+T);if(j){ae.current.nodes([j]),ae.current.getLayer().batchDraw();const V=ae.current.getClientRect(),Y=F.container().getBoundingClientRect();de({x:Y.left+(V.x+V.width/2)*Ie,y:Y.top+(V.y-50)*Ie})}}else de(null),ve(!1),Fe(!1),$e(!1),Ue(!1),ae.current&&(ae.current.nodes([]),(p=ae.current.getLayer())==null||p.batchDraw())},[T,Ie]);const ke=he.useMemo(()=>{const p=[];let F=0;return q.forEach(j=>{p.push({id:j.id,type:"image",zIndex:j.zIndex??F++,data:j})}),M.forEach(j=>{p.push({id:j.id,type:"text",zIndex:j.zIndex??F++,data:j})}),N.forEach(j=>{p.push({id:j.id,type:"gradientText",zIndex:j.zIndex??F++,data:j})}),E.forEach(j=>{p.push({id:j.id,type:"curvedText",zIndex:j.zIndex??F++,data:j})}),p.sort((j,V)=>j.zIndex-V.zIndex)},[M,N,E,q]),yt=(p,F)=>{U(j=>j.map(V=>V.id===p?{...V,zIndex:F}:V)),A(j=>j.map(V=>V.id===p?{...V,zIndex:F}:V)),B(j=>j.map(V=>V.id===p?{...V,zIndex:F}:V)),l(j=>j.map(V=>V.id===p?{...V,zIndex:F}:V))},Et=(p,F)=>{const j=ke.find(Y=>Y.id===p),V=ke.find(Y=>Y.id===F);if(j&&V){const Y=j.zIndex;yt(p,V.zIndex),yt(F,Y)}},Pt=()=>{if(!T)return;const p=ke.find(j=>j.id===T);if(!p)return;const F=ke.filter(j=>j.zIndex>p.zIndex).sort((j,V)=>j.zIndex-V.zIndex)[0];F&&Et(T,F.id)},On=()=>{if(!T)return;const p=ke.find(j=>j.id===T);if(!p)return;const F=ke.filter(j=>j.zIndex<p.zIndex).sort((j,V)=>V.zIndex-j.zIndex)[0];F&&Et(T,F.id)},Si=()=>{if(!T)return;const p=Math.max(...ke.map(F=>F.zIndex),-1);yt(T,p+1)},Xi=()=>{if(!T)return;const p=Math.min(...ke.map(F=>F.zIndex),1);yt(T,p-1)},Ta=()=>{const p=Math.max(...ke.map(j=>j.zIndex),-1)+1,F={id:`text-${Date.now()}`,text:"Hello World",x:_.x+_.width/2-50,y:_.y+_.height/2-12,fontFamily:Fd.family,fontSize:24,fill:"black",rotation:0,scaleX:1,scaleY:1,zIndex:p};U(j=>[...j,F])},Ra=()=>{const p=Math.max(...ke.map(Y=>Y.zIndex),-1)+1,F=100,j=w.height/2-F,V={id:`curved-text-${Date.now()}`,text:"Some Text along a circle radius very big",x:w.width/2,topY:j,radius:F,flipped:!1,fontFamily:Fd.family,fontSize:20,fill:"black",rotation:0,scaleX:1,scaleY:1,zIndex:p};B(Y=>[...Y,V])},lr=p=>{var V;const F=p.target;(F===p.target.getStage()||F.getClassName()==="Layer"||F.getClassName()==="Rect"&&!F.draggable()||F.getClassName()==="Image"&&!F.draggable()||F.getClassName()==="Group"&&!F.draggable())&&(X(null),ve(!1),Fe(!1),$e(!1),Ue(!1),ae.current&&(ae.current.nodes([]),(V=ae.current.getLayer())==null||V.batchDraw()))},Qi=()=>{if(!T)return;const p=Math.max(...ke.map(re=>re.zIndex),-1)+1,F=M.find(re=>re.id===T);if(F){const re={...F,id:`text-${Date.now()}`,x:F.x+20,y:F.y+20,zIndex:p};U(pe=>[...pe,re]),X(re.id);return}const j=E.find(re=>re.id===T);if(j){const re={...j,id:`curved-text-${Date.now()}`,x:j.x+20,topY:j.topY+20,zIndex:p};B(pe=>[...pe,re]),X(re.id);return}const V=N.find(re=>re.id===T);if(V){const re={...V,id:`gradient-text-${Date.now()}`,x:V.x+20,y:V.y+20,zIndex:p};A(pe=>[...pe,re]),X(re.id);return}const Y=q.find(re=>re.id===T);if(Y){const re={...Y,id:`image-${Date.now()}`,x:Y.x+20,y:Y.y+20,zIndex:p};l(pe=>[...pe,re]),X(re.id)}},gn=()=>{if(T&&ae.current&&v.current){const p=v.current,F=ae.current.getClientRect(),j=p.container().getBoundingClientRect();de({x:j.left+(F.x+F.width/2)*Ie,y:j.top+(F.y-50)*Ie})}},Fa=p=>{T&&B(F=>F.map(j=>{if(j.id===T)if(j.flipped){const V=j.radius,Y=j.topY+2*(p-V);return{...j,radius:p,topY:Y}}else return{...j,radius:p};return j}))},Ji=()=>{T&&(B(p=>p.map(F=>F.id===T?{...F,flipped:!F.flipped}:F)),setTimeout(()=>{if(ae.current){const F=ae.current.getStage().findOne("#"+T);F&&(ae.current.nodes([F]),ae.current.forceUpdate())}},0))},Ci=async p=>{if(!T)return;await Ot(p),E.find(Y=>Y.id===T)&&B(Y=>Y.map(re=>re.id===T?{...re,fontFamily:p}:re)),M.find(Y=>Y.id===T)&&U(Y=>Y.map(re=>re.id===T?{...re,fontFamily:p}:re)),N.find(Y=>Y.id===T)&&A(Y=>Y.map(re=>re.id===T?{...re,fontFamily:p}:re)),await document.fonts.ready,setTimeout(()=>{if(v.current&&(v.current.clear(),v.current.getLayers().forEach(Y=>{Y.clear(),Y.batchDraw()})),ae.current){const Y=ae.current.getStage(),re=Y==null?void 0:Y.findOne("#"+T);re&&(ae.current.nodes([re]),ae.current.forceUpdate())}},100)},Na=p=>{if(!T)return;E.find(Y=>Y.id===T)&&B(Y=>Y.map(re=>re.id===T?{...re,fontSize:p}:re)),M.find(Y=>Y.id===T)&&U(Y=>Y.map(re=>re.id===T?{...re,fontSize:p}:re)),N.find(Y=>Y.id===T)&&A(Y=>Y.map(re=>re.id===T?{...re,fontSize:p}:re)),setTimeout(()=>{var Y,re;if(ae.current){const pe=ae.current.getStage(),we=pe==null?void 0:pe.findOne("#"+T);we&&((Y=we.getLayer())==null||Y.batchDraw(),ae.current.nodes([we]),ae.current.forceUpdate(),(re=ae.current.getLayer())==null||re.batchDraw())}},50)},dr=p=>{if(!T)return;E.find(V=>V.id===T)&&B(V=>V.map(Y=>Y.id===T?{...Y,fill:p}:Y)),M.find(V=>V.id===T)&&U(V=>V.map(Y=>Y.id===T?{...Y,fill:p}:Y))},bi=p=>{if(!T)return;E.find(V=>V.id===T)&&B(V=>V.map(Y=>Y.id===T?{...Y,stroke:p,strokeWidth:Y.strokeWidth||2}:Y)),M.find(V=>V.id===T)&&U(V=>V.map(Y=>Y.id===T?{...Y,stroke:p,strokeWidth:Y.strokeWidth||2}:Y))},ur=()=>{let p;return O==="linear-gradient"?p={type:"linear",colorStops:[0,"#c8102e",1,"#ffaaaa"]}:O==="radial-gradient"&&(p={type:"radial",colorStops:[0,"#c8102e",1,"#ffaaaa"]}),{dimensions:w,backgroundColor:O,backgroundGradient:p,designableArea:_,elements:{textElements:M,curvedTextElements:E,gradientTextElements:N,imageElements:q},assets:{baseImage:D}}},Zi=async p=>{var F,j,V;if(p){if(p.dimensions&&m(p.dimensions),p.backgroundColor&&W(p.backgroundColor),p.designableArea&&C(p.designableArea),p.backgroundGradient&&(window.__tempBackgroundGradient=p.backgroundGradient),p.elements){p.elements.textElements&&U(p.elements.textElements),p.elements.curvedTextElements&&B(p.elements.curvedTextElements),p.elements.gradientTextElements&&A(p.elements.gradientTextElements),p.elements.imageElements&&l(p.elements.imageElements);const Y=new Set;(F=p.elements.textElements)==null||F.forEach(pe=>{pe.fontFamily&&Y.add(pe.fontFamily)}),(j=p.elements.curvedTextElements)==null||j.forEach(pe=>{pe.fontFamily&&Y.add(pe.fontFamily)}),(V=p.elements.gradientTextElements)==null||V.forEach(pe=>{pe.fontFamily&&Y.add(pe.fontFamily)});const re=Array.from(Y).map(pe=>Ot(pe));await Promise.all(re)}p.assets&&p.assets.baseImage&&u(p.assets.baseImage)}},Ia=p=>{p&&(U(F=>F.map(j=>p[j.id]?{...j,text:p[j.id]}:j)),B(F=>F.map(j=>p[j.id]?{...j,text:p[j.id]}:j)),A(F=>F.map(j=>p[j.id]?{...j,text:p[j.id]}:j)))},Ma=p=>{if(!c||c.length===0||!p||Mt===p)return;const F=Mt||g;if(!F)return;const j=c.find(re=>re.chipColor===F),V=c.find(re=>re.chipColor===p);if(!j||!V)return;const Y=re=>{if(!re||re==="gold-gradient")return re;const pe=re.toLowerCase();return pe===j.color1.toLowerCase()?V.color1:pe===j.color2.toLowerCase()?V.color2:pe===j.color3.toLowerCase()?V.color3:j.color4&&pe===j.color4.toLowerCase()?V.color4||re:j.color5&&pe===j.color5.toLowerCase()&&V.color5||re};if(U(re=>re.map(pe=>({...pe,fill:Y(pe.fill),stroke:Y(pe.stroke)}))),B(re=>re.map(pe=>({...pe,fill:Y(pe.fill),stroke:Y(pe.stroke)}))),O!=="transparent"&&O!=="linear-gradient"&&O!=="radial-gradient"){const re=Y(O);re&&re!==O&&W(re)}if((O==="linear-gradient"||O==="radial-gradient")&&window.__tempBackgroundGradient){const re=window.__tempBackgroundGradient;if(re.colorStops){const pe=[...re.colorStops];for(let we=1;we<pe.length;we+=2){const Ke=Y(pe[we]);Ke&&(pe[we]=Ke)}window.__tempBackgroundGradient={...re,colorStops:pe}}}dt(p)},$i=async()=>{var p,F,j;ne(!0);try{const V=ur();X(null),ae.current&&(ae.current.nodes([]),(p=ae.current.getLayer())==null||p.batchDraw()),await new Promise(we=>setTimeout(we,100));const Y=v.current;if(Y){const Ke=Y.find("Image").map(Ve=>new Promise(Ne=>{const Le=Ve.image();if(!Le){setTimeout(()=>Ne(!0),500);return}if(Le.complete)Ne(!0);else{const rt=()=>{Le.removeEventListener("load",rt),Le.removeEventListener("error",qe),Ne(!0)},qe=()=>{console.warn("Image failed to load for thumbnail:",Le.src),Le.removeEventListener("load",rt),Le.removeEventListener("error",qe),Ne(!0)};Le.addEventListener("load",rt),Le.addEventListener("error",qe),setTimeout(()=>{Le.removeEventListener("load",rt),Le.removeEventListener("error",qe),Ne(!0)},5e3)}}));await Promise.all(Ke),Y.batchDraw(),await new Promise(Ve=>setTimeout(Ve,200))}let re;try{re=(F=v.current)==null?void 0:F.toDataURL({x:0,y:0,width:w.width*Ie,height:w.height*Ie,pixelRatio:1/Ie,mimeType:"image/png"})}catch(we){console.error("Error generating thumbnail:",we);try{re=(j=v.current)==null?void 0:j.toDataURL({x:0,y:0,width:w.width*Ie,height:w.height*Ie,pixelRatio:.6/Ie,mimeType:"image/png"})}catch(Ke){console.error("Fallback thumbnail generation also failed:",Ke)}}if((window.__SHOP_DOMAIN__||null)&&(s!=null&&s.id)&&(R!=null&&R.variantId)&&(R!=null&&R.productId)){const we=new FormData;we.append("templateId",s.id),we.append("variantId",R.variantId),we.append("productId",R.productId||""),we.append("canvasState",JSON.stringify(V)),re&&we.append("thumbnail",re);const Ve=await(await fetch("api/designs/draft",{method:"POST",body:we})).json();if(Ve.success)H({message:"Design saved successfully!",type:"success"}),window.__INITIAL_DESIGN__&&(window.__INITIAL_DESIGN__.id=Ve.design.id),(window.opener||window.parent!==window)&&((window.opener||window.parent).postMessage({type:"design-saved",designId:Ve.design.id,thumbnail:Ve.design.thumbnail||re,templateId:s.id,variantId:R.variantId,productId:R.productId},"*"),H({message:"Design saved! Returning to product...",type:"success"}),window.opener&&setTimeout(()=>{window.close()},2e3));else throw new Error(Ve.error||"Failed to save design")}else{const we=`local-${Date.now()}`,Ke={id:we,templateId:s==null?void 0:s.id,variantId:R==null?void 0:R.variantId,productId:R==null?void 0:R.productId,canvasState:V,thumbnail:re,savedAt:new Date().toISOString()};localStorage.setItem("customerDesignDraft",JSON.stringify(Ke)),H({message:"Design saved locally!",type:"success"}),(window.opener||window.parent!==window)&&((window.opener||window.parent).postMessage({type:"design-saved",designId:we,thumbnail:re,templateId:s==null?void 0:s.id,variantId:R==null?void 0:R.variantId,productId:R==null?void 0:R.productId,isLocal:!0},"*"),H({message:"Design saved! Returning to product...",type:"success"}),window.opener&&setTimeout(()=>{window.close()},2e3))}setTimeout(()=>H(null),3e3)}catch(V){console.error("Error saving design:",V),H({message:"Failed to save design: "+(V instanceof Error?V.message:"Unknown error"),type:"error"}),setTimeout(()=>H(null),5e3)}finally{ne(!1)}},cr=async()=>{var j,V,Y,re,pe,we,Ke,Ve;if(x){ne(!0);try{const Ne=ur();X(null),ae.current&&(ae.current.nodes([]),(j=ae.current.getLayer())==null||j.batchDraw()),await new Promise(qe=>setTimeout(qe,100));const Le=v.current;if(Le){const on=Le.find("Image").map(At=>new Promise(at=>{const Qe=At.image();if(!Qe){setTimeout(()=>at(!0),500);return}if(Qe.complete)at(!0);else{const Ct=()=>{Qe.removeEventListener("load",Ct),Qe.removeEventListener("error",Tt),at(!0)},Tt=()=>{console.warn("Image failed to load for thumbnail:",Qe.src),Qe.removeEventListener("load",Ct),Qe.removeEventListener("error",Tt),at(!0)};Qe.addEventListener("load",Ct),Qe.addEventListener("error",Tt),setTimeout(()=>{Qe.removeEventListener("load",Ct),Qe.removeEventListener("error",Tt),at(!0)},5e3)}}));await Promise.all(on),Le.batchDraw(),await new Promise(At=>setTimeout(At,200))}let rt;try{rt=(V=v.current)==null?void 0:V.toDataURL({x:0,y:0,width:w.width*Ie,height:w.height*Ie,pixelRatio:1/Ie,mimeType:"image/png"})}catch(qe){console.error("Error generating thumbnail:",qe);try{rt=(Y=v.current)==null?void 0:Y.toDataURL({x:0,y:0,width:w.width*Ie,height:w.height*Ie,pixelRatio:.6/Ie,mimeType:"image/png"})}catch(on){console.error("Fallback thumbnail generation also failed:",on)}}await x(Ne,rt),H({message:"Template saved successfully!",type:"success"}),setTimeout(()=>H(null),3e3)}catch(Ne){console.error("Error saving template:",Ne),H({message:"Failed to save template: "+(Ne instanceof Error?Ne.message:"Unknown error"),type:"error"}),setTimeout(()=>H(null),5e3)}finally{ne(!1)}return}const p=(s==null?void 0:s.name)||prompt("Enter template name:");if(!p)return;let F=s==null?void 0:s.colorVariant;if(z&&!F){const Ne=(re=z.selectedOptions)==null?void 0:re.find(Le=>Le.name==="Color");Ne&&(F=Ne.value.toLowerCase())}if(d&&!F){const Ne=((pe=d.attributes)==null?void 0:pe.colors)||[];if(Ne.length>0){const Le=prompt(`Select color for this template:
${Ne.join(", ")}

Enter color:`);if(!Le||!Ne.includes(Le)){alert("Invalid color selection. Please choose from: "+Ne.join(", "));return}F=Le}else{const Le=prompt("Enter color variant for this template:");if(!Le)return;F=Le}}ne(!0);try{const Ne=ur();X(null),ae.current&&(ae.current.nodes([]),(we=ae.current.getLayer())==null||we.batchDraw()),await new Promise(at=>setTimeout(at,100));const Le=v.current;if(Le){const Qe=Le.find("Image").map(Ct=>new Promise(Tt=>{const ot=Ct.image();if(!ot){setTimeout(()=>Tt(!0),500);return}if(ot.complete)Tt(!0);else{const yr=()=>{ot.removeEventListener("load",yr),ot.removeEventListener("error",Bn),Tt(!0)},Bn=()=>{console.warn("Image failed to load for thumbnail:",ot.src),ot.removeEventListener("load",yr),ot.removeEventListener("error",Bn),Tt(!0)};ot.addEventListener("load",yr),ot.addEventListener("error",Bn),setTimeout(()=>{ot.removeEventListener("load",yr),ot.removeEventListener("error",Bn),Tt(!0)},5e3)}}));await Promise.all(Qe),Le.batchDraw(),await new Promise(Ct=>setTimeout(Ct,200))}let rt;try{rt=(Ke=v.current)==null?void 0:Ke.toDataURL({x:0,y:0,width:w.width*Ie,height:w.height*Ie,pixelRatio:1/Ie,mimeType:"image/png"})}catch(at){console.error("Error generating thumbnail:",at);try{rt=(Ve=v.current)==null?void 0:Ve.toDataURL({x:0,y:0,width:w.width*Ie,height:w.height*Ie,pixelRatio:.6/Ie,mimeType:"image/png"})}catch(Qe){console.error("Fallback thumbnail generation also failed:",Qe)}}const qe=new FormData;qe.append("name",p),qe.append("canvasData",JSON.stringify(Ne)),rt?qe.append("thumbnail",rt):console.warn("No thumbnail generated for template"),console.log("Save Template Debug:",{shopifyProduct:L,shopifyVariant:z,productLayout:d,colorVariant:F,initialTemplate:s}),s!=null&&s.id&&qe.append("templateId",s.id),L!=null&&L.id&&qe.append("shopifyProductId",L.id),z!=null&&z.id&&qe.append("shopifyVariantId",z.id),d!=null&&d.id&&qe.append("productLayoutId",d.id),F&&qe.append("colorVariant",F);const At=await(await fetch("api/templates/save",{method:"POST",body:qe})).json();if(At.success)At.warning?H({message:`Template saved but with warning: ${At.warning}`,type:"info"}):H({message:"Template saved and synced successfully!",type:"success"}),es(),setTimeout(()=>H(null),3e3);else throw new Error(At.error||"Failed to save template")}catch(Ne){console.error("Error saving template:",Ne),H({message:"Failed to save template: "+(Ne instanceof Error?Ne.message:"Unknown error"),type:"error"}),setTimeout(()=>H(null),5e3)}finally{ne(!1)}},Aa=async p=>{if(p){ie(!0);try{const j=await(await fetch(`/api/templates/${p}`)).json();if(j.template){const V=JSON.parse(j.template.canvasData);await Zi(V),H({message:"Template loaded successfully!",type:"success"}),setTimeout(()=>H(null),3e3)}else throw new Error(j.error||"Failed to load template")}catch(F){console.error("Error loading template:",F),H({message:"Failed to load template: "+(F instanceof Error?F.message:"Unknown error"),type:"error"}),setTimeout(()=>H(null),5e3)}finally{ie(!1)}}},es=async()=>{try{const F=await(await fetch("api/templates")).json();F.templates&&ge(F.templates)}catch(p){console.error("Error loading templates:",p)}};he.useEffect(()=>{es()},[]),he.useEffect(()=>{(async()=>{if(s&&s.canvasData)try{const F=JSON.parse(s.canvasData);await Zi(F)}catch(F){console.error("Error loading initial template:",F)}})()},[s]),he.useEffect(()=>{R!=null&&R.textUpdates&&s&&setTimeout(()=>{Ia(R.textUpdates)},100)},[s,R]),he.useEffect(()=>{const p=F=>{var j;((j=F.detail)==null?void 0:j.source)==="fullDesigner"&&cr()};return window.addEventListener("saveDesign",p),()=>window.removeEventListener("saveDesign",p)},[]);const hr=()=>{var p;T&&(U(F=>F.filter(j=>j.id!==T)),B(F=>F.filter(j=>j.id!==T)),A(F=>F.filter(j=>j.id!==T)),l(F=>F.filter(j=>j.id!==T)),X(null),ae.current&&(ae.current.nodes([]),(p=ae.current.getLayer())==null||p.batchDraw()))};return he.useEffect(()=>{const p=F=>{F.key==="d"&&(F.ctrlKey||F.metaKey)&&T&&(F.preventDefault(),Qi()),F.key==="]"&&(F.ctrlKey||F.metaKey)&&T&&(F.preventDefault(),Pt()),F.key==="["&&(F.ctrlKey||F.metaKey)&&T&&(F.preventDefault(),On())};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[T]),he.useEffect(()=>{const p=F=>{const j=F.target,V=j.closest("[data-color-picker]"),Y=j.closest("[data-color-button]");!V&&!Y&&ce&&ve(!1)};if(ce)return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[ce]),he.useEffect(()=>{const p=F=>{const j=F.target,V=j.closest("[data-bg-color-picker]"),Y=j.closest("[data-bg-color-button]");!V&&!Y&&Ce&&Fe(!1)};if(Ce)return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[Ce]),he.useEffect(()=>{const p=F=>{const j=F.target,V=j.closest("[data-font-picker]"),Y=j.closest("[data-font-button]");!V&&!Y&&ut&&st(!1)};if(ut)return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[ut]),he.useEffect(()=>{const p=F=>{const j=F.target,V=j.closest("[data-design-controls]"),Y=j.closest("[data-design-button]");!V&&!Y&&be&&$e(!1)};if(be)return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[be]),he.useEffect(()=>{const p=F=>{const j=F.target,V=j.closest("[data-stroke-color-picker]"),Y=j.closest("[data-stroke-color-button]");!V&&!Y&&De&&Ue(!1)};if(De)return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[De]),he.useEffect(()=>{const p=F=>{const j=F.target,V=j.closest("[data-design-color-picker]"),Y=j.closest("[data-design-color-button]");!V&&!Y&&Wt&&He(!1)};if(Wt)return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[Wt]),K.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[fe&&K.jsxs("div",{style:{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:fe.type==="success"?"#108043":fe.type==="error"?"#d82c0d":"#005fb3",color:"white",padding:"12px 24px",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:2e3,fontSize:"14px",fontWeight:500,display:"flex",alignItems:"center",gap:"12px",animation:"slideDown 0.3s ease-out"},children:[K.jsx("span",{children:fe.type==="success"?"✓":fe.type==="error"?"✕":"ℹ"}),fe.message,K.jsx("button",{onClick:()=>H(null),style:{background:"none",border:"none",color:"white",cursor:"pointer",padding:"4px",marginLeft:"8px",fontSize:"16px",opacity:.8,transition:"opacity 0.2s"},onMouseEnter:p=>p.currentTarget.style.opacity="1",onMouseLeave:p=>p.currentTarget.style.opacity="0.8",children:"×"})]}),K.jsxs("div",{style:{padding:"10px",flexShrink:0,backgroundColor:"#f7f8fa",borderBottom:"1px solid #ddd",maxHeight:"300px",overflowY:"auto"},children:[K.jsx("button",{onClick:Ta,style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px"},children:"Add Text"}),K.jsx("button",{onClick:Ra,style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px"},children:"Add Curved Text"}),K.jsxs("label",{style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px",backgroundColor:"#f0f0f0",border:"1px solid #ccc",borderRadius:"3px",cursor:"pointer",display:"inline-block"},children:["Add Image",K.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:async p=>{var j;const F=(j=p.target.files)==null?void 0:j[0];if(F){const V=new FormData;V.append("file",F),V.append("assetType","userImage");try{const re=await(await fetch("api/assets/upload",{method:"POST",body:V})).json();if(re.success){const pe=new window.Image;pe.crossOrigin="anonymous",pe.onload=()=>{const Ke=pe.width/pe.height;let Ve,Ne;pe.width>pe.height?(Ve=Math.min(pe.width,400),Ne=Ve/Ke):(Ne=Math.min(pe.height,400),Ve=Ne*Ke);const Le={id:`image-${Date.now()}`,url:re.asset.url,x:_.x+_.width/2-Ve/2,y:_.y+_.height/2-Ne/2,width:Ve,height:Ne,rotation:0};l(rt=>[...rt,Le])},pe.onerror=()=>{console.error("Failed to load image for dimensions");const we={id:`image-${Date.now()}`,url:re.asset.url,x:_.x+_.width/2-50,y:_.y+_.height/2-50,width:100,height:100,rotation:0};l(Ke=>[...Ke,we])},pe.src=re.asset.url}else H({message:`Upload failed: ${re.error}`,type:"error"}),setTimeout(()=>H(null),5e3)}catch(Y){console.error("Upload error:",Y),H({message:"Failed to upload image",type:"error"}),setTimeout(()=>H(null),5e3)}}}})]}),K.jsxs("button",{onClick:()=>C(p=>({...p,visible:!p.visible})),style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px",backgroundColor:_.visible?"#28a745":"#6c757d",color:"white",border:"none",borderRadius:"4px"},children:[_.visible?"Hide":"Show"," Design Area"]}),a?K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px",borderLeft:"2px solid #ddd",paddingLeft:"20px"},children:[K.jsx("button",{onClick:cr,disabled:Q,style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",opacity:Q?.6:1,cursor:Q?"not-allowed":"pointer"},children:Q?"Saving...":s?"Update Template":"Save Template"}),K.jsxs("select",{onChange:p=>Aa(p.target.value),disabled:le,style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px",borderRadius:"4px",border:"1px solid #ddd",cursor:le?"not-allowed":"pointer"},children:[K.jsx("option",{value:"",children:"Load Template..."}),oe.map(p=>K.jsx("option",{value:p.id,children:p.name},p.id))]}),le&&K.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Loading..."})]}):K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px",borderLeft:"2px solid #ddd",paddingLeft:"20px"},children:[K.jsx("button",{onClick:$i,disabled:Q,style:{padding:"8px 16px",fontSize:"14px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",opacity:Q?.6:1,cursor:Q?"not-allowed":"pointer",marginRight:"10px"},children:Q?"Saving...":"Done"}),window.__RETURN_URL__&&K.jsx("a",{href:window.__RETURN_URL__,style:{padding:"8px 16px",fontSize:"14px",color:"#666",textDecoration:"none",border:"1px solid #ddd",borderRadius:"4px",display:"inline-block",backgroundColor:"white",transition:"all 0.2s"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor="#f5f5f5",p.currentTarget.style.borderColor="#999"},onMouseLeave:p=>{p.currentTarget.style.backgroundColor="white",p.currentTarget.style.borderColor="#ddd"},children:"← Return to Product"})]}),!a&&c.length>0&&K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px",position:"relative"},children:[K.jsxs("button",{"data-design-color-button":"true",onClick:()=>He(!Wt),style:{padding:"8px 16px",fontSize:"14px",borderRadius:"4px",border:"1px solid #ddd",background:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",children:[K.jsx("span",{style:{fontSize:"12px",color:"#666"},children:"Design Color:"}),K.jsx("span",{style:{fontSize:"14px",fontWeight:500,textTransform:"capitalize"},children:Mt||"Select"})]}),Wt&&K.jsx("div",{"data-design-color-picker":"true",style:{position:"absolute",top:"40px",left:0,background:"white",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"8px",minWidth:"200px",maxHeight:"300px",overflowY:"auto",zIndex:1001},children:c.map(p=>K.jsxs("button",{onClick:()=>{Ma(p.chipColor),He(!1)},style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"8px 12px",border:"none",background:Mt===p.chipColor?"#f0f0f0":"transparent",cursor:"pointer",transition:"background 0.2s",borderRadius:"4px",textAlign:"left"},onMouseEnter:F=>{Mt!==p.chipColor&&(F.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:F=>{F.currentTarget.style.backgroundColor=Mt===p.chipColor?"#f0f0f0":"transparent"},children:[K.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:p.color1,border:"2px solid #ddd",flexShrink:0}}),K.jsx("span",{style:{fontSize:"14px",textTransform:"capitalize",color:"#333"},children:p.chipColor.replace("-"," ")})]},p.chipColor))})]}),K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px",position:"relative"},children:[K.jsxs("button",{"data-bg-color-button":"true",onClick:()=>Fe(!Ce),style:{padding:"8px 16px",fontSize:"14px",borderRadius:"4px",border:"1px solid #ddd",background:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",children:[K.jsx("span",{style:{fontSize:"12px",color:"#666"},children:"Background:"}),K.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"3px",backgroundColor:O==="transparent"?"#f0f0f0":O,backgroundImage:O==="transparent"?"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)":O==="linear-gradient"?"linear-gradient(135deg, #c8102e 0%, #ffaaaa 100%)":O==="radial-gradient"?"radial-gradient(circle at center, #c8102e 0%, #ffaaaa 100%)":void 0,backgroundSize:O==="transparent"?"6px 6px":void 0,backgroundPosition:O==="transparent"?"0 0, 3px 3px":void 0,border:"1px solid #ccc",boxShadow:O==="#ffffff"?"inset 0 0 0 1px #ddd":"none"}})]}),Ce&&K.jsxs("div",{"data-bg-color-picker":"true",style:{position:"absolute",top:"40px",left:0,background:"white",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"6px",flexWrap:"wrap",width:"280px",zIndex:1001},children:[K.jsx("button",{onClick:()=>{W("transparent"),Fe(!1)},style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:"#f0f0f0",backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)",backgroundSize:"10px 10px",backgroundPosition:"0 0, 5px 5px",border:O==="transparent"?"3px solid #0066ff":"2px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s"},title:"Transparent",onMouseEnter:p=>{O!=="transparent"&&(p.currentTarget.style.transform="scale(1.1)",p.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)")},onMouseLeave:p=>{p.currentTarget.style.transform="scale(1)",p.currentTarget.style.boxShadow="none"}}),[{name:"White",hex:"#ffffff"},{name:"Red",hex:"#c8102e"},{name:"Blue",hex:"#0057b8"},{name:"Green",hex:"#009639"},{name:"Black",hex:"#000000"},{name:"Purple",hex:"#5f259f"},{name:"Yellow",hex:"#fff110"},{name:"Grey",hex:"#a2aaad"},{name:"Orange",hex:"#ff8200"},{name:"Ivory",hex:"#f1e6b2"},{name:"Light Blue",hex:"#71c5e8"},{name:"Pink",hex:"#f8a3bc"},{name:"Brown",hex:"#9e652e"},{name:"Light Grey",hex:"#cccccc"},{name:"Light Pink",hex:"#ffaaaa"},{name:"Sky Blue",hex:"#7fa8db"},{name:"Mint Green",hex:"#e0eed5"},{name:"Lavender",hex:"#aaaaff"},{name:"Amber",hex:"#febd11"},{name:"Olive",hex:"#97872a"},{name:"Peach",hex:"#ffcfa3"},{name:"Cream",hex:"#f7f4e8"},{name:"Powder Blue",hex:"#b8d6e0"},{name:"Blush",hex:"#ffd6e1"},{name:"Tan",hex:"#c49a73"}].map(p=>K.jsx("button",{onClick:()=>{W(p.hex),Fe(!1)},style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:p.hex,border:O===p.hex?"3px solid #0066ff":"2px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s",boxShadow:p.hex==="#ffffff"?"inset 0 0 0 1px #ddd":"none"},title:p.name,onMouseEnter:F=>{O!==p.hex&&(F.currentTarget.style.transform="scale(1.1)",F.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)")},onMouseLeave:F=>{F.currentTarget.style.transform="scale(1)",F.currentTarget.style.boxShadow=p.hex==="#ffffff"?"inset 0 0 0 1px #ddd":"none"}},p.hex)),K.jsx("button",{onClick:()=>{W("linear-gradient"),Fe(!1)},style:{width:"28px",height:"28px",borderRadius:"50%",background:"linear-gradient(135deg, #c8102e 0%, #ffaaaa 100%)",border:O==="linear-gradient"?"3px solid #0066ff":"2px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s"},title:"Linear Gradient",onMouseEnter:p=>{O!=="linear-gradient"&&(p.currentTarget.style.transform="scale(1.1)",p.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)")},onMouseLeave:p=>{p.currentTarget.style.transform="scale(1)",p.currentTarget.style.boxShadow="none"}}),K.jsx("button",{onClick:()=>{W("radial-gradient"),Fe(!1)},style:{width:"28px",height:"28px",borderRadius:"50%",background:"radial-gradient(circle at center, #c8102e 0%, #ffaaaa 100%)",border:O==="radial-gradient"?"3px solid #0066ff":"2px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s"},title:"Radial Gradient",onMouseEnter:p=>{O!=="radial-gradient"&&(p.currentTarget.style.transform="scale(1.1)",p.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)")},onMouseLeave:p=>{p.currentTarget.style.transform="scale(1)",p.currentTarget.style.boxShadow="none"}})]})]}),K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px",position:"relative"},children:[K.jsxs("button",{"data-design-button":"true",onClick:()=>$e(!be),style:{padding:"8px 16px",fontSize:"14px",borderRadius:"4px",border:"1px solid #ddd",background:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",children:[K.jsx("span",{style:{fontSize:"14px"},children:"Design Area"}),K.jsx("span",{style:{fontSize:"10px"},children:be?"▲":"▼"})]}),be&&K.jsx("div",{"data-design-controls":"true",style:{position:"absolute",top:"40px",left:0,background:"white",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"16px",zIndex:1001,minWidth:"300px"},children:K.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[K.jsxs("div",{children:[K.jsxs("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Center X: ",Math.round(_.x+_.width/2),"px"]}),K.jsx("input",{type:"range",min:"200",max:w.width-200,value:_.x+_.width/2,onChange:p=>{const F=parseInt(p.target.value);C(j=>({...j,x:F-j.width/2}))},style:{width:"100%",cursor:"pointer"}})]}),K.jsxs("div",{children:[K.jsxs("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Center Y: ",Math.round(_.y+_.height/2),"px"]}),K.jsx("input",{type:"range",min:"200",max:w.height-200,value:_.y+_.height/2,onChange:p=>{const F=parseInt(p.target.value);C(j=>({...j,y:F-j.height/2}))},style:{width:"100%",cursor:"pointer"}})]}),K.jsxs("div",{children:[K.jsxs("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Width: ",_.width,"px"]}),K.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[K.jsx("button",{onClick:()=>{const p=Math.max(100,_.width-10),F=_.x+_.width/2;C(j=>({...j,width:p,x:F-p/2,cornerRadius:Math.min(j.cornerRadius,p/2)}))},style:{padding:"2px 8px",fontSize:"14px",cursor:"pointer"},children:"-"}),K.jsx("input",{type:"range",min:"100",max:"1000",value:_.width,onChange:p=>{const F=parseInt(p.target.value),j=_.x+_.width/2;C(V=>({...V,width:F,x:j-F/2,cornerRadius:Math.min(V.cornerRadius,F/2)}))},style:{flex:1,cursor:"pointer"}}),K.jsx("button",{onClick:()=>{const p=Math.min(1e3,_.width+10),F=_.x+_.width/2;C(j=>({...j,width:p,x:F-p/2,cornerRadius:Math.min(j.cornerRadius,p/2)}))},style:{padding:"2px 8px",fontSize:"14px",cursor:"pointer"},children:"+"})]})]}),K.jsxs("div",{children:[K.jsxs("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Height: ",_.height,"px"]}),K.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[K.jsx("button",{onClick:()=>{const p=Math.max(100,_.height-10),F=_.y+_.height/2;C(j=>({...j,height:p,y:F-p/2,cornerRadius:Math.min(j.cornerRadius,p/2)}))},style:{padding:"2px 8px",fontSize:"14px",cursor:"pointer"},children:"-"}),K.jsx("input",{type:"range",min:"100",max:"1000",value:_.height,onChange:p=>{const F=parseInt(p.target.value),j=_.y+_.height/2;C(V=>({...V,height:F,y:j-F/2,cornerRadius:Math.min(V.cornerRadius,F/2)}))},style:{flex:1,cursor:"pointer"}}),K.jsx("button",{onClick:()=>{const p=Math.min(1e3,_.height+10),F=_.y+_.height/2;C(j=>({...j,height:p,y:F-p/2,cornerRadius:Math.min(j.cornerRadius,p/2)}))},style:{padding:"2px 8px",fontSize:"14px",cursor:"pointer"},children:"+"})]})]}),K.jsxs("div",{children:[K.jsxs("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:["Corner Radius: ",_.cornerRadius,"px",K.jsx("span",{style:{marginLeft:"8px",fontSize:"11px",color:"#999"},children:_.cornerRadius===Math.min(_.width,_.height)/2?"(Circle)":"(Rectangle)"})]}),K.jsx("input",{type:"range",min:"0",max:Math.min(_.width,_.height)/2,value:_.cornerRadius,onChange:p=>C(F=>({...F,cornerRadius:parseInt(p.target.value)})),style:{width:"100%",cursor:"pointer"}})]})]})})]}),K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px"},children:[K.jsxs("select",{value:D,onChange:p=>u(p.target.value),style:{padding:"8px 16px",fontSize:"14px",marginRight:"10px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer",background:"white"},children:[K.jsx("option",{value:"media/images/8-spot-red-base-image.png",children:"Red Base"}),K.jsx("option",{value:"media/images/8-spot-black-base.png",children:"Black Base"}),K.jsx("option",{value:"media/images/8-spot-blue-base.png",children:"Blue Base"}),K.jsx("option",{value:"https://shopify-designs.s3.us-west-1.amazonaws.com/assets/default/images/8-spot-red-base-image.png",children:"Red Base (S3)"}),K.jsx("option",{value:"https://shopify-designs.s3.us-west-1.amazonaws.com/assets/default/images/8-spot-black-base.png",children:"Black Base (S3)"}),K.jsx("option",{value:"https://shopify-designs.s3.us-west-1.amazonaws.com/assets/default/images/8-spot-blue-base.png",children:"Blue Base (S3)"})]}),K.jsxs("label",{style:{padding:"8px 16px",fontSize:"14px",backgroundColor:"#f0f0f0",border:"1px solid #ccc",borderRadius:"4px",cursor:"pointer",display:"inline-block",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#e8e8e8",onMouseLeave:p=>p.currentTarget.style.backgroundColor="#f0f0f0",children:["Upload Base Image",K.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:async p=>{var j;const F=(j=p.target.files)==null?void 0:j[0];if(F){const V=new FormData;V.append("file",F),V.append("assetType","image");try{const re=await(await fetch("api/assets/upload",{method:"POST",body:V})).json();re.success?(u(re.asset.url),H({message:"Base image uploaded successfully!",type:"success"}),setTimeout(()=>H(null),3e3)):(console.error("Upload failed:",re),H({message:`Upload failed: ${re.error}`,type:"error"}),setTimeout(()=>H(null),5e3))}catch(Y){console.error("Upload error:",Y),H({message:"Failed to upload image: "+(Y instanceof Error?Y.message:"Unknown error"),type:"error"}),setTimeout(()=>H(null),5e3)}}}})]})]}),(d==null?void 0:d.variantImages)&&Object.keys(d.variantImages).length>0&&K.jsxs("div",{style:{display:"inline-block",marginLeft:"20px"},children:[K.jsxs("select",{value:o||"",onChange:p=>{const F=p.target.value;b(F),F&&d.variantImages[F]?u(d.variantImages[F]):u(d.baseImageUrl)},style:{padding:"8px 16px",fontSize:"14px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer",minWidth:"200px"},children:[K.jsx("option",{value:"",children:"Default Base Image"}),Object.entries(d.variantImages).map(([p])=>{const[F,...j]=p.split("-"),V=j.join(" ").replace(/-/g," "),Y=`${F.charAt(0).toUpperCase()+F.slice(1)} - ${V.split(" ").map(re=>re.charAt(0).toUpperCase()+re.slice(1)).join(" ")}`;return K.jsx("option",{value:p,children:Y},p)})]}),K.jsx("span",{style:{marginLeft:"8px",fontSize:"12px",color:"#666"},children:"Reference Image"})]}),K.jsxs("div",{style:{marginTop:"10px",padding:"5px",fontSize:"12px",color:"#6c757d",fontFamily:"monospace"},children:["Canvas Size: ",w.width," px width × ",w.height," px height"]})]}),K.jsx("div",{ref:k,style:{width:"100%",height:"100%",flex:"1",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",position:"relative",minHeight:"400px",backgroundColor:"#ffffff"},children:K.jsx("div",{style:{width:w.width*Ie,height:w.height*Ie,border:"1px solid #ddd",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",borderRadius:"4px",backgroundColor:"white",overflow:"hidden"},children:K.jsx(uf,{ref:v,width:w.width,height:w.height,scaleX:Ie,scaleY:Ie,onMouseDown:lr,onTouchStart:lr,children:K.jsxs(of,{onMouseDown:lr,onTouchStart:lr,children:[I&&K.jsx(Ed,{image:I,x:0,y:0,width:w.width,height:w.height}),K.jsxs(bd,{clipFunc:p=>{const F=_.x,j=_.y,V=_.width,Y=_.height,re=_.cornerRadius;p.beginPath(),re>0?(p.moveTo(F+re,j),p.arcTo(F+V,j,F+V,j+Y,re),p.arcTo(F+V,j+Y,F,j+Y,re),p.arcTo(F,j+Y,F,j,re),p.arcTo(F,j,F+V,j,re)):p.rect(F,j,V,Y),p.closePath()},children:[O!=="transparent"&&K.jsx(kd,{x:_.x,y:_.y,width:_.width,height:_.height,cornerRadius:_.cornerRadius,fill:O==="linear-gradient"||O==="radial-gradient"?void 0:O,fillLinearGradientStartPoint:O==="linear-gradient"?{x:0,y:0}:void 0,fillLinearGradientEndPoint:O==="linear-gradient"?{x:_.width,y:0}:void 0,fillLinearGradientColorStops:O==="linear-gradient"?((ts=window.__tempBackgroundGradient)==null?void 0:ts.type)==="linear"?window.__tempBackgroundGradient.colorStops:[0,"#c8102e",1,"#ffaaaa"]:void 0,fillRadialGradientStartPoint:O==="radial-gradient"?{x:_.width/2,y:_.height/2}:void 0,fillRadialGradientEndPoint:O==="radial-gradient"?{x:_.width/2,y:_.height/2}:void 0,fillRadialGradientStartRadius:O==="radial-gradient"?0:void 0,fillRadialGradientEndRadius:O==="radial-gradient"?Math.min(_.width,_.height)/2:void 0,fillRadialGradientColorStops:O==="radial-gradient"?((ns=window.__tempBackgroundGradient)==null?void 0:ns.type)==="radial"?window.__tempBackgroundGradient.colorStops:[0,"#c8102e",1,"#ffaaaa"]:void 0,listening:!1}),ke.map(p=>{if(p.type==="image"){const F=p.data;return K.jsx(yf,{imageElement:F,isSelected:T===F.id,onSelect:()=>X(F.id),onChange:j=>{l(V=>V.map(Y=>Y.id===F.id?{...Y,...j}:Y))},onDragEnd:()=>setTimeout(gn,0),onTransformEnd:()=>setTimeout(gn,0)},F.id)}if(p.type==="text"){const F=p.data;return K.jsx(Pd,{id:F.id,text:F.text,x:F.x,y:F.y,fontSize:F.fontSize||24,fontFamily:F.fontFamily,fontStyle:F.fontWeight==="bold"?"bold":"normal",fill:F.fill==="gold-gradient"?void 0:F.fill||"black",fillLinearGradientStartPoint:F.fill==="gold-gradient"?{x:0,y:0}:void 0,fillLinearGradientEndPoint:F.fill==="gold-gradient"?{x:0,y:F.fontSize||24}:void 0,fillLinearGradientColorStops:F.fill==="gold-gradient"?[0,"#FFD700",.5,"#FFA500",1,"#B8860B"]:void 0,stroke:F.stroke&&F.stroke!=="transparent"?F.stroke:void 0,strokeWidth:F.stroke&&F.stroke!=="transparent"?F.strokeWidth||2:0,fillAfterStrokeEnabled:!0,rotation:F.rotation||0,scaleX:F.scaleX||1,scaleY:F.scaleY||1,draggable:!0,onClick:()=>X(F.id),onTap:()=>X(F.id),onDragEnd:j=>{const V=j.target.x(),Y=j.target.y();U(re=>re.map(pe=>pe.id===F.id?{...pe,x:V,y:Y}:pe)),setTimeout(gn,0)},onTransformEnd:j=>{const V=j.target;U(Y=>Y.map(re=>re.id===F.id?{...re,x:V.x(),y:V.y(),rotation:V.rotation(),scaleX:V.scaleX(),scaleY:V.scaleY()}:re)),setTimeout(gn,0)}},F.id)}if(p.type==="gradientText"){const F=p.data;return K.jsx(Pd,{id:F.id,text:F.text,x:F.x,y:F.y,fontSize:F.fontSize||24,fontFamily:F.fontFamily,rotation:F.rotation||0,scaleX:F.scaleX||1,scaleY:F.scaleY||1,fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:0,y:24},fillLinearGradientColorStops:[0,"#FFD700",.5,"#FFA500",1,"#B8860B"],draggable:!0,onClick:()=>X(F.id),onTap:()=>X(F.id),onDragEnd:j=>{const V=j.target.x(),Y=j.target.y();A(re=>re.map(pe=>pe.id===F.id?{...pe,x:V,y:Y}:pe)),setTimeout(gn,0)},onTransformEnd:j=>{const V=j.target;A(Y=>Y.map(re=>re.id===F.id?{...re,x:V.x(),y:V.y(),rotation:V.rotation(),scaleX:V.scaleX(),scaleY:V.scaleY()}:re)),setTimeout(gn,0)}},F.id)}if(p.type==="curvedText"){const F=p.data,j=F.flipped?F.topY-F.radius:F.topY+F.radius,V=F.fontSize||20,Y=F.text.length*V*.6,re=Math.min(Y/F.radius,Math.PI*1.5);let pe,we,Ke;F.flipped?(pe=Math.PI/2+re/2,we=Math.PI/2-re/2,Ke=0):(pe=-Math.PI/2-re/2,we=-Math.PI/2+re/2,Ke=1);const Ve=Math.cos(pe)*F.radius,Ne=Math.sin(pe)*F.radius,Le=Math.cos(we)*F.radius,rt=Math.sin(we)*F.radius,qe=re>Math.PI?1:0,on=`M ${Ve},${Ne} A ${F.radius},${F.radius} 0 ${qe},${Ke} ${Le},${rt}`;return K.jsx(bd,{id:F.id,x:F.x,y:j,rotation:F.rotation||0,scaleX:F.scaleX||1,scaleY:F.scaleY||1,draggable:!0,onClick:()=>X(F.id),onTap:()=>X(F.id),onDragEnd:At=>{const at=At.target.x(),Qe=At.target.y(),Ct=F.flipped?Qe+F.radius:Qe-F.radius;B(Tt=>Tt.map(ot=>ot.id===F.id?{...ot,x:at,topY:Ct}:ot)),setTimeout(gn,0)},onTransformEnd:At=>{const at=At.target;B(Qe=>Qe.map(Ct=>Ct.id===F.id?{...Ct,x:at.x(),topY:F.flipped?at.y()+F.radius:at.y()-F.radius,rotation:at.rotation(),scaleX:at.scaleX(),scaleY:at.scaleY()}:Ct)),setTimeout(gn,0)},children:K.jsx(lf,{text:F.text,data:on,fontSize:F.fontSize||20,fontFamily:F.fontFamily,fontStyle:F.fontWeight==="bold"?"bold":"normal",fill:F.fill==="gold-gradient"?void 0:F.fill||"black",fillLinearGradientStartPoint:F.fill==="gold-gradient"?{x:0,y:0}:void 0,fillLinearGradientEndPoint:F.fill==="gold-gradient"?{x:0,y:F.fontSize||20}:void 0,fillLinearGradientColorStops:F.fill==="gold-gradient"?[0,"#FFD700",.5,"#FFA500",1,"#B8860B"]:void 0,stroke:F.stroke&&F.stroke!=="transparent"?F.stroke:void 0,strokeWidth:F.stroke&&F.stroke!=="transparent"?F.strokeWidth||2:0,fillAfterStrokeEnabled:!0,align:"center"})},F.id)}return null})]}),_.visible&&K.jsx(kd,{x:_.x,y:_.y,width:_.width,height:_.height,cornerRadius:_.cornerRadius,stroke:"#007bff",strokeWidth:2,dash:[5,5],fill:"rgba(0, 123, 255, 0.1)",listening:!1}),K.jsx(df,{ref:ae,centeredScaling:!0,boundBoxFunc:(p,F)=>F.width<5||F.height<5?p:F,anchorCornerRadius:5,anchorSize:8,borderStroke:"#0066ff",anchorStroke:"#0066ff",anchorFill:"white",keepRatio:!0,rotateEnabled:!0,rotateAnchorOffset:20,enabledAnchors:["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"]})]})})})}),T&&K.jsxs("div",{style:{position:"absolute",left:"50%",top:"80px",transform:"translateX(-50%)",background:"white",border:"1px solid #ddd",borderRadius:"8px",boxShadow:"0 2px 12px rgba(0,0,0,0.1)",padding:"8px",display:"flex",gap:"8px",alignItems:"center",zIndex:1e3},children:[K.jsx("button",{onClick:Qi,style:{width:"36px",height:"36px",padding:"6px",border:"none",borderRadius:"6px",background:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Duplicate (Ctrl+D)",children:"📋"}),K.jsx("button",{onClick:hr,style:{width:"36px",height:"36px",padding:"6px",border:"none",borderRadius:"6px",background:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#ffebee",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Delete",children:"🗑️"}),K.jsx("div",{style:{width:"1px",background:"#e0e0e0",height:"24px",margin:"0 4px"}}),K.jsx("button",{onClick:On,disabled:!T||ke.findIndex(p=>p.id===T)===0,style:{width:"36px",height:"36px",padding:"6px",border:"none",borderRadius:"6px",background:"white",cursor:!T||ke.findIndex(p=>p.id===T)===0?"not-allowed":"pointer",opacity:!T||ke.findIndex(p=>p.id===T)===0?.5:1,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},onMouseEnter:p=>{T&&ke.findIndex(F=>F.id===T)>0&&(p.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Move Layer Down (Ctrl+[)",children:"↓"}),K.jsx("button",{onClick:Pt,disabled:!T||ke.findIndex(p=>p.id===T)===ke.length-1,style:{width:"36px",height:"36px",padding:"6px",border:"none",borderRadius:"6px",background:"white",cursor:!T||ke.findIndex(p=>p.id===T)===ke.length-1?"not-allowed":"pointer",opacity:!T||ke.findIndex(p=>p.id===T)===ke.length-1?.5:1,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},onMouseEnter:p=>{T&&ke.findIndex(F=>F.id===T)<ke.length-1&&(p.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Move Layer Up (Ctrl+])",children:"↑"}),K.jsx("button",{onClick:Si,disabled:!T||ke.findIndex(p=>p.id===T)===ke.length-1,style:{width:"36px",height:"36px",padding:"6px",border:"none",borderRadius:"6px",background:"white",cursor:!T||ke.findIndex(p=>p.id===T)===ke.length-1?"not-allowed":"pointer",opacity:!T||ke.findIndex(p=>p.id===T)===ke.length-1?.5:1,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",transition:"all 0.2s"},onMouseEnter:p=>{T&&ke.findIndex(F=>F.id===T)<ke.length-1&&(p.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Move to Front",children:"⬆️"}),K.jsx("button",{onClick:Xi,disabled:!T||ke.findIndex(p=>p.id===T)===0,style:{width:"36px",height:"36px",padding:"6px",border:"none",borderRadius:"6px",background:"white",cursor:!T||ke.findIndex(p=>p.id===T)===0?"not-allowed":"pointer",opacity:!T||ke.findIndex(p=>p.id===T)===0?.5:1,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",transition:"all 0.2s"},onMouseEnter:p=>{T&&ke.findIndex(F=>F.id===T)>0&&(p.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Move to Back",children:"⬇️"}),(M.find(p=>p.id===T)||N.find(p=>p.id===T)||E.find(p=>p.id===T))&&K.jsxs(K.Fragment,{children:[K.jsx("div",{style:{width:"1px",background:"#e0e0e0",height:"24px",margin:"0 4px"}}),K.jsxs("div",{style:{position:"relative"},children:[K.jsxs("button",{"data-font-button":"true",onClick:()=>st(!ut),style:{padding:"4px 12px",fontSize:"14px",border:"1px solid #ddd",borderRadius:"4px",background:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",minWidth:"140px",justifyContent:"space-between",transition:"all 0.2s",fontFamily:((rs=M.find(p=>p.id===T))==null?void 0:rs.fontFamily)||((is=N.find(p=>p.id===T))==null?void 0:is.fontFamily)||((ss=E.find(p=>p.id===T))==null?void 0:ss.fontFamily)||"Arial"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",children:[K.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:((as=M.find(p=>p.id===T))==null?void 0:as.fontFamily)||((os=N.find(p=>p.id===T))==null?void 0:os.fontFamily)||((ls=E.find(p=>p.id===T))==null?void 0:ls.fontFamily)||"Arial"}),K.jsx("span",{style:{fontSize:"12px"},children:"▼"})]}),ut&&K.jsxs("div",{"data-font-picker":"true",style:{position:"absolute",top:"38px",left:0,background:"white",border:"1px solid #ddd",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"220px",maxHeight:"400px",overflowY:"auto",zIndex:1002},children:[["sans-serif","serif","display","script","monospace"].map(p=>{const F=ff(p);if(F.length===0)return null;const j={"sans-serif":"Sans Serif",serif:"Serif",display:"Display & Decorative",script:"Script & Handwriting",monospace:"Monospace"};return K.jsxs("div",{children:[K.jsx("div",{style:{padding:"8px 12px 4px",fontSize:"12px",fontWeight:"bold",color:"#666",borderBottom:"1px solid #eee",backgroundColor:"#f9f9f9"},children:j[p]}),F.map(V=>{var Y,re,pe;return K.jsxs("button",{onClick:()=>{Ci(V.family),st(!1)},style:{width:"100%",padding:"8px 12px",border:"none",background:"none",cursor:"pointer",textAlign:"left",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",transition:"background 0.2s",backgroundColor:((Y=M.find(we=>we.id===T))==null?void 0:Y.fontFamily)===V.family||((re=N.find(we=>we.id===T))==null?void 0:re.fontFamily)===V.family||((pe=E.find(we=>we.id===T))==null?void 0:pe.fontFamily)===V.family?"#e3f2fd":"transparent"},onMouseEnter:we=>{we.currentTarget.style.backgroundColor!=="rgb(227, 242, 253)"&&(we.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:we=>{we.currentTarget.style.backgroundColor==="#f5f5f5"&&(we.currentTarget.style.backgroundColor="transparent")},children:[K.jsx("img",{src:V.previewUrl,alt:V.displayName,style:{height:"24px",maxWidth:"180px",objectFit:"contain",objectPosition:"left center"},onError:we=>{var Ne;const Ke=we.target;Ke.style.display="none";const Ve=document.createElement("span");Ve.textContent=V.displayName,Ve.style.fontFamily=V.family,(Ne=Ke.parentNode)==null||Ne.appendChild(Ve)}}),K.jsx("span",{style:{fontSize:"12px",color:"#999",marginLeft:"auto"},children:wi.isFontLoaded(V.family)?"✓":"⏳"})]},V.id)})]},p)}),K.jsx("div",{style:{borderTop:"1px solid #eee",padding:"8px"},children:K.jsx("button",{onClick:()=>{st(!1),ht(!0)},style:{width:"100%",padding:"12px",border:"none",background:"#f0f0f0",cursor:"pointer",textAlign:"center",fontSize:"14px",fontWeight:500,color:"#0066ff",borderRadius:"6px",transition:"all 0.2s"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor="#e0e0e0"},onMouseLeave:p=>{p.currentTarget.style.backgroundColor="#f0f0f0"},children:"Browse All Fonts..."})})]})]}),K.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[K.jsx("span",{style:{fontSize:"14px"},children:"Size:"}),K.jsx("input",{type:"number",min:"8",max:"72",value:((ds=M.find(p=>p.id===T))==null?void 0:ds.fontSize)||((us=N.find(p=>p.id===T))==null?void 0:us.fontSize)||((cs=E.find(p=>p.id===T))==null?void 0:cs.fontSize)||24,onChange:p=>Na(parseInt(p.target.value)||24),style:{width:"50px",padding:"4px",fontSize:"14px",border:"1px solid #ddd",borderRadius:"4px"}})]}),K.jsx("button",{onClick:async()=>{const p=M.find(j=>j.id===T),F=E.find(j=>j.id===T);if(p){const j=p.fontWeight==="bold"?"normal":"bold";if(j==="bold"){const V=fn.find(Y=>Y.family===p.fontFamily);V&&V.weights[700]&&await wi.loadFont(V,700)}U(V=>V.map(Y=>Y.id===T?{...Y,fontWeight:j}:Y))}else if(F){const j=F.fontWeight==="bold"?"normal":"bold";if(j==="bold"){const V=fn.find(Y=>Y.family===F.fontFamily);V&&V.weights[700]&&await wi.loadFont(V,700)}B(V=>V.map(Y=>Y.id===T?{...Y,fontWeight:j}:Y))}setTimeout(()=>{if(ae.current&&T){const V=ae.current.getStage().findOne("#"+T);V&&(ae.current.nodes([V]),ae.current.getLayer().batchDraw())}},50)},style:{width:"36px",height:"36px",padding:"6px",border:"1px solid #ddd",borderRadius:"6px",background:((hs=M.find(p=>p.id===T))==null?void 0:hs.fontWeight)==="bold"||((fs=E.find(p=>p.id===T))==null?void 0:fs.fontWeight)==="bold"?"#e3f2fd":"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:p=>{p.currentTarget.style.backgroundColor!=="rgb(227, 242, 253)"&&(p.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:p=>{var j,V;const F=((j=M.find(Y=>Y.id===T))==null?void 0:j.fontWeight)==="bold"||((V=E.find(Y=>Y.id===T))==null?void 0:V.fontWeight)==="bold";p.currentTarget.style.backgroundColor=F?"#e3f2fd":"white"},title:"Bold",children:"B"}),K.jsxs("div",{style:{position:"relative"},children:[K.jsx("button",{"data-color-button":"true",onClick:()=>ve(!ce),style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:(()=>{var F,j;const p=((F=M.find(V=>V.id===T))==null?void 0:F.fill)||((j=E.find(V=>V.id===T))==null?void 0:j.fill)||"#000000";return p==="gold-gradient"?"transparent":p})(),background:(()=>{var F,j;const p=((F=M.find(V=>V.id===T))==null?void 0:F.fill)||((j=E.find(V=>V.id===T))==null?void 0:j.fill)||"#000000";return p==="gold-gradient"?"linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #B8860B 100%)":p})(),border:"2px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s",boxShadow:ce?"0 0 0 2px #0066ff":"none"},title:"Text Color"}),ce&&K.jsxs("div",{"data-color-picker":"true",style:{position:"absolute",top:"36px",right:0,background:"white",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"6px",flexWrap:"wrap",width:"200px",zIndex:1001},children:[[{name:"White",hex:"#ffffff"},{name:"Red",hex:"#c8102e"},{name:"Blue",hex:"#0057b8"},{name:"Green",hex:"#009639"},{name:"Black",hex:"#000000"},{name:"Purple",hex:"#5f259f"},{name:"Yellow",hex:"#fff110"},{name:"Grey",hex:"#a2aaad"},{name:"Orange",hex:"#ff8200"},{name:"Ivory",hex:"#f1e6b2"},{name:"Light Blue",hex:"#71c5e8"},{name:"Pink",hex:"#f8a3bc"},{name:"Brown",hex:"#9e652e"},{name:"Light Grey",hex:"#cccccc"},{name:"Light Pink",hex:"#ffaaaa"},{name:"Sky Blue",hex:"#7fa8db"},{name:"Mint Green",hex:"#e0eed5"},{name:"Lavender",hex:"#aaaaff"},{name:"Amber",hex:"#febd11"},{name:"Olive",hex:"#97872a"},{name:"Peach",hex:"#ffcfa3"},{name:"Cream",hex:"#f7f4e8"},{name:"Powder Blue",hex:"#b8d6e0"},{name:"Blush",hex:"#ffd6e1"},{name:"Tan",hex:"#c49a73"}].map(p=>{var j,V;const F=((j=M.find(Y=>Y.id===T))==null?void 0:j.fill)||((V=E.find(Y=>Y.id===T))==null?void 0:V.fill)||"#000000";return K.jsx("button",{onClick:()=>{dr(p.hex),ve(!1)},style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:p.hex,border:F===p.hex?"2px solid #0066ff":"1px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s",boxShadow:p.hex==="#ffffff"?"inset 0 0 0 1px #ddd":"none"},title:p.name,onMouseEnter:Y=>{F!==p.hex&&(Y.currentTarget.style.transform="scale(1.1)")},onMouseLeave:Y=>{Y.currentTarget.style.transform="scale(1)"}},p.hex)}),K.jsx("button",{onClick:()=>{dr("gold-gradient"),ve(!1)},style:{width:"24px",height:"24px",borderRadius:"50%",background:"linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #B8860B 100%)",border:(((gs=M.find(p=>p.id===T))==null?void 0:gs.fill)||((fr=E.find(p=>p.id===T))==null?void 0:fr.fill))==="gold-gradient"?"2px solid #0066ff":"1px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s"},title:"Gold Gradient",onMouseEnter:p=>{var j,V;(((j=M.find(Y=>Y.id===T))==null?void 0:j.fill)||((V=E.find(Y=>Y.id===T))==null?void 0:V.fill))!=="gold-gradient"&&(p.currentTarget.style.transform="scale(1.1)")},onMouseLeave:p=>{p.currentTarget.style.transform="scale(1)"}})]})]}),K.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[K.jsx("span",{style:{fontSize:"12px",color:"#666"},children:"Stroke:"}),K.jsxs("div",{style:{position:"relative"},children:[K.jsx("button",{"data-stroke-color-button":"true",onClick:()=>Ue(!De),style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:(()=>{var F,j;const p=((F=M.find(V=>V.id===T))==null?void 0:F.stroke)||((j=E.find(V=>V.id===T))==null?void 0:j.stroke)||"transparent";return p==="transparent"?"#f0f0f0":p})(),backgroundImage:(()=>{var F,j;if((((F=M.find(V=>V.id===T))==null?void 0:F.stroke)||((j=E.find(V=>V.id===T))==null?void 0:j.stroke)||"transparent")==="transparent")return"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)"})(),backgroundSize:"6px 6px",backgroundPosition:"0 0, 3px 3px",border:"2px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s",boxShadow:De?"0 0 0 2px #0066ff":"none"},title:"Stroke Color"}),De&&K.jsxs("div",{"data-stroke-color-picker":"true",style:{position:"absolute",top:"36px",right:0,background:"white",border:"1px solid #ccc",borderRadius:"6px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",padding:"8px",display:"flex",gap:"6px",flexWrap:"wrap",width:"200px",zIndex:1001},children:[K.jsx("button",{onClick:()=>{bi("transparent"),Ue(!1)},style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#f0f0f0",backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc)",backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 4px",border:(((Gn=M.find(p=>p.id===T))==null?void 0:Gn.stroke)||((gr=E.find(p=>p.id===T))==null?void 0:gr.stroke)||"transparent")==="transparent"?"2px solid #0066ff":"1px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s"},title:"No Stroke",onMouseEnter:p=>{var j,V;(((j=M.find(Y=>Y.id===T))==null?void 0:j.stroke)||((V=E.find(Y=>Y.id===T))==null?void 0:V.stroke)||"transparent")!=="transparent"&&(p.currentTarget.style.transform="scale(1.1)")},onMouseLeave:p=>{p.currentTarget.style.transform="scale(1)"}}),[{name:"White",hex:"#ffffff"},{name:"Red",hex:"#c8102e"},{name:"Blue",hex:"#0057b8"},{name:"Green",hex:"#009639"},{name:"Black",hex:"#000000"},{name:"Purple",hex:"#5f259f"},{name:"Yellow",hex:"#fff110"},{name:"Grey",hex:"#a2aaad"},{name:"Orange",hex:"#ff8200"},{name:"Ivory",hex:"#f1e6b2"},{name:"Light Blue",hex:"#71c5e8"},{name:"Pink",hex:"#f8a3bc"},{name:"Brown",hex:"#9e652e"},{name:"Light Grey",hex:"#cccccc"},{name:"Light Pink",hex:"#ffaaaa"},{name:"Sky Blue",hex:"#7fa8db"},{name:"Mint Green",hex:"#e0eed5"},{name:"Lavender",hex:"#aaaaff"},{name:"Amber",hex:"#febd11"},{name:"Olive",hex:"#97872a"},{name:"Peach",hex:"#ffcfa3"},{name:"Cream",hex:"#f7f4e8"},{name:"Powder Blue",hex:"#b8d6e0"},{name:"Blush",hex:"#ffd6e1"},{name:"Tan",hex:"#c49a73"}].map(p=>{var j,V;const F=((j=M.find(Y=>Y.id===T))==null?void 0:j.stroke)||((V=E.find(Y=>Y.id===T))==null?void 0:V.stroke)||"transparent";return K.jsx("button",{onClick:()=>{bi(p.hex),Ue(!1)},style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:p.hex,border:F===p.hex?"2px solid #0066ff":"1px solid #ccc",cursor:"pointer",padding:0,transition:"all 0.2s",boxShadow:p.hex==="#ffffff"?"inset 0 0 0 1px #ddd":"none"},title:p.name,onMouseEnter:Y=>{F!==p.hex&&(Y.currentTarget.style.transform="scale(1.1)")},onMouseLeave:Y=>{Y.currentTarget.style.transform="scale(1)"}},p.hex)})]})]})]})]}),E.find(p=>p.id===T)&&K.jsxs(K.Fragment,{children:[K.jsx("div",{style:{width:"1px",background:"#e0e0e0",height:"24px",margin:"0 4px"}}),K.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[K.jsx("span",{style:{fontSize:"14px"},children:"Curve:"}),K.jsx("input",{type:"range",min:"50",max:"300",value:((pr=E.find(p=>p.id===T))==null?void 0:pr.radius)||100,onChange:p=>Fa(parseInt(p.target.value)),style:{width:"80px",cursor:"pointer"}}),K.jsx("span",{style:{fontSize:"12px",color:"#666",minWidth:"35px"},children:(((ps=E.find(p=>p.id===T))==null?void 0:ps.radius)||100)*2})]}),K.jsx("button",{onClick:Ji,style:{width:"32px",height:"32px",padding:"4px",border:"none",borderRadius:"4px",background:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"background-color 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#e3f2fd",onMouseLeave:p=>p.currentTarget.style.backgroundColor="white",title:"Flip Text",children:"↕️"})]})]}),te&&T&&(M.find(p=>p.id===T)||N.find(p=>p.id===T)||E.find(p=>p.id===T))&&K.jsx("div",{style:{position:"fixed",left:te.x,top:te.y,transform:"translateX(-50%)",zIndex:1001},children:K.jsx("input",{type:"text",value:((mr=M.find(p=>p.id===T))==null?void 0:mr.text)||((Pn=N.find(p=>p.id===T))==null?void 0:Pn.text)||((sn=E.find(p=>p.id===T))==null?void 0:sn.text)||"",onChange:p=>{const F=p.target.value;M.find(j=>j.id===T)?U(j=>j.map(V=>V.id===T?{...V,text:F}:V)):E.find(j=>j.id===T)?B(j=>j.map(V=>V.id===T?{...V,text:F}:V)):N.find(j=>j.id===T)&&A(j=>j.map(V=>V.id===T?{...V,text:F}:V))},onKeyDown:p=>{p.key==="Escape"&&X(null)},style:{padding:"8px 12px",fontSize:"16px",width:"300px",border:"2px solid #0066ff",borderRadius:"6px",outline:"none",background:"white",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontFamily:"Arial, sans-serif",textAlign:"center"},placeholder:"Enter text...",autoFocus:!0})}),K.jsx(mf,{isOpen:Vt,onClose:()=>ht(!1),onSelectFont:Ci,currentFont:((We=M.find(p=>p.id===T))==null?void 0:We.fontFamily)||((je=N.find(p=>p.id===T))==null?void 0:je.fontFamily)||((an=E.find(p=>p.id===T))==null?void 0:an.fontFamily)||"Arial",previewText:((ft=M.find(p=>p.id===T))==null?void 0:ft.text)||((St=N.find(p=>p.id===T))==null?void 0:St.text)||((pn=E.find(p=>p.id===T))==null?void 0:pn.text)||"The quick brown fox jumps over the lazy dog"}),K.jsx("style",{dangerouslySetInnerHTML:{__html:`
        @keyframes slideDown {
          from {
            transform: translateX(-50%) translateY(-20px);
            opacity: 0;
          }
          to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
          }
        }
      `}})]})};function xf(){const s=window.__INITIAL_TEMPLATE__||null,d=window.__INITIAL_DESIGN__||null,L=window.__TEMPLATE_COLORS__||[],z=window.__INITIAL_COLOR_VARIANT__||null,R=d?{templateId:s==null?void 0:s.id,variantId:d.variantId,productId:d.productId,textUpdates:d.textUpdates,fromModal:!1}:null;return K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"canvas-header",children:K.jsx("h2",{style:{margin:0,fontFamily:"Arial"},children:s?`Customizing: ${s.name}`:"Product Designer"})}),K.jsx("div",{className:"canvas-container",children:K.jsx(vf,{initialTemplate:s,initialState:R,isAdminView:!1,templateColors:L,initialColorVariant:z})})]})}if(typeof window<"u"){const s=()=>{const d=document.getElementById("canvas-root");d&&gc.createRoot(d).render(K.jsx(xf,{}))};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s()}})(React,ReactDOM);
